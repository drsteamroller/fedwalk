config system interface
    edit "fortilink"
        set vdom "root"
        set lldp-transmission enable
        set allowaccess ping fabric
        set ip 169.254.1.1 255.255.255.0
        set type aggregate
        set snmp-index 3
        set lldp-reception enable
    next
    edit "ssl.root"
        set type tunnel
        set vdom "root"
        set snmp-index 2
        set alias "SSL VPN interface"
    next
    edit "port1"
        set vdom "root"
        set allowaccess ping https ssh http fgfm
        set type physical
        set mode dhcp
        set snmp-index 1
    next
end
config system object-tagging
    edit "default"
    next
end
config system settings
end
config system replacemsg-group
    edit "default"
        set comment "Default replacement message group."
    next
end
config system dhcp server
    edit 1
        set interface "fortilink"
        set default-gateway 169.254.1.1
        set vci-string "FortiSwitch" "FortiExtender"
        set ntp-service local
        set netmask 255.255.255.0
        set vci-match enable
        config ip-range
            edit 1
                set end-ip 169.254.1.254
                set start-ip 169.254.1.2
            next
        end
    next
end
config firewall address
    edit "all"
    next
    edit "none"
        set subnet 0.0.0.0 255.255.255.255
    next
    edit "gmail.com"
        set type fqdn
        set fqdn "gmail.com"
    next
    edit "SSLVPN_TUNNEL_ADDR1"
        set end-ip 10.212.134.210
        set start-ip 10.212.134.200
        set type iprange
    next
    edit "login.microsoft.com"
        set type fqdn
        set fqdn "login.microsoft.com"
    next
    edit "login.microsoftonline.com"
        set type fqdn
        set fqdn "login.microsoftonline.com"
    next
    edit "wildcard.google.com"
        set type fqdn
        set fqdn "*.google.com"
    next
    edit "login.windows.net"
        set type fqdn
        set fqdn "login.windows.net"
    next
    edit "wildcard.dropbox.com"
        set type fqdn
        set fqdn "*.dropbox.com"
    next
    edit "FIREWALL_AUTH_PORTAL_ADDRESS"
    next
    edit "FABRIC_DEVICE"
        set comment "IPv4 addresses of Fabric Devices."
    next
end
config firewall address6
    edit "all"
    next
    edit "none"
        set ip6 ::/128
    next
    edit "SSLVPN_TUNNEL_IPv6_ADDR1"
        set ip6 fdff:ffff::/120
    next
end
config firewall addrgrp
    edit "G Suite"
        set member "gmail.com" "wildcard.google.com"
    next
    edit "Microsoft Office 365"
        set member "login.microsoftonline.com" "login.microsoft.com" "login.windows.net"
    next
end
config firewall service category
    edit "Tunneling"
        set comment "Tunneling service."
    next
    edit "File Access"
        set comment "File access."
    next
    edit "General"
        set comment "General services."
    next
    edit "Authentication"
        set comment "Authentication service."
    next
    edit "Email"
        set comment "Email services."
    next
    edit "Web Access"
        set comment "Web access."
    next
    edit "Network Services"
        set comment "Network services."
    next
    edit "VoIP, Messaging & Other Applications"
        set comment "VoIP, messaging, and other applications."
    next
    edit "Web Proxy"
        set comment "Explicit web proxy."
    next
    edit "Remote Access"
        set comment "Remote access."
    next
end
config firewall service custom
    edit "SNMP"
        set udp-portrange 161-162
        set category "Network Services"
        set tcp-portrange 161-162
    next
    edit "SAMBA"
        set category "File Access"
        set tcp-portrange 139
    next
    edit "FTP"
        set category "File Access"
        set tcp-portrange 21
    next
    edit "RADIUS-OLD"
        set visibility disable
        set udp-portrange 1645 1646
    next
    edit "INFO_ADDRESS"
        set visibility disable
        set protocol ICMP
        unset icmpcode
        set icmptype 17
    next
    edit "RDP"
        set category "Remote Access"
        set tcp-portrange 3389
    next
    edit "RADIUS"
        set udp-portrange 1812 1813
        set category "Authentication"
    next
    edit "MGCP"
        set visibility disable
        set udp-portrange 2427 2727
    next
    edit "SSH"
        set category "Remote Access"
        set tcp-portrange 22
    next
    edit "FTP_PUT"
        set category "File Access"
        set tcp-portrange 21
    next
    edit "GRE"
        set protocol-number 47
        set protocol IP
        set category "Tunneling"
    next
    edit "IRC"
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 6660-6669
    next
    edit "AH"
        set protocol-number 51
        set protocol IP
        set category "Tunneling"
    next
    edit "UUCP"
        set visibility disable
        set tcp-portrange 540
    next
    edit "Internet-Locator-Service"
        set visibility disable
        set tcp-portrange 389
    next
    edit "RTSP"
        set udp-portrange 554
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 554 7070 8554
    next
    edit "SQUID"
        set category "Tunneling"
        set tcp-portrange 3128
    next
    edit "REXEC"
        set visibility disable
        set tcp-portrange 512
    next
    edit "RIP"
        set udp-portrange 520
        set category "Network Services"
    next
    edit "NNTP"
        set visibility disable
        set tcp-portrange 119
    next
    edit "QUAKE"
        set visibility disable
        set udp-portrange 26000 27000 27910 27960
    next
    edit "NTP"
        set udp-portrange 123
        set category "Network Services"
        set tcp-portrange 123
    next
    edit "OSPF"
        set protocol-number 89
        set protocol IP
        set category "Network Services"
    next
    edit "INFO_REQUEST"
        set visibility disable
        set protocol ICMP
        unset icmpcode
        set icmptype 15
    next
    edit "TRACEROUTE"
        set udp-portrange 33434-33535
        set category "Network Services"
    next
    edit "NFS"
        set udp-portrange 111 2049
        set category "File Access"
        set tcp-portrange 111 2049
    next
    edit "IMAPS"
        set category "Email"
        set tcp-portrange 993
    next
    edit "IKE"
        set udp-portrange 500 4500
        set category "Tunneling"
    next
    edit "HTTPS"
        set category "Web Access"
        set tcp-portrange 443
    next
    edit "MMS"
        set visibility disable
        set udp-portrange 1024-5000
        set tcp-portrange 1755
    next
    edit "TFTP"
        set udp-portrange 69
        set category "File Access"
    next
    edit "RLOGIN"
        set visibility disable
        set tcp-portrange 513:512-1023
    next
    edit "DCE-RPC"
        set udp-portrange 135
        set category "Remote Access"
        set tcp-portrange 135
    next
    edit "POP3"
        set category "Email"
        set tcp-portrange 110
    next
    edit "MYSQL"
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 3306
    next
    edit "NONE"
        set visibility disable
        set tcp-portrange 0
    next
    edit "WAIS"
        set visibility disable
        set tcp-portrange 210
    next
    edit "SCCP"
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 2000
    next
    edit "VNC"
        set category "Remote Access"
        set tcp-portrange 5900
    next
    edit "LDAP"
        set category "Authentication"
        set tcp-portrange 389
    next
    edit "SMTP"
        set category "Email"
        set tcp-portrange 25
    next
    edit "TIMESTAMP"
        set visibility disable
        set protocol ICMP
        unset icmpcode
        set icmptype 13
    next
    edit "RAUDIO"
        set visibility disable
        set udp-portrange 7070
    next
    edit "VDOLIVE"
        set visibility disable
        set tcp-portrange 7000-7010
    next
    edit "TALK"
        set visibility disable
        set udp-portrange 517-518
    next
    edit "BGP"
        set category "Network Services"
        set tcp-portrange 179
    next
    edit "KERBEROS"
        set udp-portrange 88 464
        set category "Authentication"
        set tcp-portrange 88 464
    next
    edit "GOPHER"
        set visibility disable
        set tcp-portrange 70
    next
    edit "CVSPSERVER"
        set visibility disable
        set udp-portrange 2401
        set tcp-portrange 2401
    next
    edit "AFS3"
        set udp-portrange 7000-7009
        set category "File Access"
        set tcp-portrange 7000-7009
    next
    edit "ESP"
        set protocol-number 50
        set protocol IP
        set category "Tunneling"
    next
    edit "ONC-RPC"
        set udp-portrange 111
        set category "Remote Access"
        set tcp-portrange 111
    next
    edit "PPTP"
        set category "Tunneling"
        set tcp-portrange 1723
    next
    edit "POP3S"
        set category "Email"
        set tcp-portrange 995
    next
    edit "WINFRAME"
        set visibility disable
        set tcp-portrange 1494 2598
    next
    edit "FINGER"
        set visibility disable
        set tcp-portrange 79
    next
    edit "DHCP"
        set udp-portrange 67-68
        set category "Network Services"
    next
    edit "DNS"
        set udp-portrange 53
        set category "Network Services"
        set tcp-portrange 53
    next
    edit "DHCP6"
        set udp-portrange 546 547
        set category "Network Services"
    next
    edit "SMB"
        set category "File Access"
        set tcp-portrange 445
    next
    edit "MS-SQL"
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 1433 1434
    next
    edit "SOCKS"
        set udp-portrange 1080
        set category "Tunneling"
        set tcp-portrange 1080
    next
    edit "ALL_ICMP6"
        set protocol ICMP6
        set category "General"
        unset icmptype
    next
    edit "IMAP"
        set category "Email"
        set tcp-portrange 143
    next
    edit "SYSLOG"
        set udp-portrange 514
        set category "Network Services"
    next
    edit "AOL"
        set visibility disable
        set tcp-portrange 5190-5194
    next
    edit "webproxy"
        set protocol ALL
        set category "Web Proxy"
        set proxy enable
        set tcp-portrange 0-65535:0-65535
    next
    edit "H323"
        set udp-portrange 1719
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 1720 1503
    next
    edit "SIP"
        set udp-portrange 5060
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 5060
    next
    edit "X-WINDOWS"
        set category "Remote Access"
        set tcp-portrange 6000-6063
    next
    edit "RSH"
        set visibility disable
        set tcp-portrange 514:512-1023
    next
    edit "L2TP"
        set udp-portrange 1701
        set category "Tunneling"
        set tcp-portrange 1701
    next
    edit "PING6"
        set visibility disable
        set protocol ICMP6
        unset icmpcode
        set icmptype 128
    next
    edit "SMTPS"
        set category "Email"
        set tcp-portrange 465
    next
    edit "ALL"
        set protocol IP
        set category "General"
    next
    edit "ALL_TCP"
        set category "General"
        set tcp-portrange 1-65535
    next
    edit "PC-Anywhere"
        set udp-portrange 5632
        set category "Remote Access"
        set tcp-portrange 5631
    next
    edit "ALL_ICMP"
        set protocol ICMP
        set category "General"
        unset icmptype
    next
    edit "PING"
        set protocol ICMP
        unset icmpcode
        set category "Network Services"
        set icmptype 8
    next
    edit "FTP_GET"
        set category "File Access"
        set tcp-portrange 21
    next
    edit "NetMeeting"
        set visibility disable
        set tcp-portrange 1720
    next
    edit "LDAP_UDP"
        set udp-portrange 389
        set category "Authentication"
    next
    edit "SIP-MSNmessenger"
        set category "VoIP, Messaging & Other Applications"
        set tcp-portrange 1863
    next
    edit "HTTP"
        set category "Web Access"
        set tcp-portrange 80
    next
    edit "WINS"
        set udp-portrange 1512
        set category "Remote Access"
        set tcp-portrange 1512
    next
    edit "TELNET"
        set category "Remote Access"
        set tcp-portrange 23
    next
    edit "ALL_UDP"
        set udp-portrange 1-65535
        set category "General"
    next
end
config firewall service group
    edit "Windows AD"
        set member "DCE-RPC" "DNS" "KERBEROS" "LDAP" "LDAP_UDP" "SAMBA" "SMB"
    next
    edit "Email Access"
        set member "DNS" "IMAP" "IMAPS" "POP3" "POP3S" "SMTP" "SMTPS"
    next
    edit "Exchange Server"
        set member "DCE-RPC" "DNS" "HTTPS"
    next
    edit "Web Access"
        set member "DNS" "HTTP" "HTTPS"
    next
end
config vpn certificate ca
end
config vpn certificate local
    edit "Fortinet_SSL_ECDSA384"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_ED25519"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_DSA2048"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_RSA2048"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_DSA1024"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_RSA1024"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_ED448"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_CA_Untrusted"
        set comments "This is the default CA certificate the SSL Inspection will use when generating new server certificates."
        set source factory
        set range global
    next
    edit "Fortinet_SSL_ECDSA521"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_RSA4096"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_SSL_ECDSA256"
        set comments "This certificate is embedded in the hardware at the factory and is unique to this unit. "
        set source factory
        set range global
    next
    edit "Fortinet_CA_SSL"
        set comments "This is the default CA certificate the SSL Inspection will use when generating new server certificates."
        set source factory
        set range global
    next
end
config log threat-weight
    config application
        edit 1
            set category 2
        next
        edit 2
            set level medium
            set category 6
        next
    end
    config web
        edit 1
            set level high
            set category 26
        next
        edit 8
            set level medium
            set category 6
        next
        edit 10
            set level medium
            set category 59
        next
        edit 5
            set level medium
            set category 3
        next
        edit 12
            set level medium
            set category 83
        next
        edit 14
            set category 14
        next
        edit 9
            set level medium
            set category 12
        next
        edit 13
            set category 72
        next
        edit 3
            set level high
            set category 86
        next
        edit 6
            set level medium
            set category 4
        next
        edit 11
            set level medium
            set category 62
        next
        edit 4
            set level medium
            set category 1
        next
        edit 2
            set level high
            set category 61
        next
        edit 7
            set level medium
            set category 5
        next
    end
end
config user group
    edit "SSO_Guest_Users"
    next
    edit "Guest-group"
    next
end
config report layout
    edit "default"
        config body-item
            edit 1611
                set chart "attack.count.victims_c"
                set type chart
                set top-n 80
            next
            edit 411
                set chart "traffic.bandwidth.apps_c"
                set type chart
            next
            edit 1041
                set chart "web.blocked-request.users_c"
                set type chart
            next
            edit 1021
                set chart "web.bandwidth.sites_c"
                set type chart
            next
            edit 1731
                set chart "vpn.bandwidth.ssl-tunnel.users_c"
                set type chart
                set top-n 80
            next
            edit 611
                set chart "traffic.bandwidth.destinations_tab"
                set type chart
            next
            edit 1741
                set chart "vpn.bandwidth.ssl-web.users_c"
                set type chart
                set top-n 80
            next
            edit 109
                set content "${vdom}"
                set style "report-cover3"
            next
            edit 311
                set chart "traffic.bandwidth.history_c"
                set type chart
            next
            edit 1901
                set content "Admin Login and System Events"
                set text-component heading1
            next
            edit 105
                set content "Report Date: ${started_time}"
                set style "report-cover3"
            next
            edit 1571
                set chart "botnet.count.users_c"
                set type chart
                set top-n 80
            next
            edit 1531
                set chart "virus.count.users_c"
                set type chart
                set top-n 80
            next
            edit 1931
                set chart "event.failed.login_c"
                set type chart
                set top-n 80
            next
            edit 331
                set chart "traffic.statistics"
                set type chart
            next
            edit 1601
                set chart "attack.count.attacks_c"
                set type chart
                set top-n 80
            next
            edit 1001
                set content "Web Usage"
                set text-component heading1
            next
            edit 1321
                set chart "email.bandwidth.senders_c"
                set type chart
            next
            edit 1061
                set chart "web.bandwidth.users_c"
                set type chart
            next
            edit 1071
                set chart "web.bandwidth.stream-sites_c"
                set type chart
            next
            edit 1511
                set chart "virus.count.viruses_c"
                set type chart
                set top-n 80
            next
            edit 521
                set chart "traffic.users.history.hour_c"
                set type chart
            next
            edit 103
                set content "FortiGate ${schedule_type} Security Report"
                set style "report-cover2"
            next
            edit 321
                set chart "traffic.sessions.history_c"
                set type chart
            next
            edit 1031
                set chart "web.blocked-request.sites_c"
                set type chart
            next
            edit 111
                set style "report-cover4"
                set type image
                set img-src "fortinet_logo_small.png"
            next
            edit 1541
                set chart "virus.count.sources_c"
                set type chart
                set top-n 80
            next
            edit 1011
                set chart "web.allowed-request.sites_c"
                set type chart
            next
            edit 1641
                set chart "attack.count.severity_c"
                set type chart
            next
            edit 101
                set style "report-cover1"
                set type image
                set img-src "fortigate_log.png"
            next
            edit 121
                set type misc
                set misc-component page-break
            next
            edit 1051
                set chart "web.requests.users_c"
                set type chart
            next
            edit 1551
                set chart "virus.count.history_c"
                set type chart
            next
            edit 1311
                set chart "email.request.senders_c"
                set type chart
            next
            edit 1631
                set chart "attack.count.blocked_attacks_c"
                set type chart
            next
            edit 1501
                set content "Threats"
                set text-component heading1
            next
            edit 107
                set content "Data Range: ${report_data_range}  (${hostname})"
                set style "report-cover3"
            next
            edit 1711
                set chart "vpn.bandwidth.static-tunnels_c"
                set type chart
                set top-n 80
            next
            edit 1721
                set chart "vpn.bandwidth.dynamic-tunnels_c"
                set type chart
                set top-n 80
            next
            edit 1301
                set content "Emails"
                set text-component heading1
            next
            edit 1621
                set chart "attack.count.source_bar_c"
                set type chart
                set top-n 80
            next
            edit 301
                set content "Bandwidth and Applications"
                set text-component heading1
            next
            edit 421
                set chart "traffic.bandwidth.cats_c"
                set type chart
            next
            edit 1961
                set chart "event.system.group_events_c"
                set type chart
                set top-n 80
            next
            edit 1581
                set chart "botnet.count.sources_c"
                set type chart
                set top-n 80
            next
            edit 1911
                set chart "event.login.summary_c"
                set type chart
                set top-n 80
            next
            edit 1561
                set chart "botnet.count_c"
                set type chart
                set top-n 80
            next
            edit 1331
                set chart "email.request.recipients_c"
                set type chart
            next
            edit 1591
                set chart "botnet.count.history_c"
                set type chart
            next
            edit 1701
                set content "VPN Usage"
                set text-component heading1
            next
            edit 1341
                set chart "email.bandwidth.recipients_c"
                set type chart
            next
            edit 1651
                set chart "attack.count.history_c"
                set type chart
            next
            edit 511
                set chart "traffic.bandwidth.users_c"
                set type chart
            next
        end
        set options include-table-of-content view-chart-as-heading
        set title "FortiGate System Analysis Report"
        set style-theme "default-report"
        config page
            config header
                config header-item
                    edit 1
                        set style "header-image"
                        set type image
                        set img-src "fortinet_logo_small.png"
                    next
                end
            end
            config footer
                config footer-item
                    edit 1
                        set content "FortiGate ${schedule_type} Security Report - Host Name: ${hostname}"
                        set style "footer-text"
                    next
                    edit 2
                        set style "footer-pageno"
                    next
                end
            end
            set page-break-before heading1
            set paper letter
        end
    next
end
config system sdwan
    config zone
        edit "virtual-wan-link"
        next
    end
    config health-check
        edit "Default_FortiGuard"
            set server "fortiguard.com"
            set interval 1000
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 5
                next
            end
            set protocol http
            set recoverytime 10
            set probe-timeout 1000
        next
        edit "Default_Office_365"
            set server "www.office.com"
            set interval 1000
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 5
                next
            end
            set protocol http
            set recoverytime 10
            set probe-timeout 1000
        next
        edit "Default_Google Search"
            set server "www.google.com"
            set interval 1000
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 5
                next
            end
            set protocol http
            set recoverytime 10
            set probe-timeout 1000
        next
        edit "Default_Gmail"
            set server "gmail.com"
            set interval 1000
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 2
                next
            end
            set recoverytime 10
            set probe-timeout 1000
        next
        edit "Default_AWS"
            set server "aws.amazon.com"
            set interval 1000
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 5
                next
            end
            set protocol http
            set recoverytime 10
            set probe-timeout 1000
        next
        edit "Default_DNS"
            config sla
                edit 1
                    set latency-threshold 250
                    set jitter-threshold 50
                    set packetloss-threshold 5
                next
            end
            set interval 1000
            set recoverytime 10
            set probe-timeout 1000
            set system-dns enable
        next
    end
end
config log memory setting
    set status disable
end
config log disk setting
    set status enable
end
config log null-device setting
    set status disable
end
config router rip
    config redistribute "bgp"
    end
    config redistribute "isis"
    end
    config redistribute "ospf"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
end
config router ripng
    config redistribute "bgp"
    end
    config redistribute "isis"
    end
    config redistribute "ospf"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
end
config router ospf
    config redistribute "bgp"
    end
    config redistribute "isis"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
    config redistribute "rip"
    end
end
config router ospf6
    config redistribute "bgp"
    end
    config redistribute "isis"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
    config redistribute "rip"
    end
end
config router bgp
    config redistribute6 "isis"
    end
    config redistribute6 "ospf"
    end
    config redistribute6 "static"
    end
    config redistribute6 "connected"
    end
    config redistribute6 "rip"
    end
    config redistribute "isis"
    end
    config redistribute "ospf"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
    config redistribute "rip"
    end
end
config router isis
    config redistribute6 "bgp"
    end
    config redistribute6 "ospf"
    end
    config redistribute6 "static"
    end
    config redistribute6 "connected"
    end
    config redistribute6 "rip"
    end
    config redistribute "bgp"
    end
    config redistribute "ospf"
    end
    config redistribute "static"
    end
    config redistribute "connected"
    end
    config redistribute "rip"
    end
end
config router multicast
end
