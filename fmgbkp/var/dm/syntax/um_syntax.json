{
	"macro": {
		"none": 0,
		"IMAGE_UPGRADE_BOOT_ALT_PARTITION": 1,
		"IMAGE_UPGRADE_SKIP_RETRIEVE": 2,
		"IMAGE_UPGRADE_SKIP_MULTI_STEPS": 4,
		"IMAGE_UPGRADE_FORTIGUARD_IMG": 8,
		"IMAGE_UPGRADE_PREVIEW": 16
	},
	"obj": {
		"device/list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 32 },
				"os_type": { "type": "int32"}
			},
			"response": {
			}
		},
		"device/info": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 32 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/detail": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 32 }
			},
			"response": {
			}
		},
		"device/license": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "array" }
			},
			"response": {
			}
		},
		"device/history": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"logtime": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/status": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 }
			},
			"response": {
			}
		},
		"device/usage": {
			"internal": 1,
			"type": "command",
			"attr": {
				"logtime": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/contract": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/object": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/push": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"command": { "type": "string"},
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"device/add": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"firmware": { "type": "string", "sz": 32 },
				"ipv4": { "type": "string", "sz": 18 }
			},
			"response": {
			}
		},
		"device/del": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 }
			},
			"response": {
			}
		},
		"device/vmlicense": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"meter/list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"status": { "type": "string", "sz": 32 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"meter/info": {
			"internal": 1,
			"type": "command",
			"attr": {
				"fmgsn": { "type": "string", "sz": 18 }
			},
			"response": {
			}
		},
		"object/list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 8 },
				"firmware": { "type": "string", "sz": 9 },
				"version": { "type": "string", "sz": 4 },
				"objid": { "type": "string", "sz": 18 },
				"used_only": { "type": "int32" }
			},
			"response": {
			}
		},
		"object/prefer_version": {
			"internal": 1,
			"type": "command",
			"attr": {
				"objid": { "type": "string", "sz": 18 },
				"version": { "type": "int32" }
			},
			"response": {
			}
		},
		"object/desc": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"object/version": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"license/self": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"license/restore": {
			"internal": 1,
			"type": "command",
			"attr": {
				"file": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"license/backup": {
			"internal": 1,
			"type": "command",
			"attr": {
				"file": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"license/export_xml": {
			"internal": 1,
			"type": "command",
			"attr": {
				"file": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"license/export_soap": {
			"internal": 1,
			"type": "command",
			"attr": {
				"file": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"logs/view": {
			"internal": 1,
			"type": "command",
			"attr": {
				"count": { "type": "int32" },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"token/dump": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"token/add": {
			"internal": 1,
			"type": "command",
			"attr": {
				"token_item": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"token/delete": {
			"internal": 1,
			"type": "command",
			"attr": {
				"token_item": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"misc/firmware_list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 8 }
			},
			"response": {
			}
		},
		"misc/mr_version_list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 4 },
				"firmware": { "type": "string", "sz": 9 }
			},
			"response": {
			}
		},
		"misc/shortname_list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 4 },
				"version": { "type": "string", "sz": 4 }
			},
			"response": {
			}
		},
		"misc/version_list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 4 },
				"version": { "type": "string", "sz": 4 },
				"group_name": { "type": "string", "sz": 16 },
				"count": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/group_abbreviation": {
			"internal": 1,
			"type": "command",
			"attr": {
				"group_name": { "type": "string", "sz": 16 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/avail_service": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/service_query": {
			"internal": 1,
			"type": "command",
			"attr": {
				"service": { "type": "string", "sz": 16 },
				"system": { "type": "string", "sz": 4 },
				"firmware": { "type": "string", "sz": 16 }
			},
			"response": {
			}
		},
		"misc/terminate": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/detail_link": {
			"internal": 1,
			"type": "command",
			"attr": {
				"group_name": { "type": "string", "sz": 16 }
			},
			"response": {
			}
		},
		"misc/dump_srul": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_breg": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/server_list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_config": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_contract": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 32 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_dvmobj": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 32 },
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_devobj": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/dump_updobj": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/fgd_db_ver": {
			"internal": 1,
			"type": "command",
			"attr": {
			},
			"response": {
			}
		},
		"misc/update_now": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/update_status": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/update_schedule": {
			"internal": 1,
			"type": "command",
			"attr": {
				"flags": { "type": "int32" }
			},
			"response": {
			}
		},
		"misc/update_history": {
			"internal": 1,
			"type": "command",
			"attr": {
				"category": {
					"objid": { "type": "string", "sz": 18 }
				}
			},
			"response": {
			}
		},
		"misc/manual_update": {
			"internal": 1,
			"type": "command",
			"attr": {
				"file": { "type": "string", "sz": 256 }
			},
			"response": {
			}
		},
		"misc/manual_announce": {
			"internal": 1,
			"type": "command",
			"attr": {
				"ipv4": { "type": "string", "sz": 64 },
				"port": { "type": "int32" }
			},
			"response": {
			}
		},
		"image/list": {
			"internal": 1,
			"type": "command",
			"attr": {
				"system": { "type": "string", "sz": 8 },
				"local": { "type": "int32" }
			},
			"response": {
			}
		},
		"image/upgrade" : {
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"device": {
					"type": "scope object",
					"extref": [ "/dvmdb/device", "/dvmdb/group" ]
				},
				"schedule_time": { "type": "string"},
				"flags": {
					"type": "int32",
					"opts": {
						"f_boot_alt_partition": "$IMAGE_UPGRADE_BOOT_ALT_PARTITION",
						"f_skip_retrieve": "$IMAGE_UPGRADE_SKIP_RETRIEVE",
						"f_skip_multi_steps": "$IMAGE_UPGRADE_SKIP_MULTI_STEPS",
						"f_skip_fortiguard_img": "$IMAGE_UPGRADE_FORTIGUARD_IMG",
						"f_preview": "$IMAGE_UPGRADE_PREVIEW"
					},
					"default": 0
				},
				"create_task": { "type": "string" }
			},
			"subobj": {
				"image" : {
					"type": "obj",
					"attr": {
						"release": { "type": "string"},
						"build": { "type": "string"},
						"id": { "type": "array" },
						"model": { "type": "string"}
					}
				}
			},
			"response": {
				"taskid": {
					"type": "int32",
					"limit": 1
				}
			}
		},
		"image/upgrade/ext" : {
			"type": "command",
			"attr": {
				"device": {
					"type": "scope object",
					"extref": [ "/dvmdb/device", "/dvmdb/group" ]
				},
				"image": { "type": "string" },
				"schedule_time": { "type": "string"},
				"flags": {
					"type": "int32",
					"opts": {
						"f_boot_alt_partition": "$IMAGE_UPGRADE_BOOT_ALT_PARTITION",
						"f_skip_retrieve": "$IMAGE_UPGRADE_SKIP_RETRIEVE",
						"f_skip_multi_steps": "$IMAGE_UPGRADE_SKIP_MULTI_STEPS",
						"f_skip_fortiguard_img": "$IMAGE_UPGRADE_FORTIGUARD_IMG",
						"f_preview": "$IMAGE_UPGRADE_PREVIEW"
					},
					"default": 0
				},
				"create_task": { "type": "string" }
			},
			"response": {
				"taskid": {
					"type": "int32",
					"limit": 1
				}
			}
		},
		"image/cancel/upgrade": {
			"internal": 1,
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"device": {
					"type": "scope object",
					"extref": [ "/dvmdb/device", "/dvmdb/group" ]
				},
				"taskid": {
					"type": "int32",
					"limit": 1
				}
			},
			"response": {
			}
		},
		"image/template/upgrade": {
			"internal": 1,
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"name": { "type": "string", "sz": 64 }
			},
			"response": {
				"taskid": {
					"type": "int32",
					"limit": 1
				}
			}
		},
		"image/template/preview": {
			"internal": 1,
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"name": { "type": "string", "sz": 64 }
			},
			"response": {
			}
		},
		"image/template/cancel": {
			"internal": 1,
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"name": { "type": "string", "sz": 64 }
			},
			"response": {
			}
		},
		"image/template/report": {
			"internal": 1,
			"type": "command",
			"attr": {
				"adom": {
					"type": "datasrc",
					"extref": "/dvmdb/adom",
					"limit": 1,
					"sz": 36
				},
				"name": { "type": "string", "sz": 64 }
			},
			"response": {
			}
		},
		"object/download": {
			"internal": 1,
			"type": "command",
			"attr": {
				"objid": { "type": "string", "sz": 18 },
				"obj_ver": { "type": "string", "sz": 12 }
			},
			"response": {
			}
		},
		"object/delete": {
			"internal": 1,
			"type": "command",
			"attr": {
				"objid": { "type": "string", "sz": 18 },
				"obj_ver": { "type": "string", "sz": 12 }
			},
			"response": {
			}
		},
		"object/export": {
			"internal": 1,
			"type": "command",
			"attr": {
				"category": {
					"objid": { "type": "string", "sz": 18 }
				}
			},
			"response": {
				"taskid": {
					"type": "int32",
					"limit": 1
				},
				"category": {
					"file": { "type": "string", "sz": 18 }
				}
			}
		},
		"object/import": {
			"internal": 1,
			"type": "command",
			"attr": {
				"category": {
					"file": { "type": "string", "sz": 18 }
				}
			},
			"response": {
				"taskid": {
					"type": "int32",
					"limit": 1
				}
			}
		},
		"update/object_version": {
			"internal": 1,
			"type": "command",
			"attr": {
				"id": { "type": "string", "sz": 17 },
				"version": { "type": "string", "sz": 16 }
			},
			"response": {
			}
		},
		"misc/verify_vmlic": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 64 },
				"uid": { "type": "string", "sz": 64 }
			},
			"response": {
			}
		},
		"license/filter": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 }
			},
			"response": {
			}
		},
		"update/license/filter": {
			"internal": 1,
			"type": "command",
			"attr": {
				"serial": { "type": "string", "sz": 18 },
				"license_type": {
					"type": "table",
					"attr": {
						"type": {
							"type": "string",
							"sz": 4
						}
					}
				}
			},
			"response": {
			}
		}
	}
}
