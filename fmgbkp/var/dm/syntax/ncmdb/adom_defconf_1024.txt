
config sql-report dataset
end



config sql-report chart
end


config sql-report layout
end

config sql-report layout-folder
	edit 99999
		set folder-name "Default Templates"
		set protected enable
	next
end

config alert basic-handler
    edit 28000
        set name "Default-NOC-Docker-Events"
        set description "Default handler for NoC docker events"
        config rule
            edit 1
                set name "Memory report detected"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with message ${msg}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=='0042010266' and msg~\"MEM\""
            next
            edit 2
                set name "CPU report detected"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with message ${msg}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=='0042010266' and msg~\"CPU\""
            next
            edit 3
                set name "Status changed to disable 1"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with changes ${changes}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0001010026 and changes~\"status=disable\" "
            next
            edit 4
                set name "Status changed to disable 2"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with changes ${changes}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0001010026 and changes~\"status=disable\" "
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fmg"
    next
end


config system connectors
    edit 1
        set uuid "5979abf1-a807-47fd-8aca-c03d3b27c124"
        set name "Local Connector"
        set description "Local Connector"
        set status enable
        set type LOCALHOST 
        set auth-type none
        config action
            edit 1
                set name "UPDATE_ASSET_AND_IDENTITY"
                set description "update asset and identity"
                set parameters "{}"
                set status enable
            next
            edit 2
                set name "GET_EVENTS"
                set description "get events"
                set parameters "{}"
                set status enable
            next
            edit 3
                set name "ATTACH_DATA_TO_INCIDENT"
                set description "attach data to incident"
                set parameters "{}"
                set status enable
            next
            edit 4
                set name "RUN_REPORT"
                set description "run report"
                set parameters "{}"
                set status enable
            next
            edit 5
                set name "GET_ENDPOINT_VULNERABILITIES"
                set description "get endpoint vulnerabilities"
                set parameters "{}"
                set status enable
            next
            edit 6
                set name "CREATE_INCIDENT"
                set description "create incident"
                set parameters "{}"
                set status enable
            next
            edit 7
                set name "UPDATE_INCIDENT"
                set description "update incident"
                set parameters "{}"
                set status enable
            next
        end
    next
    edit 2
        set uuid "d0f89488-b270-11ea-b3de-0242ac130004"
        set name "FortiGuard Connector"
        set description "FortiGuard Connector"
        set status enable
        set type FGD
        set auth-type none
        config action
            edit 1
                set name "GET_IOC_INFO"
                set description "get FortiGuard data for associated IOC"
                set parameters "{\"addr\":null}"
                set status enable
            next
            edit 2
                set name "GET_THREAT_INFO"
                set description "Lookup Fortiguard encyclopedia entry"
                set parameters "{\"threat-type\":null,\"threatID\":null}"
                set status enable
            next
            edit 3
                set name "INDICATOR_LOOKUP"
                set description "Indicator Lookup"
                set parameters "{\"indicator_type\":null,\"indicator_value\":null}"
                set status enable
            next
        end
    next
end

config sql-report layout
end

config sql-report layout-folder
	edit 99999
        set folder-name "Default"
        set protected disable
	next
end
