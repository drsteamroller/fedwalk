#config-version=XXXXXX-4.20-FW-build6137-100302:opmode=0:vdom=0:user=admin

#### Default report Language
config sql-report language
    edit "Default"
        set description "Default"
        set protected enable
    next
    edit "English"
        set description "English"
        set protected enable
    next
    edit "Simplified_Chinese"
        set description "Simplified Chinese"
        set protected enable
    next
    edit "Traditional_Chinese"
        set description "Traditional Chinese"
        set protected enable
    next
    edit "Japanese"
        set description "Japanese"
        set protected enable
    next
    edit "Spanish"
        set description "Spanish"
        set protected enable
    next
    edit "French"
        set description "French"
        set protected enable
    next
    edit "Portuguese"
        set description "Portuguese"
        set protected enable
    next
    edit "Korean"
        set description "Korean"
        set protected enable
    next
end

config system global 
    set oper-mode standalone
end

config system status 
    set major_version 1 
    set patch_num 1 
    set build_point 1 
    set version "" 
    set platform_type "" 
    set host_name "" 
    set serial_number "" 
    set releas_version_info "" 
end

config system connector-template
    edit 1
        set uuid "ccde0b86-fc26-11e9-aad5-362b9e155667"
        set name "EMS Connector"
        set description "Connector to execute remote EMS operations"
        set type EMS
        set status enable
        set auth-type password
        set auth-user "admin"
        set auth-password "ENC lSHFWH4jksOpC1Cw1GSQ4ygtmocg9Rdi3LEE/y/0ZF5LRlzfeuOa57gvBePtweYK20KPw6+lMbEtZkAka9fjhMIRemT3i1pm07n5HN84YbCzJWX9"
        set server-addr ""
        config action
            edit 1
                set name "GET_ENDPOINTS"
                set description "retrieve list of endpoints and all of the related information to enrich fortianalyzer asset and identity views"
                set parameters "{\"url\":\"/report/fct/sysinfo\",\"method\":\"post\",\"params\":{\"filter\":{\"group\":null,\"ip\":null}}}"
                set status enable
            next
            edit 2
                set name "QUARANTINE"
                set description "quarantines endpoints"
                set parameters "{\"url\":\"/clients/quarantine\",\"method\":\"post\",\"params\":{\"ids\":[]}}"
                set status enable
            next
            edit 3
                set name "UNQUARANTINE"
                set description "unquarantines endpoints"
                set parameters "{\"url\":\"/clients/unquarantine\",\"method\":\"post\",\"params\":{\"ids\":[]}}"
                set status enable
            next
            edit 4
                set name "GET_SOFTWARE_INVENTORY"
                set description "retrieve list of software and apps installed on endpoint to enrich fortianalyzer asset view"
                set parameters "{\"url\":\"/clients/software\",\"method\":\"post\",\"params\":{\"id\": null}}"
                set status enable
            next
            edit 5
                set name "VULN_SCAN"
                set description "run vulnerability scan on endpoints"
                set parameters "{\"url\":\"/clients/cmd\",\"method\":\"post\",\"params\":{\"ids\":[],\"cmd\":\"vuln_scan\"}}"
                set status enable
            next
            edit 6
                set name "AV_QUICK_SCAN"
                set description "run quick av scan on endpoints"
                set parameters "{\"url\":\"/clients/cmd\",\"method\":\"post\",\"params\":{\"ids\":[],\"cmd\":\"av_quick_scan\"}}"
                set status enable
            next
            edit 7
                set name "AV_FULL_SCAN"
                set description "run full av scan on endpoints"
                set parameters "{\"url\":\"/clients/cmd\",\"method\":\"post\",\"params\":{\"ids\":[],\"cmd\":\"av_full_scan\"}}"
                set status enable
            next
            edit 8
                set name "GET_PROCESSES"
                set description "retrieve list of running process on endpoints os"
                set parameters "{\"url\":\"/report/fct/snapshot\",\"method\":\"post\",\"params\":{}}"
                set status enable
            next
            edit 8
                set name "TAG_ENDPOINTS"
                set description "tag endpoints on EMS"
                set parameters "{}"
                set status enable
            next
            edit 9
                set name "UNTAG_ENDPOINTS"
                set description "untag endpoints on EMS"
                set parameters "{}"
                set status enable
            next
        end
    next
    edit 2
        set uuid "edf2532c-b25b-11ea-b3de-0242ac130004"
        set name "FML Connector"
        set description "Connector to execute remote FML operations"
        set type FML
        set status enable
        set auth-type password
        set auth-user "admin"
        set auth-password "ENC lSHFWH4jksOpC1Cw1GSQ4ygtmocg9Rdi3LEE/y/0ZF5LRlzfeuOa57gvBePtweYK20KPw6+lMbEtZkAka9fjhMIRemT3i1pm07n5HN84YbCzJWX9"
        set server-addr ""
        config action
            edit 1
                set name "GET_EMAIL_STATISTICS"
                set description "retrieve information of email messages classified as Malware or Spam"
                set parameters "{\"url\":\"/TopUserStats\",\"method\":\"post\",\"params\":{\"time_range\":null,\"email\":null}}"
                set status enable
            next
            edit 2
                set name "GET_SENDER_REPUTATION"
                set description "retrieve information such as the sender, authentication, endpoint reputation"
                set parameters "{\"url\":\"/AsSenderReputation\",\"method\":\"post\",\"params\":{\"ip\":null}}"
                set status enable
            next
            edit 3
                set name "ADD_SENDER_TO_BLOCKLIST"
                set description "disard email received from the blocklist addresses, domains or IPs"
                set parameters "{\"url\":\"/UserMaillist\",\"method\":\"post\",\"params\":{\"email\":null,\"domain_name\":null}}"
                set status enable
            next
        end
    next
    edit 3
        set uuid "fed28ab4-f21c-4a56-bef8-aa74f2abb51d"
        set name "FortiCasb Connector"
        set description "FortiCasb Connector"
        set status disable
        set type FCASB
        set auth-type token
        set auth-user "admin"
        set auth-password "ENC lSHFWH4jksOpC1Cw1GSQ4ygtmocg9Rdi3LEE/y/0ZF5LRlzfeuOa57gvBePtweYK20KPw6+lMbEtZkAka9fjhMIRemT3i1pm07n5HN84YbCzJWX9"
        set server-addr ""
        config action
            edit 1
                set name "GET_FCASB_DATA"
                set description "get data from forticasb"
                set parameters "{}"
                set status enable
            next
        end
    next
end

config system playbook-template
    edit 1
        set uuid "6fcbca29-6374-4a1b-aea0-8efa702865a4"
        set name "Playbook Compromised_Host_Containment"
        set description "Playbook to report and contain compromised host incident"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_TRIGGER\",\"trigger\":{\"type\":\"EVENT_TRIGGER\",\"filter\":{\"match_condition\":\"ALL\",\"conditions\":[{\"field\":\"threat_type\",\"value\":\"ioc\",\"operator\":\"==\"}]},\"render\":{\"top\":184,\"left\":71}}},\"tasks\":[{\"name\":\"Create Incident\",\"id\":\"create_incident\",\"type\":\"LOCALHOST_CREATE_INCIDENT\",\"description\":\"Create incident for endpoint in IoC event\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.epid}\"},\"category\":{\"value\":\"CAT6\"},\"severity\":{\"value\":\"high\"},\"endpoint\":{\"value\":\"${trigger.epname}\"},\"status\":{\"value\":\"draft\"},\"description\":{\"value\":\"IoC incident created for endpoint\"}},\"output\":{\"incident_id\":{}},\"render\":{\"top\":457,\"left\":513}},{\"name\":\"Run Report\",\"id\":\"run_report\",\"type\":\"LOCALHOST_RUN_REPORT\",\"description\":\"Run Report with filter endpoint in IoC event\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"schedule_name\":{\"value\":\"10025\"},\"epid\":{\"value\":\"${trigger.epid}\"}},\"output\":{\"report_uuid\":{}},\"render\":{\"top\":37,\"left\":500}},{\"name\":\"Attach Report to Incident\",\"id\":\"attach_report_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach report to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${run_report.report_uuid}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":42,\"left\":1167}},{\"name\":\"Get Events\",\"id\":\"get_events\",\"type\":\"LOCALHOST_GET_EVENTS\",\"description\":\"Look up events for endpoint in IoC event within last day\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"filter\":{\"value\":{\"match_condition\":\"ALL\",\"conditions\":[{\"field\":\"epid\",\"operator\":\"==\",\"value\":\"${trigger.epid}\"}]}}},\"output\":{\"events\":{}},\"render\":{\"top\":126,\"left\":514}},{\"name\":\"Attach Events to Incident\",\"id\":\"attach_events_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach events to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${get_events.events}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":130,\"left\":1230}},{\"name\":\"Run AV Scan on Endpoint\",\"id\":\"av_scan_endpoint\",\"type\":\"EMS_AV_QUICK_SCAN\",\"description\":\"Run AV Scan on endpoint\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"fctuid\":{\"value\":\"${trigger.fctuid}\"}},\"output\":{\"status\":{}},\"render\":{\"top\":550,\"left\":73}},{\"name\":\"Attach Action Status to Incident\",\"id\":\"attach_action_status_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach action status to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${av_scan_endpoint.status}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":539,\"left\":1162}},{\"name\":\"Get Endpoint Process\",\"type\":\"EMS_GET_PROCESSES\",\"description\":\"Get Endpoint Process\",\"id\":\"get_process\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"fctuid\":{\"value\":\"${trigger.fctuid}\"}},\"render\":{\"top\":322,\"left\":516}},{\"name\":\"Attach Processes To Incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach Processes To Incident\",\"id\":\"attach_processes_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"attach_data\":{\"value\":\"${get_process.processes}\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"}},\"render\":{\"top\":331,\"left\":1193}},{\"name\":\"Get Endpoint Software Inventory\",\"type\":\"EMS_GET_SOFTWARE_INVENTORY\",\"description\":\"Get Endpoint Software Inventory\",\"id\":\"get_software_inventory\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"fctuid\":{\"value\":\"${trigger.fctuid}\"}},\"render\":{\"top\":229,\"left\":507}},{\"name\":\"Attach Software Inventory to Incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach Software Inventory to Incident\",\"id\":\"attach_software_list\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"attach_data\":{\"value\":\"${get_software_inventory.softwares}\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"}},\"render\":{\"top\":238,\"left\":1169}}],\"workflow\":[{\"source_task\":\"STARTER\",\"target_task\":\"create_incident\",\"label\":\"\"},{\"source_task\":\"STARTER\",\"target_task\":\"run_report\",\"label\":\"\"},{\"source_task\":\"STARTER\",\"target_task\":\"get_events\",\"label\":\"\"},{\"source_task\":\"STARTER\",\"target_task\":\"av_scan_endpoint\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_report_to_incident\",\"label\":\"\"},{\"source_task\":\"run_report\",\"target_task\":\"attach_report_to_incident\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_events_to_incident\",\"label\":\"\"},{\"source_task\":\"get_events\",\"target_task\":\"attach_events_to_incident\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_action_status_to_incident\",\"label\":\"\"},{\"source_task\":\"av_scan_endpoint\",\"target_task\":\"attach_action_status_to_incident\",\"label\":\"\"},{\"name\":\"EMS_GET_PROCESSES\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"get_process\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"get_process\",\"target_task\":\"attach_processes_to_incident\"},{\"name\":\"EMS_GET_SOFTWARE_INVENTORY\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"get_software_inventory\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"get_software_inventory\",\"target_task\":\"attach_software_list\"},{\"name\":\"\",\"label\":\"\",\"source_task\":\"create_incident\",\"target_task\":\"attach_software_list\"},{\"name\":\"\",\"label\":\"\",\"source_task\":\"create_incident\",\"target_task\":\"attach_processes_to_incident\"}]}"
    next
    edit 2
        set uuid "05100296-3185-443f-a887-7b62e39dda22"
        set name "Playbook Critical_Intrusion_Incident"
        set description "Playbook to report and contain critical intrusion incident"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_TRIGGER\",\"trigger\":{\"type\":\"EVENT_TRIGGER\",\"filter\":{\"match_condition\":\"ALL\",\"conditions\":[{\"field\":\"threat_type\",\"operator\":\"==\",\"value\":\"ips\"},{\"field\":\"severity\",\"operator\":\"==\",\"value\":\"critical\"}]},\"render\":{\"top\":225,\"left\":100}},\"option\":{\"render\":{\"top\":225,\"left\":100}}},\"tasks\":[{\"name\":\"Create Incident\",\"id\":\"create_incident\",\"type\":\"LOCALHOST_CREATE_INCIDENT\",\"description\":\"Create incident for endpoint in IoC event\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.epid}\"},\"category\":{\"value\":\"CAT3\"},\"severity\":{\"value\":\"high\"},\"endpoint\":{\"value\":\"${trigger.epname}\"},\"status\":{\"value\":\"analysis\"},\"description\":{\"value\":\"this is incident created for endpoint in IPS event\"}},\"output\":{\"incident_id\":{}},\"render\":{\"top\":409,\"left\":400}},{\"name\":\"Run Report\",\"id\":\"run_report\",\"type\":\"LOCALHOST_RUN_REPORT\",\"description\":\"Run Report with filter endpoint in IPS event\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"schedule_name\":{\"value\":\"10007\"}},\"output\":{\"report_uuid\":{}},\"render\":{\"top\":28,\"left\":579}},{\"name\":\"Attach Report to Incident\",\"id\":\"attach_report_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach report to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${run_report.report_uuid}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":400,\"left\":1157}},{\"name\":\"Get Events\",\"id\":\"get_events\",\"type\":\"LOCALHOST_GET_EVENTS\",\"description\":\"Look up events for endpoint in IPS event within last day\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"filter\":{\"value\":{\"match_condition\":\"ALL\",\"conditions\":[{\"field\":\"epid\",\"operator\":\"==\",\"value\":\"${trigger.epid}\"}]}}},\"output\":{\"events\":{}},\"render\":{\"top\":100,\"left\":1150}},{\"name\":\"Attach Events to Incident\",\"id\":\"attach_events_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach events to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${get_events.events}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":228,\"left\":1150}},{\"name\":\"Attach Action Status to Incident\",\"id\":\"attach_action_status_to_incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach action status to incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${create_incident.incident_id}\"},\"attach_data\":{\"value\":\"${ems_run_vuln_scan.status}\"}},\"output\":{\"attach_ids\":{}},\"render\":{\"top\":532,\"left\":1161}},{\"name\":\"Run Vulnerability Scan on Endpoint\",\"type\":\"EMS_VULN_SCAN\",\"description\":\"Run Vulnerability Scan on Endpoint\",\"id\":\"ems_run_vuln_scan\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.dst_epid}\"}},\"render\":{\"top\":542,\"left\":100}}],\"workflow\":[{\"source_task\":\"STARTER\",\"target_task\":\"create_incident\",\"label\":\"\"},{\"source_task\":\"STARTER\",\"target_task\":\"run_report\",\"label\":\"\"},{\"source_task\":\"STARTER\",\"target_task\":\"get_events\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_report_to_incident\",\"label\":\"\"},{\"source_task\":\"run_report\",\"target_task\":\"attach_report_to_incident\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_events_to_incident\",\"label\":\"\"},{\"source_task\":\"get_events\",\"target_task\":\"attach_events_to_incident\",\"label\":\"\"},{\"source_task\":\"create_incident\",\"target_task\":\"attach_action_status_to_incident\",\"label\":\"\"},{\"name\":\"EMS_VULN_SCAN\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"ems_run_vuln_scan\"},{\"name\":\"\",\"label\":\"\",\"source_task\":\"ems_run_vuln_scan\",\"target_task\":\"attach_action_status_to_incident\"}]}"
    next
    edit 3
        set uuid "fdd0823d-e437-4081-b003-7cf0a89a1430"
        set name "Playbook Add_CnC_To_Blacklist"
        set description "Playbook to add CnC IP to blacklist on edge Firewalls"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Add CnC to Blacklist\",\"id\":\"add_cnc_to_blacklist\",\"type\":\"FOS_WEBHOOK\",\"description\":\"Add CnC to Blacklist\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"action\":{\"value\":\"autotest\"},\"parameters\":{\"value\":[{\"name\":\"devid\",\"value\":\"${trigger.devid}\"},{\"name\":\"cncip\",\"value\":\"${trigger.epip}\"}]}},\"render\":{\"top\":100,\"left\":650}}],\"workflow\":[{\"source_task\":\"STARTER\",\"target_task\":\"add_cnc_to_blacklist\",\"label\":\"\"}]}"
    next
    edit 4
        set uuid "61273391-35a9-4d4d-bb91-51278b0b117a"
        set name "Playbook Activate_Strict_IPS"
        set description "Playbook to activate strict IPS profile on Firewall policies"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Activate Strict IPS\",\"id\":\"activate_strict_ips\",\"type\":\"FOS_WEBHOOK\",\"description\":\"Activate Strict IPS\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"action\":{\"value\":\"autotest\"},\"parameters\":{\"value\":[{\"name\":\"devid\",\"value\":\"${trigger.devid}\"},{\"name\":\"policyid\",\"value\":\"7\"}]}},\"render\":{\"top\":100,\"left\":650}}],\"workflow\":[{\"source_task\":\"STARTER\",\"target_task\":\"activate_strict_ips\",\"label\":\"\"}]}"
    next
    edit 5
        set uuid "e120c8f3-ffb7-4630-a904-0012a5cf5955"
        set name "Playbook EMS Get_Endpoint_Processes"
        set description "Playbook to get process list from endpoint"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Get Running Processes on Endpoint\",\"type\":\"EMS_GET_PROCESSES\",\"description\":\"Get Running Processes on Endpoint\",\"id\":\"ems_get_processes\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"fctuid\":{\"value\":\"${trigger.fctuid}\"}},\"render\":{\"top\":100,\"left\":519}},{\"name\":\"Attach Processes List to incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach Processes List to incident\",\"id\":\"faz_attach_processes_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${trigger.incid}\"},\"attach_data\":{\"value\":\"${ems_get_processes.processes}\"}},\"render\":{\"top\":100,\"left\":916}}],\"workflow\":[{\"name\":\"EMS_GET_PROCESSES\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"ems_get_processes\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"ems_get_processes\",\"target_task\":\"faz_attach_processes_to_incident\"}]}"
    next
    edit 6
        set uuid "42bbee31-a87d-40a0-9059-1674ef5ab0f0"
        set name "Playbook EMS Quarantine_Endpoint"
        set description "Playbook to quarantine endpoint"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Quarantine Endpoint\",\"type\":\"EMS_QUARANTINE\",\"description\":\"Quarantine Endpoint\",\"id\":\"ems_quarantine_endpoint\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.epid}\"}},\"render\":{\"top\":100,\"left\":444}},{\"name\":\"Attach action status to incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach action status to incident\",\"id\":\"faz_attach_action_status_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${trigger.incid}\"},\"attach_data\":{\"value\":\"${ems_quarantine_endpoint.status}\"}},\"render\":{\"top\":100,\"left\":844}}],\"workflow\":[{\"name\":\"EMS_QUARANTINE\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"ems_quarantine_endpoint\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"ems_quarantine_endpoint\",\"target_task\":\"faz_attach_action_status_to_incident\"}]}"
    next
    edit 7
        set uuid "123de509-87f0-4a4b-b603-b61e9e6e4e26"
        set name "Playbook EMS Run_AV_Scan"
        set description "Playbook to run AV scan on endpoint"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Run AV Scan on endpoint\",\"type\":\"EMS_AV_FULL_SCAN\",\"description\":\"Run AV Scan on endpoint\",\"id\":\"ems_av_scan\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.epid}\"}},\"render\":{\"top\":115,\"left\":509}},{\"name\":\"Attach action status to incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach action status to incident\",\"id\":\"faz_attach_action_status_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${trigger.incid}\"},\"attach_data\":{\"value\":\"${ems_av_scan.status}\"}},\"render\":{\"top\":115,\"left\":876}}],\"workflow\":[{\"name\":\"EMS_AV_FULL_SCAN\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"ems_av_scan\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"ems_av_scan\",\"target_task\":\"faz_attach_action_status_to_incident\"}]}"
    next
    edit 8
        set uuid "feb82991-cd35-4b03-913b-e1fc5addacf8"
        set name "Playbook EMS Run_Vulnerability_Scan"
        set description "Playbook to run Vulnerability scan on endpoint"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Run Vulnerability Scan on Endpoint\",\"type\":\"EMS_VULN_SCAN\",\"description\":\"Run Vulnerability Scan on Endpoint\",\"id\":\"ems_run_vuln_scan\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"epid\":{\"value\":\"${trigger.epid}\"}},\"render\":{\"top\":100,\"left\":529}},{\"name\":\"Attach action status to incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach action status to incident\",\"id\":\"attach_action_status_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${trigger.incid}\"},\"attach_data\":{\"value\":\"${ems_run_vuln_scan.status}\"}},\"render\":{\"top\":100,\"left\":919}}],\"workflow\":[{\"name\":\"EMS_VULN_SCAN\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"ems_run_vuln_scan\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"ems_run_vuln_scan\",\"target_task\":\"attach_action_status_to_incident\"}]}"
    next
    edit 9
        set uuid "56ba19b9-59d9-4684-8a79-c0ac9d401985"
        set name "Playbook FAZ Run_Report"
        set description "Playbook to run FortiAnalyzer report"
        set created_by "admin"
        set created_on "2020-01-28T00:00:00Z"
        set modified_by "admin"
        set modified_on "2020-01-28T00:00:00Z"
        set status disable
        set version "1.0"
        set tags ""
        set book "{\"play_settings\":{\"play_type\":\"ON_DEMAND\",\"option\":{\"render\":{\"top\":100,\"left\":100}}},\"tasks\":[{\"name\":\"Run Report with filter\",\"type\":\"LOCALHOST_RUN_REPORT\",\"description\":\"Run Report with filter\",\"id\":\"faz_run_report\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"schedule_name\":{\"value\":\"${trigger.schedule_name}\"}},\"render\":{\"top\":116,\"left\":531}},{\"name\":\"Attach Report to incident\",\"type\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"description\":\"Attach Report to incident\",\"id\":\"faz_attach_report_to_incident\",\"input\":{\"connector_uuid\":{\"value\":\"\"},\"incident_id\":{\"value\":\"${trigger.incid}\"},\"attach_data\":{\"value\":\"${faz_run_report.report_uuid}\"}},\"render\":{\"top\":128,\"left\":961}}],\"workflow\":[{\"name\":\"LOCALHOST_RUN_REPORT\",\"label\":\"\",\"source_task\":\"STARTER\",\"target_task\":\"faz_run_report\"},{\"name\":\"LOCALHOST_ATTACH_DATA_TO_INCIDENT\",\"label\":\"\",\"source_task\":\"faz_run_report\",\"target_task\":\"faz_attach_report_to_incident\"}]}"
    next
end

config gui custom-incident-category
    edit 1
        set name "CAT1"
        set disp-name "Unauthorized Access"
        set protected enable
    next
    edit 2
        set name "CAT2"
        set disp-name "Denial of Service (DoS)"
        set protected enable
    next
    edit 3
        set name "CAT3"
        set disp-name "Malicious Code"
        set protected enable
    next
    edit 4
        set name "CAT4"
        set disp-name "Improper Usage"
        set protected enable
    next
    edit 5
        set name "CAT5"
        set disp-name "Scans/Probes/Attempted Access"
        set protected enable
    next
    edit 6
        set name "CAT6"
        set disp-name "Uncategorized"
        set protected enable
    next
end
config alert default-view-assignment
    edit 1
        set view "0e917752-f81b-4db8-b57d-1d6d8e3c83e0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 2
        set view "0e917752-f81b-4db8-b57d-1d6d8e3c83e0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 3
        set view "0e917752-f81b-4db8-b57d-1d6d8e3c83e0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 4
        set view "487bb281-c0b5-4651-800f-6461f283a385"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 5
        set view "487bb281-c0b5-4651-800f-6461f283a385"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 6
        set view "487bb281-c0b5-4651-800f-6461f283a385"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 7
        set view "d4655e5c-51c8-4b88-942a-b9279dd5dc32"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 8
        set view "d4655e5c-51c8-4b88-942a-b9279dd5dc32"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 9
        set view "d4655e5c-51c8-4b88-942a-b9279dd5dc32"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 10
        set view "1a32dde4-f670-4ca7-9d7a-4955b1ea2d7e"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 11
        set view "1a32dde4-f670-4ca7-9d7a-4955b1ea2d7e"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 12
        set view "1a32dde4-f670-4ca7-9d7a-4955b1ea2d7e"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 13
        set view "a411f12e-4b5b-4dcd-85ce-12b0aecbf31f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 14
        set view "a411f12e-4b5b-4dcd-85ce-12b0aecbf31f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 15
        set view "a411f12e-4b5b-4dcd-85ce-12b0aecbf31f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 16
        set view "225eb4bb-289c-4587-abb0-82bd9b7de22f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 17
        set view "225eb4bb-289c-4587-abb0-82bd9b7de22f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 18
        set view "225eb4bb-289c-4587-abb0-82bd9b7de22f"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 19
        set view "78c10bad-22c1-482d-bebd-d8c0aba258c7"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 20
        set view "78c10bad-22c1-482d-bebd-d8c0aba258c7"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 21
        set view "78c10bad-22c1-482d-bebd-d8c0aba258c7"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 22
        set view "626fcd4d-2013-4047-9903-5d31a3442be6"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 23
        set view "626fcd4d-2013-4047-9903-5d31a3442be6"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 24
        set view "626fcd4d-2013-4047-9903-5d31a3442be6"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 25
        set view "f323508a-8668-4697-8890-1e4e21e72f47"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 26
        set view "f323508a-8668-4697-8890-1e4e21e72f47"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 27
        set view "f323508a-8668-4697-8890-1e4e21e72f47"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 28
        set view "a147f0b1-61e9-4673-9190-30acb77ded75"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 29
        set view "a147f0b1-61e9-4673-9190-30acb77ded75"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 30
        set view "a147f0b1-61e9-4673-9190-30acb77ded75"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 31
        set view "a860959e-0825-4476-9eeb-d36c41585f97"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 32
        set view "a860959e-0825-4476-9eeb-d36c41585f97"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 33
        set view "a860959e-0825-4476-9eeb-d36c41585f97"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 34
        set view "00599895-4e24-4f24-867a-fc784cd9e6b3"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 35
        set view "00599895-4e24-4f24-867a-fc784cd9e6b3"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 36
        set view "00599895-4e24-4f24-867a-fc784cd9e6b3"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 37
        set view "5c1e3d0e-4e36-42da-a9c1-60fe3510bc44"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 38
        set view "5c1e3d0e-4e36-42da-a9c1-60fe3510bc44"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 39
        set view "5c1e3d0e-4e36-42da-a9c1-60fe3510bc44"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 40
        set view "043467f3-d82a-4ca0-9bb3-3125ca99ae33"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 41
        set view "043467f3-d82a-4ca0-9bb3-3125ca99ae33"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 42
        set view "043467f3-d82a-4ca0-9bb3-3125ca99ae33"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 43
        set view "d53b589a-5d25-458c-b8f1-d5d4f370b9eb"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 44
        set view "d53b589a-5d25-458c-b8f1-d5d4f370b9eb"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 45
        set view "d53b589a-5d25-458c-b8f1-d5d4f370b9eb"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 46
        set view "4c2ad19e-fd4e-416e-b0bd-3ca59f5b3a93"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 47
        set view "4c2ad19e-fd4e-416e-b0bd-3ca59f5b3a93"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 48
        set view "4c2ad19e-fd4e-416e-b0bd-3ca59f5b3a93"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 49
        set view "de52e03a-2e38-4db3-8f20-5abd955abb18"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 50
        set view "4a51611b-5761-4204-883f-121c70cf7df0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 51
        set view "4a51611b-5761-4204-883f-121c70cf7df0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOC"
    next
    edit 52
        set view "4a51611b-5761-4204-883f-121c70cf7df0"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 53
        set view "b28890c6-ced3-4823-b1ca-5ddd8a81569c"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
    edit 54
        set view "aa35a383-08d9-48da-9b1e-5c6b35217a13"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FOS"
    next
    edit 55
        set view "de52e03a-2e38-4db3-8f20-5abd955abb18"
        set dvm_res_prod "DVM_RESTRICTED_PRD_FSF"
    next
end
config alert default-view-parents
    edit 1
        set uuid "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set name "By Endpoint"
        set icon "ffg ffg-users"
    next
    edit 2
        set uuid "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set name "By Threat"
        set icon "ffg ffg-threats"
    next
    edit 3
        set uuid "944d437d-8494-445d-8f93-5756ec551fbd"
        set name "System Events"
        set icon "ffg ffg-eventlog"
    next
    edit 4
        set uuid "43aeb9b2-f6fb-4c79-91d2-c74dc86c390c"
        set name "Custom View"
        set icon "ffg ffg-custom-view"
    next
end
config alert default-views
    edit 1
        set uuid "0e917752-f81b-4db8-b57d-1d6d8e3c83e0"
        set name "All Security Events"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='By_endpoint'"
    next
    edit 2
        set uuid "487bb281-c0b5-4651-800f-6461f283a385"
        set name "Compromised Hosts"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='C&C' and tag='By_endpoint'"
    next
    edit 3
        set uuid "626fcd4d-2013-4047-9903-5d31a3442be6"
        set name "Sandbox Detections"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='Sandbox,By_endpoint'"
    next
    edit 4
        set uuid "a411f12e-4b5b-4dcd-85ce-12b0aecbf31f"
        set name "Malware Activity"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='Malware,By_endpoint'"
    next
    edit 5
        set uuid "78c10bad-22c1-482d-bebd-d8c0aba258c7"
        set name "Ongoing Intrusions"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='Intrusion,By_endpoint'"
    next
    edit 6
        set uuid "225eb4bb-289c-4587-abb0-82bd9b7de22f"
        set name "Malicious Domain/URL Access"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='Risky,By_endpoint' and (tag='URL' or tag='Domain')"
    next
    edit 7
        set uuid "a860959e-0825-4476-9eeb-d36c41585f97"
        set name "High Risk App Usage"
        set parent "3787103a-faa9-474a-ae40-58be4a0ba06b"
        set filters "tag='Default' and tag='Risky,App,By_endpoint'"
    next
    edit 8
        set uuid "f323508a-8668-4697-8890-1e4e21e72f47"
        set name "All Security Events"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='By_threat'"
    next
    edit 9
        set uuid "a147f0b1-61e9-4673-9190-30acb77ded75"
        set name "C&C Call Backs"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='By_threat' and tag='C&C'"
    next
    edit 10
        set uuid "00599895-4e24-4f24-867a-fc784cd9e6b3"
        set name "Sandbox Detections"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='Sandbox,By_threat'"
    next
    edit 11
        set uuid "5c1e3d0e-4e36-42da-a9c1-60fe3510bc44"
        set name "Malware Activity"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='Malware,By_threat'"
    next
    edit 12
        set uuid "043467f3-d82a-4ca0-9bb3-3125ca99ae33"
        set name "Ongoing Intrusions"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='Intrusion,By_threat'"
    next
    edit 13
        set uuid "d53b589a-5d25-458c-b8f1-d5d4f370b9eb"
        set name "Malicious Domain/URL Access"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='Risky,By_threat' and (tag='URL' or tag='Domain')"
    next
    edit 14
        set uuid "4c2ad19e-fd4e-416e-b0bd-3ca59f5b3a93"
        set name "High Risk App Usage"
        set parent "070a3295-91c5-4d46-9bf2-73cb52fa952c"
        set filters "tag='Default' and tag='Risky,App,By_threat'"
    next
    edit 15
        set uuid "de52e03a-2e38-4db3-8f20-5abd955abb18"
        set name "Local Device"
        set parent "944d437d-8494-445d-8f93-5756ec551fbd"
        set filters "tag='Default' and tag='Local,system'"
    next
    edit 16
        set uuid "4a51611b-5761-4204-883f-121c70cf7df0"
        set name "All"
        set parent "944d437d-8494-445d-8f93-5756ec551fbd"
        set filters "tag='Default' and tag='System'"
    next
    edit 17
        set uuid "b28890c6-ced3-4823-b1ca-5ddd8a81569c"
        set name "FortiGate"
        set parent "944d437d-8494-445d-8f93-5756ec551fbd"
        set filters "tag='Default' and tag='System' and devtype='FortiGate'"
    next
    # Special case to show this only in root. filters must be same as above.
    edit 18
        set uuid "aa35a383-08d9-48da-9b1e-5c6b35217a13"
        set name "FortiGate"
        set parent "944d437d-8494-445d-8f93-5756ec551fbd"
        set filters "tag='Default' and tag='System' and devtype='FortiGate'"
    next
end
config fazcfg-template basic-handler root
    edit 20000
        set name "Local Device Event"
        set description "Default local device event handler"
        set data-selector "20000"
        config rule
            edit 1
                set name "Critical or important events"
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set groupby1 "desc"
                set eventtype ""
                set tags "Default,System,Local"
                set extrainfo ""
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 30
                config filter
                    edit 1
                        set key "pri"
                        set value "4"
                        set oper great-or-equal
                    next
                end
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/root"
    next
end
config fazcfg-template basic-handler fgt
    edit 10041
        set name "Default-Botnet-Communication-Detection-By-Endpoint"
        set description "Default event handler to detect botnet communication in network grouped by endpoint"
        config rule
            edit 1
                set name "Traffic to Botnet CnC blocked in virus log"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009248"
            next
            edit 2
                set name "Traffic to Botnet CnC detected in virus log"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009249"
            next
            edit 3
                set name "DNS traffic to Botnet CnC blocked"
                set devtype FortiGate
                set severity high
                set logtype "dns"
                set extrainfo "Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "qname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Domain,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054601 OR logid==1501054600"
            next
            edit 4
                set name "Traffic to Botnet CnC detected in ips log 1"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and (action=='detected' or action=='pass session')"
            next
            edit 5
                set name "Traffic to Botnet CnC blocked in ips log 1"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and action!='detected' and action!='pass session'"
            next
            edit 6
                set name "Traffic from Botnet CnC detected in ips log"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${srcip}:${srcport}, Traffic path: ${devname} (Policy ID:${policyid})\\${srcintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C $groupby2 detected"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and (action=='detected' or action=='pass session')"
            next
            edit 7
                set name "Traffic from Botnet CnC blocked in ips log"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${srcip}:${srcport}, Traffic path: ${devname} (Policy ID:${policyid})\\${srcintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C $groupby2 blocked"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and action!='detected' and action!='pass session'"
            next
            edit 8
                set name "Traffic to Botnet CnC blocked in ips log 2"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet CnC $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,IP,C&C"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0422016400"
            next
            edit 9
                set name "Traffic to Botnet CnC detected in ips log 2"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet CnC $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,IP,C&C"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0422016401"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10042
        set name "Default-Sandbox-Detections-By-Endpoint"
        set description "Default handler to track file submission and Malware detection by FortiSandbox grouped by endpoint"
        config rule
            edit 1
                set name "Malware detected"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename} from ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Malware $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Signature,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0211009235 or logid==0211009237"
            next
            edit 2
                set name "Malware blocked"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename} from ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Malware $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Sandbox,Signature,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0211009234 or logid==0211009236"
            next
            edit 3
                set name "Sandbox detected Malware"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename}, Traffic path: ${dstintf}(Policy:${policyid})\\${dstip}:${dstport}, Checksum:${analyticscksum}"
                set extrainfo-type custom
                set subject "Sandbox detected Malware"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0201009238 and fsaverdict==malicious"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10043
        set name "Default-Compromised Host-Detection-IOC-By-Endpoint"
        set description "Default event handler to detect compromised hosts by FortiAnalyzer IOC feature grouped by endpoint"
        config rule
            edit 1
                set name "Traffic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "traffic"
                set extrainfo "${tdtype}: ${dstip} :${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Compromised host detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,IP,C&C,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 2
                set name "Web traffic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "webfilter"
                set extrainfo "${tdtype}: ${hostname}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Compromised host detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,C&C,URL,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 3
                set name "DNS trafic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "dns"
                set extrainfo "${tdtype}: ${qname}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Compromised host detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,C&C,Domain,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10044
        set name "Default-Risky-Destination-Detection-By-Endpoint"
        set description "Default event handler to detect network traffic to malicious or suspicious destinations grouped by endpoint"
        config rule
            edit 1
                set name "Web request to malicious destination blocked"
                set devtype FortiGate
                set severity medium
                set logtype "webfilter"
                set extrainfo "Domain:${hostname}, Referrer:${referralurl}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Web request to $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper equal
                    next
                end
                set filter-expr "(catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs' or catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 2
                set name "Web request to malicious destination detected"
                set devtype FortiGate
                set severity high
                set logtype "webfilter"
                set extrainfo "Domain:${hostname}, Referrer:${referralurl}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Web request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper not-equal
                    next
                end
                set filter-expr "(catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 3
                set name "Web request to suspicious destination detected"
                set devtype FortiGate
                set severity medium
                set logtype "webfilter"
                set extrainfo "Domain:${hostname}, Referrer:${referralurl}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Web request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper not-equal
                    next
                end
                set filter-expr "(catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 4
                set name "DNS request to malicious destination detected"
                set devtype FortiGate
                set severity high
                set logtype "dns"
                set extrainfo "Domain:${hostname}, Referrer:${referralurl}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 5
                set name "Web request to malicious destination blocked in ips log"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "Domain:${hostname}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Web request to malicious URL blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0421016399"
            next
            edit 6
                set name "DNS request to suspicious destination detected"
                set devtype FortiGate
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname}, Resolved IP: ${ipaddr}, ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 7
                set name "DNS request to malicious destination blocked"
                set devtype FortiGate
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname}, Resolved IP: ${ipaddr}, ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs' or catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 8
                set name "Insecure SSL connection detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL connection detected"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomaly"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 9
                set name "Insecure SSL connection blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL connection blocked"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomaly"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 10
                set name "SSL connection exempted"
                set devtype FortiGate
                set severity low
                set logtype "ssl"
                set extrainfo "SSL connection from ${srcip} to ${dstip}:${dstport} exempt with reason: ${reason}"
                set extrainfo-type custom
                set subject "$groupby2"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-exempt"
                        set oper equal
                    next
                end
            next
            edit 11
                set name "SSH channel detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 12
                set name "SSH channel blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 13
                set name "SSH command detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH Command: ${command} by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command detected"
                set groupby1 "endpoint"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 14
                set name "SSH command blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssh"
                set extrainfo "SSH Command: ${command} by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10045
        set name "Default-Suspicious-File-Detection-By-Endpoint"
        set description "Default Handler to detect suspicious files in network traffic"
        config rule
            edit 1
                set name "Archive file detected"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path:  ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Archive file detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0262008961 OR logid==0262008963 OR logid==0262008965 OR logid==0262008967 OR logid==0262008969 OR logid==0262008971 OR logid==0262008973"
            next
            edit 2
                set name "Archive file blocked"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Archive file blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0262008960 OR logid==0262008962 OR logid==0262008964 OR logid==0262008966 OR logid==0262008968 OR logid==0262008970 OR  logid==0262008972"
            next
            edit 3
                set name "Executable MIME blocked"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Executable MIME blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0203008200"
            next
            edit 4
                set name "Executable MIME detected"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Executable MIME detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0203008201"
            next
            edit 5
                set name "Fragmented MIME blocked"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Fragmented MIME blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0261008450"
            next
            edit 6
                set name "Oversize file detected"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Oversize file detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0213008705"
            next
            edit 7
                set name "Oversize file blocked"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} over ${service}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Oversize file blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,File"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0213008704"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10046
        set name "Default-Malicious-Code-Detection-By-Endpoint"
        set description "Default event handler to detect attacks and malicious codes in network traffic grouped by endpoint"
        set data-selector "10046"
        config rule
            edit 1
                set name "Intrusion detected group by endpoint"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "${direction} intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Intrusion $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Intrusion,Signature,WAN"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(srcintfrole==wan or dstintfrole==wan) and (action=='detected' or action=='pass session')"
            next
            edit 2
                set name "Intrusion blocked group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "${direction} intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Intrusion $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Intrusion,Signature,WAN"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(srcintfrole==wan or dstintfrole==wan) and (action!='detected' and action!='pass session')"
            next
            edit 3
                set name "Internal intrusion detected group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "${direction} internal intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Internal intrusion $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Intrusion,Signature,Internal"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (action=='detected' or action=='pass session')"
            next
            edit 4
                set name "Internal intrusion blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "${direction} internal intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Internal intrusion $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Intrusion,Signature,Internal"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (action!='detected' and action!='pass session')"
            next
            edit 5
                set name "Intrusion detected group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "${direction} intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Intrusion $groupby2 detected"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Intrusion,Signature,WAN"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(srcintfrole==wan or dstintfrole==wan) and (action=='detected' or action=='pass session')"
            next
            edit 6
                set name "Intrusion blocked group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "${direction} intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Intrusion $groupby2 blocked"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Intrusion,Signature,WAN"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(srcintfrole==wan or dstintfrole==wan) and (action!='detected' and action!='pass session')"
            next
            edit 7
                set name "Internal intrusion detected group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "${direction} internal intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Internal intrusion $groupby2 detected"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Intrusion,Signature,Internal"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (action=='detected' or action=='pass session')"
            next
            edit 8
                set name "Internal intrusion blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "${direction} internal intrusion, Source: ${srcintf} (${srcintfrole})\\${srcip}, Destination: ${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Internal intrusion $groupby2 blocked"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Intrusion,Signature,Internal"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (action!='detected' and action!='pass session')"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10047
        set name "Default-Malicious-File-Detection-By-Endpoint"
        set description "Default event handler to detect malicious files in network traffic grouped by endpoint"
        set data-selector "10047"
        config rule
            edit 1
                set name "Malware internal upload detected group by endpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal upload detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,Internal,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 2
                set name "Malware internal download detected group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal download detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,Internal,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 3
                set name "Malware internal download detected group by endpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal download detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,Internal,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 4
                set name "Malware internal upload detected group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal upload detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,Internal,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 5
                set name "Malware internal upload blocked group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal upload blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,Internal,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
            edit 6
                set name "Malware internal download blocked group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal download blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,Internal,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 7
                set name "Malware internal download blocked group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal download blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,Internal,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 8
                set name "Malware internal upload blocked group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 internal upload blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,Internal,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole!=wan and dstintfrole!=wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
            edit 9
                set name "Malware upload to WAN detected group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload to WAN detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,To_WAN,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 10
                set name "Malware provided on WAN detected group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 provided on WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,To_WAN,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 11
                set name "Malware download from WAN detected group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 download from WAN detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,To_WAN,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 12
                set name "Malware upload to WAN detected group by dstendpoint 1"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload to WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,To_WAN,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 13
                set name "Malware upload to WAN blocked group by endpoint"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload to WAN blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,To_WAN,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
            edit 14
                set name "Malware provided on WAN blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 provided on WAN blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,To_WAN,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 15
                set name "Malware download from WAN blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 download from WAN blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,To_WAN,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 16
                set name "Malware upload to WAN blocked group by dstendpoint"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload to WAN blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,To_WAN,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dstintfrole==wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
            edit 17
                set name "Malware upload from WAN detected group by dstendpoint 2"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload from WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,From_WAN,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 18
                set name "Malware provided to WAN detected group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 provided to WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,From_WAN,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 19
                set name "Malware download on WAN detected group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 download on WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,From_WAN,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[3|5]\") and direction=='incoming'"
            next
            edit 20
                set name "Malware upload from WAN detected group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload from WAN detected"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Malware,From_WAN,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[3|5]\") and direction=='outgoing'"
            next
            edit 21
                set name "Malware upload on WAN blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload on WAN blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,From_WAN,Upload,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
            edit 22
                set name "Malware provided to WAN blocked group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 provided to WAN blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,From_WAN,Download,Attacker,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 23
                set name "Malware download on WAN blocked group by endpoint"
                set devtype FortiGate
                set severity low
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 download on WAN blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,From_WAN,Download,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[2|4]\") and direction=='incoming'"
            next
            edit 24
                set name "Malware upload from WAN blocked group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "File:${filename} from URL:${url} through ${devname} (Policy ID:${policyid})\\${srcintf}\\${srcip}"
                set extrainfo-type custom
                set subject "Malware $groupby2 upload from WAN blocked"
                set groupby1 "dstendpoint"
                set groupby2 "virus"
                set eventstatus "mitigated"
                set tags "Default,Malware,From_WAN,Upload,Victim,Signature,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "srcintfrole==wan and (logid~\"021100819[2|4]\") and direction=='outgoing'"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10048
        set name "Default-Risky-App-Detection-By-Endpoint"
        set description "Default Handler to detect high-risk App usage"
        config rule
            edit 1
                set name "Critical risk App blocked"
                set devtype FortiGate
                set severity medium
                set logtype "app-ctrl"
                set extrainfo "AppID:${appid} from Category:${appcat} with Risk:${apprisk} to: ${hostname}(${dstip}:${dstport})"
                set extrainfo-type custom
                set subject "Risky App $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "app"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper equal
                    next
                    edit 2
                        set key "apprisk"
                        set value "critical"
                        set oper equal
                    next
                end
            next
            edit 2
                set name "Critical risk App detected"
                set devtype FortiGate
                set severity high
                set logtype "app-ctrl"
                set extrainfo "AppID:${appid} from Category:${appcat} with Risk:${apprisk} to: ${hostname}(${dstip}:${dstport})"
                set extrainfo-type custom
                set subject "Risky App $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "app"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper not-equal
                    next
                    edit 2
                        set key "apprisk"
                        set value "critical"
                        set oper equal
                    next
                end
            next
            edit 3
                set name "High risk App blocked"
                set devtype FortiGate
                set severity low
                set logtype "app-ctrl"
                set extrainfo "AppID:${appid} from Category:${appcat} with Risk:${apprisk} to: ${hostname}(${dstip}:${dstport})"
                set extrainfo-type custom
                set subject "Risky App $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "app"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper equal
                    next
                    edit 2
                        set key "apprisk"
                        set value "high"
                        set oper equal
                    next
                end
            next
            edit 4
                set name "High risk App detected"
                set devtype FortiGate
                set severity medium
                set logtype "app-ctrl"
                set extrainfo "AppID:${appid} from Category:${appcat} with Risk:${apprisk} to: ${hostname}(${dstip}:${dstport})"
                set extrainfo-type custom
                set subject "Risky App $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "app"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper not-equal
                    next
                    edit 2
                        set key "apprisk"
                        set value "high"
                        set oper equal
                    next
                end
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10049
        set name "Default-Malicious-File-Detection-By-Threat"
        set description "Default UTM Antivirus event handler"
        set data-selector "10047"
        config rule
            edit 1
                set name "Malware uploaded group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware uploaded by $groupby2"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Malware,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid~\"021100819[3|5]\")"
            next
            edit 2
                set name "Malware upload blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware upload by $groupby2 blocked"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Malware,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid~\"021100819[2|4]\")"
            next
            edit 3
                set name "Malware downloaded group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware downloaded to $groupby2"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Malware,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid~\"021100819[3|5]\")"
            next
            edit 4
                set name "Malware download blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware download to $groupby2 blocked"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Malware,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid~\"021100819[2|4]\")"
            next
            edit 5
                set name "Malware uploaded group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware uploaded to $groupby2"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Malware,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid~\"021100819[3|5]\")"
            next
            edit 6
                set name "Malware upload blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware upload to $groupby2 blocked"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Malware,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid~\"021100819[2|4]\")"
            next
            edit 7
                set name "Malware provided group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware provided by $groupby2"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Malware,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid~\"021100819[3|5]\")"
            next
            edit 8
                set name "Malware provided blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware provided by $groupby2 blocked"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Malware,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid~\"021100819[2|4]\")"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10050
        set name "Default-Risky-App-Detection-By-Threat"
        set description "Default UTM Application Control event handler"
        set data-selector "10050"
        config rule
            edit 1
                set name "Risky App usage detected"
                set devtype FortiGate
                set severity high
                set logtype "app-ctrl"
                set extrainfo "App:${app} from Category:${appcat} with Risk:${apprisk}, PolicyID ${policyid} "
                set extrainfo-type custom
                set subject "Risky App usage by $groupby2 detected"
                set groupby1 "app"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper not-equal
                    next
                end
            next
            edit 2
                set name "Risky App usage blocked"
                set devtype FortiGate
                set severity medium
                set logtype "app-ctrl"
                set extrainfo "App:${app} from Category:${appcat} with Risk:${apprisk},  PolicyID ${policyid} "
                set extrainfo-type custom
                set subject "Risky App usage by $groupby2 blocked"
                set groupby1 "app"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,App,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "block"
                        set oper equal
                    next
                end
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10051
        set name "Default-Risky-Destination-Detection-By-Threat"
        set description "Default event handler to detect network traffic to malicious or suspicious destinations grouped by threat"
        config rule
            edit 1
                set name "Web request to malicious destination detected"
                set devtype FortiGate
                set severity high
                set logtype "webfilter"
                set extrainfo "Domain:${hostname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web request to malicious destination from $groupby2 detected"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper not-equal
                    next
                end
                set filter-expr "(catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 2
                set name "Web request to malicious destination blocked"
                set devtype FortiGate
                set severity medium
                set logtype "webfilter"
                set extrainfo "Domain:${hostname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web request to malicious destination from $groupby2 blocked"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper equal
                    next
                end
                set filter-expr "(catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 3
                set name "DNS request to malicious destination detected"
                set devtype FortiGate
                set severity high
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to malicious destination from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 4
                set name "DNS request to malicious destination blocked"
                set devtype FortiGate
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to malicious destination from $groupby2 blocked"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 5
                set name "Web request to suspicious destination detected"
                set devtype FortiGate
                set severity medium
                set logtype "webfilter"
                set extrainfo "Domain:${hostname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web request to suspicious destination from $groupby2 detected"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper not-equal
                    next
                end
                set filter-expr "(catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 6
                set name "Web request to suspicious destination blocked"
                set devtype FortiGate
                set severity low
                set logtype "webfilter"
                set extrainfo "Domain:${hostname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web request to suspicious destination from $groupby2 blocked"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "blocked"
                        set oper equal
                    next
                end
                set filter-expr "(catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 7
                set name "DNS request to suspicious destination detected"
                set devtype FortiGate
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to suspicious destination from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 8
                set name "DNS request to suspicious destination blocked"
                set devtype FortiGate
                set severity low
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to suspicious destination from $groupby2 blocked"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 9
                set name "Web request to malicious destination blocked in ips log"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "URL:${hostname}\\${url}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web request to malicious destination from $groupby2 blocked"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,URL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0421016399"
            next
            edit 10
                set name "Insecure SSL Connection detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL Connection detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomaly"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 11
                set name "Insecure SSL Connection blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL Connection blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomaly"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 12
                set name "SSH channel detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 13
                set name "SSH channel blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 14
                set name "SSH command detected"
                set devtype FortiGate
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH command: ${command} by user: ${login}  to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 15
                set name "SSH command blocked"
                set devtype FortiGate
                set severity low
                set logtype "ssh"
                set extrainfo "SSH command: ${command} by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10052
        set name "Default-Malicious-Code-Detection-By-Threat"
        set description "Default event handler to detect attacks and malicious codes in network traffic grouped by threat"
        set data-selector "10046"
        config rule
            edit 1
                set name "Intrusion detected group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Intrusion from $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Intrusion,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (action=='detected' or action=='pass session')"
            next
            edit 2
                set name "Intrusion blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Intrusion from $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Intrusion,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (action!='detected' and action!='pass session')"
            next
            edit 3
                set name "Intrusion detected group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Intrusion to $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Intrusion,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (action=='detected' or action=='pass session')"
            next
            edit 4
                set name "Intrusion blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Intrusion to $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Intrusion,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (action!='detected' and action!='pass session')"
            next
            edit 5
                set name "Incoming Intrusion detected group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Incoming Intrusion to $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Intrusion,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (action=='detected' or action=='pass session')"
            next
            edit 6
                set name "Incoming Intrusion blocked group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Incoming Intrusion to $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Intrusion,Signature,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (action!='detected' and action!='pass session')"
            next
            edit 7
                set name "Incoming Intrusion detected group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Incoming Intrusion from $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Intrusion,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (action=='detected' or action=='pass session')"
            next
            edit 8
                set name "Incoming Intrusion blocked group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "ips"
                set extrainfo "Intrusion: ${attack} with severity:${severity}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Incoming Intrusion from $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Intrusion,Signature,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (action!='detected' and action!='pass session')"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10053
        set name "Default-Sandbox-Detections-By-Threat"
        set description "Default handler to track file submission and Malware detection by FortiSandbox grouped by threat"
        config rule
            edit 1
                set name "Malware uploaded (Sandbox) group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware uploaded by $groupby2 (Sandbox)"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid==0211009235 or logid==0211009237)"
            next
            edit 2
                set name "Malware upload blocked (Sandbox) group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware upload by $groupby2 blocked (Sandbox)"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid==0211009234 or logid==0211009236)"
            next
            edit 3
                set name "Malware downloaded (Sandbox) group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware downloaded to $groupby2 (Sandbox)"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid==0211009235 or logid==0211009237)"
            next
            edit 4
                set name "Malware download blocked (Sandbox) group by endpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Malware download to $groupby2 blocked (Sandbox)"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid==0211009234 or logid==0211009236)"
            next
            edit 5
                set name "Malware uploaded (Sandbox) group by dstendpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware uploaded to $groupby2 (Sandbox)"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid==0211009235 or logid==0211009237)"
            next
            edit 6
                set name "Malware upload blocked (Sandbox) group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware upload to $groupby2 blocked (Sandbox)"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Victim"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=outgoing and (logid==0211009234 or logid==0211009236)"
            next
            edit 7
                set name "Malware provided (Sandbox) group by endpoint"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware provided by $groupby2 (Sandbox)"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid==0211009235 or logid==0211009237)"
            next
            edit 8
                set name "Malware provided blocked (Sandbox) group by dstendpoint"
                set devtype FortiGate
                set severity medium
                set logtype "virus"
                set extrainfo "Malware:${virus} with severity:${crlevel} found in file:${filename}, Traffic path: PolicyID ${policyid}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Malware provided by $groupby2 blocked (Sandbox)"
                set groupby1 "virus"
                set groupby2 "dstendpoint"
                set eventstatus "mitigated"
                set tags "Default,Sandbox,Signature,By_Threat,Malware,Attacker"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=incoming and (logid==0211009234 or logid==0211009236)"
            next
            edit 9
                set name "Sandbox detected Malware in traffic group by endpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "Checksum:${analyticscksum}, Traffic to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Sandbox detected Malware in traffic from $groupby2"
                set groupby1 "filename"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,Sandbox,By_Threat,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0201009238 and fsaverdict==malicious"
            next
            edit 10
                set name "Sandbox detected Malware in traffic group by dstendpoint"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "Checksum:${analyticscksum}, Traffic from ${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Sandbox detected Malware in traffic to $groupby2"
                set groupby1 "filename"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 30
                set filter-expr "logid==0201009238 and fsaverdict==malicious"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10054
        set name "Default-Data-Leak-Detection-By-Threat"
        set description "Default Data Leak Detection Handler Grouped by Threat"
        config rule
            edit 1
                set name "Data leak detected"
                set devtype FortiGate
                set severity medium
                set logtype "dlp"
                set extrainfo "File:${filename} (Type:${filetype}, Size:${filesize}), Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Data leak from $groupby2 detected"
                set groupby1 "filtercat"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Signature,Leak"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action==log-only or action==allow"
            next
            edit 2
                set name "Data leak blocked"
                set devtype FortiGate
                set severity low
                set logtype "dlp"
                set extrainfo "File:${filename} (Type:${filetype}, Size:${filesize}), Traffic path: PolicyID ${policyid}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Data leak from $groupby2 blocked"
                set groupby1 "filtercat"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Signature,Leak"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action!=log-only and action!=allow"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10055
        set name "Default-Compromised Host-Detection-IOC-By-Threat"
        set description "Default event handler to detect compromised hosts by FortiAnalyzer IOC feature grouped by threat"
        config rule
            edit 1
                set name "Traffic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "traffic"
                set extrainfo "Traffic to C&C:${dstip}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to C&C from $groupby2 detected"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,IP,C&C,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 2
                set name "Web traffic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "webfilter"
                set extrainfo "Traffic to C&C:${hostname}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web traffic to C&C from $groupby2 detected"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C,URL,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 3
                set name "DNS traffic to CnC detected"
                set devtype FortiGate
                set severity critical
                set logtype "dns"
                set extrainfo "Traffic to C&C:${qname}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS traffic to C&C from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C,Domain,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 4
                set name "Traffic to CnC event detected by FortiGate"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "FGT detected traffic to IOC location, from the source ip:${srcip}"
                set extrainfo-type custom
                set subject "Traffic to C&C from $groupby1 detected"
                set groupby1 "srcip"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0100020214"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10056
        set name "Default-Botnet-Communication-Detection-By-Threat"
        set description "Default event handler to detect botnet communication in network grouped by threat"
        config rule
            edit 1
                set name "Traffic to Botnet CnC blocked in virus log"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "Traffic to Botnet C&C ${virus},  Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C from $groupby2 blocked"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009248"
            next
            edit 2
                set name "Traffic to Botnet CnC detected in virus log"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "Traffic to Botnet C&C ${virus}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C from $groupby2 detected"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009249"
            next
            edit 3
                set name "DNS traffic to Botnet CnC blocked"
                set devtype FortiGate
                set severity high
                set logtype "dns"
                set extrainfo "Traffic to Botnet C&C domain: ${qname}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS traffic to Botnet C&C from $groupby2 blocked"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,Domain,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054601 OR logid==1501054600"
            next
            edit 4
                set name "Traffic to Botnet CnC detected in ips log 1"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "Traffic to Botnet C&C ${attack}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C from $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and (action=='detected' or action=='pass session')"
            next
            edit 5
                set name "Traffic to Botnet CnC blocked in ips log 1"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Traffic to Botnet C&C ${attack}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C from $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and action!='detected' and action!='pass session'"
            next
            edit 6
                set name "Traffic from Botnet CnC detected in ips log"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "Traffic from Botnet C&C ${attack}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcintf}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C to $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and (action=='detected' or action=='pass session')"
            next
            edit 7
                set name "Traffic from Botnet CnC blocked in ips log"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Traffic from Botnet C&C ${attack}, Reference: ${ref}, Traffic path: PolicyID ${policyid}\\${srcintf}\\${srcip}:${srcport}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C to $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,Signature,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and action!='detected' and action!='pass session'"
            next
            edit 8
                set name "Traffic to Botnet CnC blocked in ips log 2"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "Traffic to C&C:${dstip}, Reference: ${ref}, Traffic path: PolicyID:${policyid}\\${dstintf}"
                set extrainfo-type custom
                set subject "Traffic to Botnet $groupby1 from $groupby2 blocked"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,IP,C&C"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0422016400"
            next
            edit 9
                set name "Traffic to Botnet CnC detected in ips log 2"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "Traffic to C&C:${dstip}, Reference: ${ref}, Traffic path: PolicyID:${policyid}\\${dstintf}"
                set extrainfo-type custom
                set subject "Traffic to Botnet $groupby1 from $groupby2 detected"
                set groupby1 "attack"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0422016401"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 10057
        set name "Default FOS System Events"
        set description "Default event handler for selected FortiOS system event logs grouped by device"
        config rule
            edit 1
                set name "Important events"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "4"
                        set oper equal
                    next
                    edit 2
                        set key "pri"
                        set value "3"
                        set oper equal
                    next
                end
            next
            edit 2
                set name "Critical events"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "2"
                        set oper great-or-equal
                    next
                end
            next
            edit 3
                set name "Wireless event log id matched"
                set devtype FortiGate
                set severity low
                set logtype "event"
                set utmevent "wireless"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0104043521 or logid==0104043530 or logid==0104043531 or logid==0104043532 or logid==0104043533 or logid==0104043534 or logid==0104043535 or logid==0104043542 or logid==0104043544 or logid==0104043546 or logid==0104043548 or logid==0104043552 or logid==0104043553 or logid==0104043555 or logid==0104043557 or logid==0104043558 or logid==0104043560 or logid==0104043563 or logid==0104043564 or logid==0104043565 or logid==0104043566 or logid==0104043571 or logid==0104043573 or logid==0104043575 or logid==0104043577 or logid==0104043613 or logid==0104043614 or logid==0104043615"
            next
            edit 4
                set name "Event log id matched 1"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0109045152 or logid==0107045082 or logid==0107045110 or logid==0110052000 or logid==0100032044"
            next
            edit 5
                set name "Event log id matched 2"
                set devtype FortiGate
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0108037892 or logid==0100020117 or logid==0100020220 or logid==0100020221 or logid==0100022017 or logid==0100022018 or logid==0100022917 or logid==0100032023 or logid==0100032103 or logid==0100032140 or logid==0100032141 or logid==0100032142 or logid==0100032146 or logid==0100032149 or logid==0100032158 or logid==0100032159 or logid==0100032231 or logid==0100032232 or logid==0100032233 or logid==0100032238 or logid==0100032241 or logid==0100032564 or logid==0100032602 or logid==0100032603 or logid==0100032605 or logid==0101041989 or logid==0101041990 or logid==0105040960"
            next
            edit 6
                set name "Event log id matched 3"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0100020005 or logid==0100020006 or logid==0100020090 or logid==0100022901 or logid==0100022902 or logid==0100022912 or logid==0100022913 or logid==0100022915 or logid==0101023101 or logid==0101023102 or logid==0101039424 or logid==0101039425 or logid==0101039940 or logid==0101039943 or logid==0101039947 or logid==0101039948 or logid==0101039952 or logid==0101039953 or logid==0101040001 or logid==0101040002 or logid==0101040019 or logid==0101040038 or logid==0101040039 or logid==0101040101 or logid==0101040102 or logid==0101040118 or logid==0101037139"
            next
            edit 7
                set name "Event log id matched 4"
                set devtype FortiGate
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0100022950 or logid==0100022951 or logid==0100029002 or logid==0100029003 or logid==0100032001 or logid==0100032003 or logid==0102038031 or logid==0102038032 or logid==0102043008 or logid==0102043009 or logid==0102043014 or logid==0102043015 or logid==0102043016 or logid==0102043017 or logid==0102043025 or logid==0102043026 or logid==0102043039 or logid==0102043040 or logid==0102043045 or logid==0102043046"
            next
            edit 8
                set name "Event log id matched 5"
                set devtype FortiGate
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0107045114 or logid==0107045115 or logid==0107045116 or logid==0100022850 or logid==0100022851 or logid==0100043776 or logid==0100043777 or logid==0100046600"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30000
        set name "Default-Botnet-Communication-Detection"
        set description "Default event handler to detect botnet communication and report to FortiGate"
        set automation-stitch enable
        config rule
            edit 1
                set name "Traffic to Botnet CnC blocked in virus log"
                set devtype FortiGate
                set severity high
                set logtype "virus"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009248"
            next
            edit 2
                set name "Traffic to Botnet CnC detected in virus log"
                set devtype FortiGate
                set severity critical
                set logtype "virus"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "open"
                set tags "Default,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0202009249"
            next
            edit 3
                set name "DNS traffic to Botnet CnC blocked"
                set devtype FortiGate
                set severity high
                set logtype "dns"
                set extrainfo "Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "qname"
                set eventstatus "open"
                set tags "Default,Botnet,Domain,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054601 OR logid==1501054600"
            next
            edit 4
                set name "Traffic to Botnet CnC detected in ips log 1"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,Signature,C&C,Incoming"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and (action=='detected' or action=='pass session')"
            next
            edit 5
                set name "Traffic to Botnet CnC blocked in ips log 1"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,Signature,C&C,Incoming"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=incoming and action!='detected' and action!='pass session'"
            next
            edit 6
                set name "Traffic from Botnet CnC detected in ips log"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${srcip}:${srcport}, Traffic path: ${devname} (Policy ID:${policyid})\\${srcintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C $groupby2 detected"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,Signature,C&C,Outgoing"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and (action=='detected' or action=='pass session')"
            next
            edit 7
                set name "Traffic from Botnet CnC blocked in ips log"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${srcip}:${srcport}, Traffic path: ${devname} (Policy ID:${policyid})\\${srcintf}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic from Botnet C&C $groupby2 blocked"
                set groupby1 "dstendpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,Signature,C&C,Outgoing"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "attack ~ Botnet and direction=outgoing and action!='detected' and action!='pass session'"
            next
            edit 8
                set name "Traffic to Botnet CnC blocked in ips log 2"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0422016400"
            next
            edit 9
                set name "Traffic to Botnet CnC detected in ips log 2"
                set devtype FortiGate
                set severity critical
                set logtype "ips"
                set extrainfo "C&C: ${dstip}:${dstport}, Reference: ${ref}"
                set extrainfo-type custom
                set subject "Traffic to Botnet C&C $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "attack"
                set eventstatus "open"
                set tags "Default,Botnet,IP,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 30
                set filter-expr "logid==0422016401"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30001
        set name "Default-IPS-Signature-On-Hold"
        set description "Default Event Handler to show IPS signatures that are currently on-hold in FortiGate due to hold time settings."
        config rule
            edit 1
                set name "Signature is on hold"
                set devtype FortiGate
                set severity high
                set logtype "ips"
                set extrainfo "${msg}"
                set extrainfo-type custom
                set subject "Signature [ $groupby2 ] is on hold"
                set groupby1 "hostname"
                set groupby2 "attack"
                set tags "Default,IPS,Signature,Hold"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"signature is on hold\" and (logid==0419016384)"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30002
        set name "Default-NOC-SD-WAN-Events"
        set description "Default handler for NoC sd-wan events"
        config rule
            edit 1
                set name "SLA failed for jitter"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "On ${devname} the SLA  for the ${healthcheck} failed for ${metric} with the current value of ${jitter} which violates the target ID ${slatargetid}.  "
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 SLA failed for $groupby2"
                set groupby1 "devname"
                set groupby2 "healthcheck"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==\"sdwan\" AND metric==\"jitter\" AND msg~\"SLA failed\""
            next
            edit 2
                set name "SLA failed for latency"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "On ${devname} the SLA  for the ${healthcheck} failed for ${metric} with the current value of ${latency} which violates the target ID ${slatargetid}.  "
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 SLA failed for $groupby2"
                set groupby1 "devname"
                set groupby2 "healthcheck"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==\"sdwan\" AND metric==\"latency\" AND msg~\"SLA failed\""
            next
            edit 3
                set name "SLA failed for packetloss"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "On ${devname} the SLA  for the ${healthcheck} failed for ${metric} with the current value of ${packetloss} which violates the target ID ${slatargetid}.  "
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 SLA failed for $groupby2"
                set groupby1 "devname"
                set groupby2 "healthcheck"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==\"sdwan\" AND metric==\"packetloss\" AND msg~\"SLA failed\""
            next
            edit 4
                set name "Device status changed to die"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} with status ${newvalue}. ${msg}."
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 $groupby2 status changed to die."
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022925\" AND  newvalue=\"die\""
            next
            edit 5
                set name "Device status changed to alive."
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} with status ${newvalue}. ${msg}."
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 $groupby2 status changed to alive."
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022925\" AND newvalue=\"alive\""
            next
            edit 6
                set name "Device status is up"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} ${msg} status is ${status}. "
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 health check for $groupby2 status up."
                set groupby1 "devname"
                set groupby2 "healthcheck"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022925\" AND status==\"up\""
            next
            edit 7
                set name "Device status is down"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} ${msg} status is ${status}. "
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 health check for $groupby2 status down."
                set groupby1 "devname"
                set groupby2 "healthcheck"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022925\" AND status==\"down\""
            next
            edit 8
                set name "Number of pass member changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${msg} from ${oldvalue} to ${newvalue} for ${devname}"
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022923\" AND msg=\"Number of pass member changed.\" "
            next
            edit 9
                set name "Member status changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${msg}. Member is now ${member} on ${devname}"
                set extrainfo-type custom
                set utmevent "sdwan"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,SD-WAN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0113022923\" AND msg=\"Member status changed. Member out-of-sla.\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30003
        set name "Default-NOC-VPN-Events"
        set description "Default handler for NoC VPN events"
        config rule
            edit 1
                set name "User SSL VPN login failed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} due to: ${reason}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 SSL VPN login failed for user $groupby2"
                set groupby1 "devname"
                set groupby2 "enduser"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0101039426\" and action==\"ssl-login-fail\""
            next
            edit 2
                set name "IPsec phase 1 error or status fail detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} due to: ${status} with reason: ${reason}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 $groupby2 detected"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(logid==\"0101037124\" OR logid==\"0101037120\") and (logdesc==\"IPsec phase 1 error\" OR status=\"fail\")"
            next
            edit 3
                set name "IPsec ESP error detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${status} on: ${devname}, ${error_num}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 $groupby2 error detected"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0101037131\" and logdesc==\"IPsec ESP\""
            next
            edit 4
                set name "IPsec DPD failed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${msg} on device: ${devname}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 has experienced $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0101037136\" and logdesc==\"IPsec DPD failed\" "
            next
            edit 5
                set name "Device tunnel-up or tunnel-down detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${msg} due to: ${action}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 status changed to $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0101037138\" and (action=\"tunnel-up\" or action= \"tunnel-down\") "
            next
            edit 6
                set name "IPsec phase 2 error detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} due to: ${reason}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0101037125\" and logdesc==\"IPsec phase 2 error\""
            next
            edit 7
                set name "Device phase2-up or phase2-down detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} due to: ${action}"
                set extrainfo-type custom
                set utmevent "vpn"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,VPN"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0101037139\" and (action==\"phase2-up\" OR action==\"phase2-down\")"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30004
        set name "Default-NOC-System-Events"
        set description "Default handler for NoC system events"
        config rule
            edit 1
                set name "Device shutdown detected"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "${devname} experienced $logdesc with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 experienced a $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,System,Power,CPU,Memory,Storage"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Device shutdown\""
            next
            edit 2
                set name "Device conserve mode detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} on Device: ${devname} with message ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,System,Power,CPU,Memory,Storage"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"conserve mode\""
            next
            edit 3
                set name "Disk or memory is full"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} ${logdesc} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,System,Power,CPU,Memory,Storage"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Disk log full over first warning\" OR logdesc==\"Memory log full over first warning level\" OR logdesc==\"Memory log full over second warning level\" OR logdesc==\"Memory log full over final warning level\" OR logdesc==\"Disk full\" OR logdesc==\"Disk log rolled\" OR  logdesc==\"Log disk full\""
            next
            edit 4
                set name "Device high CPU consumption detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${devid} performance cpu: ${cpu}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2 for CPU is high"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set tags "Default,NOC,System,Power,CPU,Memory,Storage"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cpu>=\"80\" "
            next
            edit 5
                set name "Device high memory consumption detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${devid} performance memory: ${memory}"
                set utmevent "system"
                set subject "$groupby1 $groupby2 for memory is high"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,System,Power,CPU,Memory,Storage"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "mem>=\"75\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30005
        set name "Default-NOC-Fabric-Events"
        set description "Default handler for NoC Fabric events"
        config rule
            edit 1
                set name "Device offline detected"
                set devtype FortiAnalyzer
                set severity high
                set logtype "appevent"
                set utmevent "_any_"
                set extrainfo "${logdev_id} is offline"
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "logdev_name"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "desc=\"Device offline\""
            next
            edit 2
                set name "FortiAnalyzer connection down detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"FortiAnalyzer connection down\""
            next
            edit 3
                set name "Connection with authorized CSF member terminated"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} on: ${devid} due to: ${reason}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Connection with authorized CSF member terminated\""
            next
            edit 4
                set name "Automation stitch triggered"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on: ${devname} with message: ${msg} and stitch action: ${stitchaction}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Automation stitch triggered\""
            next
            edit 5
                set name "Device license failed or expiring detected"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "${logdesc} on: ${devid} "
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc~\"license failed\"  OR logdesc~\"license expiring\""
            next
            edit 6
                set name "System update or failure detected"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "${logdesc} on: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc~\"update\" AND logdesc~\"failed\""
            next
            edit 7
                set name "Security fabric settings change detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} change with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 security fabric settings change: $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Fabric"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Settings modified by Security Fabric service\" OR logdesc==\"Looped configuration in Security Fabric service\" OR logdesc==\"Connection with CSF member established and authorized\" OR logdesc==\"Connection with authorized CSF member terminated\" OR logdesc==\"Serial number of upstream is changed\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30006
        set name "Default-NOC-Security-Events"
        set description "Default handler for NoC security events"
        config rule
            edit 1
                set name "Admin login failed or desabled"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} for ${user} on device: ${devname} due to: ${reason} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Security,Login,Password"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Admin login failed\" OR logdesc==\"Admin login disabled\"OR logdesc==\"SSL VPN login fail\""
            next
            edit 2
                set name "Admin password expired"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} ${logdesc} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC, Security,Login,Password"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Admin password expired\""
            next
            edit 3
                set name "Admin disconnected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${logdesc} on device: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Security,Login,Password"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Admin disconnected\" OR logdesc==\"Admin monitor disconnected\" "
            next
            edit 4
                set name "AV or IPS change detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} ${logdesc} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Security,Login,Password"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"AV updated by admin\" OR logdesc==\"IPS package - Admin update successful\" OR logdesc==\"AV package update by SCP failed\" OR logdesc==\"IPS package failed to update via SCP\" OR logdesc==\"IPS custom signatures backup failed\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30007
        set name "Default-NOC-Wireless-Events"
        set description "Default handler for NoC wireless events"
        config rule
            edit 1
                set name "Fake AP detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc}. SN: ${sndetected}"
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby1 Fake AP detected with SSID: $groupby2"
                set groupby1 "devname"
                set groupby2 "ssid"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0104043567\" AND logdesc==\"Fake AP detected\""
            next
            edit 2
                set name "Rogue AP detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc}. SN: ${sndetected} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby1 Rogue AP detected with SSID: $groupby2"
                set groupby1 "devname"
                set groupby2 "ssid"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==\"0104043563\" AND logdesc==\"Rogue AP detected\""
            next
            edit 3
                set name "Wireless event log id matched"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc}. of AP: ${ap}"
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype=\"wireless\" AND (logid==\"0104043551\" OR logid==\"0104043552\" OR logid==\"0104043553\")"
            next
            edit 4
                set name "Wireless client activity detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} for ${ssid} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(logdesc==\"Wireless client associated\" OR logdesc==\"Wireless client authenticated\" OR logdesc==\"Wireless client disassociated\" OR logdesc==\"Wireless client deauthenticated\" OR logdesc==\"Wireless client idle\" OR logdesc==\"Wireless client denied\" OR logdesc==\"Wireless client kicked\" OR logdesc=\"Wireless client IP assigned\" OR logdesc==\"Wireless client left WTP\" OR logdesc==\"Wireless client WTP disconnected\")"
            next
            edit 5
                set name "Signal-to-noise ratio is poor"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "SSID ${ssid}. has a poor quality SNR at ${snr} dB."
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "Signal-to-noise ratio on $groupby1 is poor"
                set groupby1 "devname"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "snr<=\"24\""
            next
            edit 6
                set name "Signal-to-noise ratio is fair"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "SSID ${ssid}. has fair quality SNR at ${snr} dB."
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "Signal-to-noise ratio on $groupby1 is fair"
                set groupby1 "devname"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "snr>=\"25\" and snr<=\"40\""
            next
            edit 7
                set name "Signal-to-noise ratio on is excellent"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "SSID ${ssid}. has excellent quality SNR at ${snr} dB."
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "Signal-to-noise ratio on $groupby1 is excellent"
                set groupby1 "devname"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "snr>=\"41\" "
            next
            edit 8
                set name "Physical AP radio ssid up"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${sn} SSID status change with message ${msg}."
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby2 for $groupby1"
                set groupby1 "ssid"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Physical AP radio ssid up\" and action=\"ssid-up\""
            next
            edit 9
                set name "Physical AP radio ssid down"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${sn} SSID status change with message ${msg}."
                set extrainfo-type custom
                set utmevent "wireless"
                set subject "$groupby2 for $groupby1"
                set groupby1 "ssid"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Wireless,Wifi,AP"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Physical AP radio ssid down\" and action=\"ssid-down\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30008
        set name "Default-NOC-HA-Events"
        set description "Default handler for NoC HA Cluster events"
        config rule
            edit 1
                set name "HA device interface failed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set utmevent "ha"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"HA device interface failed\" and logid==\"0108037898\""
            next
            edit 2
                set name "Device set as HA primary"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} has been set to HA Primary with msg: ${msg}"
                set extrainfo-type custom
                set utmevent "ha"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Device set as HA primary\""
            next
            edit 3
                set name "Cluster state moved or Heartbeat device interface down"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname}  ${logdesc} with HA role: ${ha_role}"
                set extrainfo-type custom
                set utmevent "ha"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Virtual cluster member state moved\" OR logdesc==\"Heartbeat device interface down\""
            next
            edit 4
                set name "Synchronization activity detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "HA synchronization status for Device: ${devname} ${logdesc}. Message: ${msg}. Status is: ${sync_status} "
                set extrainfo-type custom
                set utmevent "ha"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"HA secondary synchronization failed\" OR logdesc==\"Secondary sync failed\" OR logdesc=\"Synchronization status with master\""
            next
            edit 5
                set name "FortiAnalyzer connection up"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"connect\" and  status=\"success\" and logdesc=\"FortiAnalyzer connection up\""
            next
            edit 6
                set name "FortiAnalyzer connection failed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"connect\" and status=\"failure\" and logdesc=\"FortiAnalyzer connection failed\""
            next
            edit 7
                set name "Upstream connection with CSF member established and authorized"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for device $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=\"upstream\" and logdesc=\"Connection with CSF member established and authorized\""
            next
            edit 8
                set name "Upstream connection with authorized CSF member terminated"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for device $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction=\"upstream\" and logdesc=\"Connection with authorized CSF member terminated\""
            next
            edit 9
                set name "FortiManager tunnel connection up"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${logdesc} with message - ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for device $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"connect\" and status=\"success\" and logdesc=\"FortiManager tunnel connection up\""
            next
            edit 10
                set name "FortiManager tunnel connection down"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device ${devname} ${logdesc} with message - ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby2 for device $groupby1"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,HA,Cluster"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"connect\" and status=\"failure\" and logdesc=\"FortiManager tunnel connection down\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30009
        set name "Default-NOC-Switch-Events"
        set description "Default handler for NoC switch events"
        config rule
            edit 1
                set name "Switch-Controller activity detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc}"
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(subtype=\"switch-controller\") and (logdesc==\"Switch-Controller discovered\" OR logdesc==\"Switch-Controller authorized\" OR logdesc==\"Switch-Controller deauthorized\" OR logdesc==\"Switch-Controller deleted\" OR logdesc==\"Switch-Controller warning\")"
            next
            edit 2
                set name "Vlan interface change has occurred"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} interface vlan change with message: ${msg}"
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2 vlan interface change has occurred"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc='FortiSwitch system' and msg~\"interface vlan\""
            next
            edit 3
                set name "Port switch detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on Device: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"FortiSwitch link\" AND msg~\"switch port\""
            next
            edit 4
                set name "Device flap detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"flap\""
            next
            edit 5
                set name "Device LAG-MCLAG status change"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${devname} LAG-MCLAG status update with message: ${msg}"
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2 LAG-MCLAG status change"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"lag\" OR  msg~\"mclag\""
            next
            edit 6
                set name "Device MCLAG split-brain detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0115032695 and msg~\"MCLAG split-brain\""
            next
            edit 7
                set name "Deice cable diagnose detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0115032699 and  msg~\"CABLE DIAGNOSE\""
            next
            edit 8
                set name "Device come up detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id==\"0115032695\" and msg~\"come up\""
            next
            edit 9
                set name "Device gone down detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${msg}."
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Switch,Controller"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id==\"0115032695\" and msg~\"gone down\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30010
        set name "Default-NOC-Network-Events"
        set description "Default handler for NOC network events"
        config rule
            edit 1
                set name "Device SNMP query failed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} ${logdesc} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0100029021\" AND logdesc=\"SNMP query failed\""
            next
            edit 2
                set name "Device routing information changed"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "Device: ${devname} ${logdesc} with message ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"Routing information changed\""
            next
            edit 3
                set name "DHCP client lease granted or usage high"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "DHCP status on Device ${devname} is ${logdesc} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "system"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"DHCP client lease granted\" OR logdesc==\"DHCP lease usage high\" OR logdesc==\"DHCP lease usage full\""
            next
            edit 4
                set name "SNMP enabled"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${logdesc} ${cfgattr} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 SNMP $groupby2 to Enable"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cfgpath=\"system.snmp.sysinfo\" and logdesc=\"Attribute configured\" and cfgattr=status[disable->enable]"
            next
            edit 5
                set name "SNMP disabled"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} ${logdesc} ${cfgattr} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 SNMP $groupby2 to Disable"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cfgpath=\"system.snmp.sysinfo\" and logdesc=\"Attribute configured\" and cfgattr=status[enable->disable]"
            next
            edit 6
                set name "DHCP server status changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "DHCP server status change ${cfgattr} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 DHCP server $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cfgpath=\"system.dhcp.server\" and logdesc=\"Object attribute configured\""
            next
            edit 7
                set name "DHCP lease renewed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Host ${hostname} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 DHCP lease renewed. $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dhcp_msg=\"Ack\" and logdesc=\"DHCP Ack log\""
            next
            edit 8
                set name "DHCP lease released"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Host ${hostname} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 DHCP lease released. $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Network"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "dhcp_msg=\"Release\" and logdesc=\"DHCP Release log\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30011
        set name "Default-NOC-Routing-Events"
        set description "Default handler for NoC routing events"
        config rule
            edit 1
                set name "Routing information changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on ${devname} with message ${msg}  "
                set extrainfo-type custom
                set utmevent "_any_"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Routing"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"Routing information changed\""
            next
            edit 2
                set name "BGP neighbor status changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${devname}. BGP neighbor status changed with message ${msg}  "
                set extrainfo-type custom
                set utmevent "router"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Routing"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc=\"BGP neighbor status changed\""
            next
            edit 3
                set name "OSPF or OSPF6 neighbor status changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on ${devname} with message ${msg}  "
                set extrainfo-type custom
                set utmevent "router"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Routing"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"OSPF neighbor status changed\" OR logdesc==\"OSPF6 neighbor status changed\" "
            next
            edit 4
                set name "Neighbor table changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on ${devname} with message ${msg}"
                set extrainfo-type custom
                set utmevent "router"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Routing"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"neighbor table change\""
            next
            edit 5
                set name "VRRP state changed"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${logdesc} on ${devname} with message ${msg}"
                set extrainfo-type custom
                set utmevent "router"
                set subject "$groupby1 $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Routing"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logdesc==\"VRRP state changed\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30013
        set name "Default-NOC-FortiExtender-Events"
        set description "Default handler for NoC FortiExtender events"
        config rule
            edit 1
                set name "FortiExtender Authorized"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device: ${ip} ${action} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"FortiExtender Authorized\""
            next
            edit 2
                set name "Warning event detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "level=\"warning\""
            next
            edit 3
                set name "Alert event detected"
                set devtype FortiGate
                set severity high
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "level=\"alert\""
            next
            edit 4
                set name "Critical event detected"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "level=\"critical\""
            next
            edit 5
                set name "Error event detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "level=\"error\""
            next
            edit 6
                set name "Emergency event detected"
                set devtype FortiGate
                set severity critical
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "level=\"emergency\""
            next
            edit 7
                set name "FortiExtender controller activity detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0111046401\" and logdesc=\"FortiExtender controller activity\""
            next
            edit 8
                set name "FortiExtender controller activity error detected"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "${action} on ${ip} with message: ${msg}"
                set extrainfo-type custom
                set utmevent "fortiextender"
                set subject "$groupby1 $groupby2"
                set groupby1 "sn"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,FortiExtender"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid=\"0111046402\" and logdesc=\"FortiExtender controller activity error\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30014
        set name "Default-NOC-Interface-Events"
        set description "Default handler for NoC interface events"
        config rule
            edit 1
                set name "Interface status changed to up"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname}, status changed to ${status} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 $groupby2 to Up."
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Interface"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"interface-stat-change\" and status=\"UP\""
            next
            edit 2
                set name "Interface status changed to down"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname}, status changed to ${status} with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 $groupby2 to Down."
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Interface"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "action=\"interface-stat-change\" and status=\"DOWN\""
            next
            edit 3
                set name "DNS server config added"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname}, DNS server status changed with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 DNS Server $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,NOC,Interface,DNS"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cfgpath=\"system.dns-server\" and action=\"Add\""
            next
            edit 4
                set name "DNS server config deleted"
                set devtype FortiGate
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname}, DNS server status changed with message ${msg}."
                set extrainfo-type custom
                set utmevent "system"
                set subject "Device $groupby1 DNS Server $groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set tags "Default,NOC,Interface,DNS"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "cfgpath=\"system.dns-server\" and action=\"Delete\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30015
        set name "Default-Recon-Activity-By-Endpoint"
        set description "Default Handler for Recon Activity detection on the network - Scans/Probes/Attempted Access category"
        set data-selector "30015"
        config rule
            edit 1
                set name "SSH IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 100"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "SSH"
                        set oper equal
                    next
                end
            next
            edit 2
                set name "FTP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,FTP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 10"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "FTP"
                        set oper equal
                    next
                end
            next
            edit 3
                set name "RDP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,RDP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 15"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "RDP"
                        set oper equal
                    next
                end
            next
            edit 4
                set name "HTTPS IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,HTTPS"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 30"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "HTTPS"
                        set oper equal
                    next
                end
            next
            edit 5
                set name "DNS IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,DNS"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 300"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "DNS"
                        set oper equal
                    next
                end
            next
            edit 6
                set name "LDAP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,LDAP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 35"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "LDAP"
                        set oper equal
                    next
                end
            next
            edit 7
                set name "ICMP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip} detected"
                set extrainfo-type custom
                set subject "IP scanning on source endpoint: $groupby1 detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,Risky,Recon,ICMP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 200"
                set thres-duration 1440
                set filter-expr "service~icmp"
            next
            edit 8
                set name "SMB IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,SMB"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 50"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "SMB"
                        set oper equal
                    next
                end
            next
            edit 9
                set name "SNMP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,SNMP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 150"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "SNMP"
                        set oper equal
                    next
                end
            next
            edit 10
                set name "SMTP IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,SMTP"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 21"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "service"
                        set value "SMTP"
                        set oper equal
                    next
                end
            next
            edit 11
                set name "RPC IP scanning detected"
                set devtype FortiGate
                set severity medium
                set logtype "traffic"
                set extrainfo "Recon activity from: ${srcip}:${srcport} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "IP scanning on Port: $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "dstport"
                set eventstatus "open"
                set tags "Default,Risky,Recon,RPC"
                set filter-relation 0
                set aggregate-expr "COUNT_DISTINCT(dstip) >= 10"
                set thres-duration 1440
                set filter-expr "(service~rpc or app~rpc)"
            next
        end
        set enable enable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30016
        set name "Default-Shadow-IT-Events"
        set description "Default event handler to detect unsanctioned user, application and file exfiltration for cloud access. This handler need connect FortiAnalyzer to FortiCasb."
        config rule
            edit 1
                set name "Unsanctioned Applications detected"
                set devtype FortiGate
                set severity high
                set logtype "app-ctrl"
                set extrainfo "Unsanctioned application ${app} with app risk: ${apprisk} detected on: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set subject "Unsanctioned Applications detected"
                set groupby1 "srcip"
                set groupby2 "app"
                set eventstatus "open"
                set tags "Default,Unsanctioned_App"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(siflags & 1) == 0 && siappid >= 0"
            next
            edit 2
                set name "File Exfiltration Attempts detected"
                set devtype FortiGate
                set severity high
                set logtype "app-ctrl"
                set extrainfo "File exfiltration detected on: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set subject "File Exfiltration Attempts detected"
                set groupby1 "srcip"
                set groupby2 "app"
                set eventstatus "open"
                set tags "Default,File_Exfiltration"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(siflags & 4) == 4"
            next
            edit 3
                set name "Unsanctioned Users detected"
                set devtype FortiGate
                set severity high
                set logtype "app-ctrl"
                set extrainfo "Unsanctioned user: ${unauthuser} with app risk: ${apprisk} detected on: ${devname} with message: ${msg}"
                set extrainfo-type custom
                set subject "Unsanctioned Users detected"
                set groupby1 "srcip"
                set groupby2 "app"
                set eventstatus "open"
                set tags "Default,Unsanctioned_User"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "(siflags & 1) == 1 && (siflags & 2) == 0"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
    edit 30017
        set handler-id "30017"
        set name "Default-Traffic-Consuming-High-Network-Brandwidth"
        set uuid ""
        set content-pack-uuid ""
        set content-pack-id ""
        set version 2
        set creation-time 0
        set enable-time 0
        set update-time 0
        set description "This handler is to detect if an endpoint consumed high brandwidth."
        set automation-stitch disable
        set notification ""
        set data-selector ""
        config rule
            edit 1
                set rule-id "1"
                set name "Traffic consuming high brandwidth groupby endpoint"
                set tags "brandwidth"
                set subject "High brandwidth endpoint $groupby1 detected"
                set devtype FortiGate
                set logtype "traffic"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set eventstatus "open"
                set extrainfo-type default
                set severity medium
                set enable enable
                set thres-duration 20
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "SUM(sentbyte) >= 1G"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fgt"
    next
end
config fazcfg-template correlation-handler fgt
    edit aeb_aa9_90e_406
        set handler-id "aeb_aa9_90e_406"
        set name "Default-Suspicious-Traffic-From-Infected-Endpoint"
        set uuid ""
        set content-pack-uuid ""
        set content-pack-id ""
        set version 2
        set creation-time 0
        set enable-time 0
        set update-time 0
        set description "This is to detect if an endpoint is infected and there is a large traffic from the same endpoint."
        set automation-stitch disable
        set thres-duration 30
        set rule-relation "(6f6_eaf_abf_a02 OR 236_c74_808_236 OR 9e7_3dd_724_198 OR c94_9fd_802_c98) FOLLOWED_BY[15m] e9c_3e6_d6f_af6"
        set rule-relation-constraint "6f6_eaf_abf_a02.endpoint=236_c74_808_236.endpoint AND 236_c74_808_236.endpoint=9e7_3dd_724_198.endpoint AND 9e7_3dd_724_198.endpoint=c94_9fd_802_c98.endpoint AND c94_9fd_802_c98.endpoint=e9c_3e6_d6f_af6.endpoint"
        set eventstatus "auto"
        set extrainfo-type default
        set severity medium
        set tags "CnC"
        set notification ""
        set data-selector ""
        config rule
            edit 6f6_eaf_abf_a02
                set rule-id "6f6_eaf_abf_a02"
                set name "Traffic to Botnet CnC detected or blocked in virus log"
                set devtype FortiGate
                set logtype "virus"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*)>=1"
                config filter
                    edit 1
                        set id 1
                        set key "logid"
                        set value "0202009248"
                        set oper equal
                    next
                    edit 2
                        set id 2
                        set key "logid"
                        set value "0202009249"
                        set oper equal
                    next
                end
            next
            edit 236_c74_808_236
                set rule-id "236_c74_808_236"
                set name "Traffic to CnC detected"
                set devtype FortiGate
                set logtype "traffic"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr "tdtype~infected"
                set aggregate-expr "COUNT(*)>=1"
            next
            edit 9e7_3dd_724_198
                set rule-id "9e7_3dd_724_198"
                set name "Web traffic to CnC detected"
                set devtype FortiGate
                set logtype "webfilter"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr "tdtype~infected"
                set aggregate-expr "COUNT(*)>=1"
            next
            edit c94_9fd_802_c98
                set rule-id "c94_9fd_802_c98"
                set name "DNS traffic to CnC detected"
                set devtype FortiGate
                set logtype "dns"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr "tdtype~infected"
                set aggregate-expr "COUNT(*)>=1"
            next
            edit e9c_3e6_d6f_af6
                set rule-id "e9c_3e6_d6f_af6"
                set name "Traffic from endpoint"
                set devtype FortiGate
                set logtype "traffic"
                set utmevent ""
                set groupby1 "endpoint"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "SUM(sentbyte) >= 100M"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/correlation-handler/fgt"
    next
    edit be8_c97_0c7_961
        set handler-id "be8_c97_0c7_961"
        set name "Default-Brute-Force-Account-Login-Attack-FGT"
        set uuid ""
        set content-pack-uuid ""
        set content-pack-id ""
        set version 2
        set creation-time 0
        set enable-time 0
        set update-time 0
        set description "This handler is to detect if an account login failed many times not followed by a login success for FortiGate."
        set automation-stitch disable
        set thres-duration 30
        set rule-relation "d31_1e5_630_2dd NOT_FOLLOWED_BY[5m] a83_c0a_9f1_ab1"
        set rule-relation-constraint "d31_1e5_630_2dd.devid=a83_c0a_9f1_ab1.devid"
        set eventstatus "auto"
        set extrainfo-type default
        set severity medium
        set tags "login,attack"
        set notification ""
        set data-selector ""
        config rule
            edit d31_1e5_630_2dd
                set rule-id "d31_1e5_630_2dd"
                set name "Login Failed 5 times"
                set devtype FortiGate
                set logtype "event"
                set utmevent "system"
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*) >= 5"
                config filter
                    edit 1
                        set id 1
                        set key "logid"
                        set value "0100032002"
                        set oper equal
                    next
                end
            next
            edit a83_c0a_9f1_ab1
                set rule-id "a83_c0a_9f1_ab1"
                set name "Login-Success"
                set devtype FortiGate
                set logtype "event"
                set utmevent "system"
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*)>=1"
                config filter
                    edit 1
                        set id 1
                        set key "logid"
                        set value "0100032001"
                        set oper equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/correlation-handler/fgt"
    next
end
config fazcfg-template basic-handler fml
    edit 40000
        set name "Default-FML-Threat-Detection-By-Email"
        set description "Default FortiMail Handler to detect malicious and suspicious activities grouped by user's Email address"
        config rule
            edit 1
                set name "Malware detected in incoming email"
                set devtype FortiMail
                set severity critical
                set logtype "statistics"
                set extrainfo "Classifier: ${classifier}, From: ${from}, Server: ${client_name}(${client_ip})"
                set extrainfo-type custom
                set subject "Malware detected in incoming email"
                set groupby1 "to"
                set groupby2 "classifier"
                set eventstatus "open"
                set tags "Incoming,Email,Malware,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction==in and disposition!~quarantine and (classifier==\"Virus Signature\" or classifier==\"Fortiguard Outbreak\")"
            next
            edit 2
                set name "Malware detected in email"
                set devtype FortiMail
                set severity high
                set logtype "virus"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Malware detected in email"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Malware,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==infected"
            next
            edit 3
                set name "Spam detected in incoming email"
                set devtype FortiMail
                set severity high
                set logtype "statistics"
                set extrainfo "Classifier: ${classifier}, From: ${from}, Server: ${client_name}(${client_ip})"
                set extrainfo-type custom
                set subject "Spam detected in incoming email"
                set groupby1 "to"
                set eventstatus "open"
                set tags "Incoming,Email,Spam,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction==in and disposition!~quarantine and disposition!~reject and ( classifier==\"Recipient Verification\" or classifier==\"Fortiguard Antispam\" or classifier==\"Fortiguard Antispam-ip\" or classifier==\"Image Spam\" )"
            next
            edit 4
                set name "Matched hash detected in email"
                set devtype FortiMail
                set severity medium
                set logtype "virus"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Matched hash detected in email"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Risky,File,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 30
                set filter-expr "subtype==file-signature"
            next
            edit 5
                set name "Malicious URL detected in incoming email"
                set devtype FortiMail
                set severity high
                set logtype "statistics"
                set extrainfo "Classifier: ${classifier}, From: ${from}, Server: ${client_name}(${client_ip})"
                set extrainfo-type custom
                set subject "Malicious URL detected in incoming email"
                set groupby1 "to"
                set eventstatus "open"
                set tags "Incoming,Email,Risky,URL,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction==in and classifier==\"Fortiguard Webfilter\" and disposition!~quarantine"
            next
            edit 6
                set name "Suspicious URL detected in email"
                set devtype FortiMail
                set severity medium
                set logtype "spam"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Suspicious URL detected in email"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Risky,URL,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"Fortiguard-Webfilter\" and msg!~\"category: malicious website\" and msg!~\"category: spam URLs\" and msg!~\"category: phishing\""
            next
            edit 7
                set name "Malicious URL detected in email"
                set devtype FortiMail
                set severity high
                set logtype "spam"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Malicious URL detected in email"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Risky,URL,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"Fortiguard-Webfilter\" and (msg~\"category: malicious website\" or msg~\"category: spam URLs\" or msg~\"category: phishing\" )"
            next
            edit 8
                set name "Sandbox detected suspicious content in email"
                set devtype FortiMail
                set severity medium
                set logtype "virus"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Sandbox detected suspicious content in email"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Risky,Sandbox,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==fortisandbox and (msg~\"rating=suspicious_medium\" or msg~\"rating=suspicious_high\" or msg~\"suspicious is found\" )"
            next
            edit 9
                set name "Outgoing email blocked by access control"
                set devtype FortiMail
                set severity medium
                set logtype "statistics"
                set extrainfo "Classifier: ${classifier}, From: ${from}, Server: ${client_name}(${client_ip})"
                set extrainfo-type custom
                set subject "Outgoing email blocked by access control"
                set groupby1 "to"
                set eventstatus "mitigated"
                set tags "Outgoing,Email,Access_Control,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "direction==out and classifier~\"Access Control\" and (disposition==discard or disposition==reject)"
            next
            edit 10
                set name "Oversize email detected"
                set devtype FortiMail
                set severity low
                set logtype "spam"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Oversize email detected"
                set groupby1 "to"
                set eventstatus "auto"
                set tags "Email,Risky,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "msg~\"max scan size\""
            next
            edit 11
                set name "Suspicious content detected in email"
                set devtype FortiMail
                set severity medium
                set logtype "virus"
                set extrainfo "From: ${from}, Server: ${client_name}(${client_ip}), ${msg}"
                set extrainfo-type custom
                set subject "Suspicious content detected in email"
                set groupby1 "to"
                set tags "Email,Risky,Malware,By_Endpoint"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype==\"malware-outbreak\" and msg~\"suspicious content\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fml"
    next
    edit 40001
        set name "Default-FML-Compromised Host-Detection-IOC-By-Threat"
        set description "Default event handler to detect compromised hosts by IOC feature grouped by threat"
        config rule
            edit 1
                set name "User clicked the CnC malicious URL"
                set devtype FortiMail
                set severity critical
                set logtype "spam"
                set extrainfo "user:${to} clicked the CnC malicious URL:${tdurl}"
                set extrainfo-type custom
                set subject "Email filter CnC to $groupby1 detected"
                set groupby1 "to"
                set groupby2 "from"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C,Email,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fml"
    next
end
config fazcfg-template basic-handler fwb
    edit 160000
        set name "Default-FWB-Threat-Detection-By-Hostname"
        set description "Default FortiWeb Handler to detect malicious and suspicious activities grouped by web server's host name"
        config rule
            edit 1
                set name "Malicious activity detected"
                set devtype FortiWeb
                set severity high
                set logtype "attack"
                set extrainfo "Malicious activity: ${main_type}, ${subtype}, ${msg}, Traffic path: from ${src} to ${dst} (${policy})"
                set extrainfo-type custom
                set subject "Malicious activity: $groupby2 detected"
                set groupby1 "http_host"
                set groupby2 "signature_subclass"
                set eventstatus "open"
                set tags "By_Endpoint,Intrusion,Signature"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "Alert_Deny"
                        set oper not-equal
                    next
                    edit 2
                        set key "action"
                        set value "Period_Block"
                        set oper not-equal
                    next
                end
            next
            edit 2
                set name "Malicious activity blocked"
                set devtype FortiWeb
                set severity medium
                set logtype "attack"
                set extrainfo "Malicious activity: ${main_type}, ${subtype}, ${msg}, Traffic path: from ${src} to ${dst} (${policy})"
                set extrainfo-type custom
                set subject "Malicious activity: $groupby2 blocked"
                set groupby1 "http_host"
                set groupby2 "signature_subclass"
                set eventstatus "mitigated"
                set tags "By_Endpoint,Intrusion,Signature"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "action"
                        set value "Alert_Deny"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "Period_Block"
                        set oper equal
                    next
                end
            next
            edit 3
                set name "Encrypted traffic bypassed FortiWeb scan"
                set devtype FortiWeb
                set severity low
                set logtype "traffic"
                set extrainfo "Destination: ${dst}, ${msg}"
                set extrainfo-type custom
                set subject "Encrypted traffic bypassed FortiWeb scan"
                set groupby1 "http_host"
                set eventstatus "open"
                set tags "By_Endpoint,Risky,Bypassed"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "msg"
                        set value "No server certificate for SSL connection"
                        set oper contain
                    next
                    edit 2
                        set key "msg"
                        set value "SSL certificate key mismatch"
                        set oper contain
                    next
                    edit 3
                        set key "msg"
                        set value "Ephemeral keys cannot be decrypted"
                        set oper contain
                    next
                    edit 4
                        set key "msg"
                        set value "Unsupported cipher for SSL connection"
                        set oper contain
                    next
                    edit 5
                        set key "msg"
                        set value "Unmonitored SSL connection"
                        set oper contain
                    next
                end
            next
            edit 4
                set name "HTTP response time above threshold"
                set devtype FortiWeb
                set severity low
                set logtype "traffic"
                set extrainfo "Destination: ${dst}, ${msg}"
                set extrainfo-type custom
                set subject "HTTP response time above threshold"
                set groupby1 "http_host"
                set tags "By_Endpoint,Risky,Response_Time"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "http_response_time"
                        set value "10000"
                        set oper great-or-equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fwb"
    next
end
config fazcfg-template basic-handler fct
    edit 60001
        set name "Default-FCT-Threat-Detection-By-Endpoint"
        set description "Default event handler for FortiClient threat detection by endpoint"
        config rule
            edit 1
                set name "Sandbox detected Malware in FCT File submission"
                set devtype FortiClient
                set severity high
                set logtype "fct-event"
                set extrainfo "Malware detected in File: ${file} with Size: ${filesize}"
                set extrainfo-type custom
                set subject "Sandbox detected Malware in FCT File submission"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype=\"sandboxing\" and msg~\"Found virus\" "
            next
            edit 2
                set name "Malware found by FCT AV scan on File System"
                set devtype FortiClient
                set severity high
                set logtype "fct-event"
                set extrainfo "Malware: ${virus} detected in File: ${file} with Size: ${filesize} "
                set extrainfo-type custom
                set subject "Malware found by FCT AV scan on File System"
                set groupby1 "endpoint"
                set groupby2 "virus"
                set eventstatus "contained"
                set tags "Default,By_Endpoint,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype=\"av\" and msg~\"Found virus\""
            next
            edit 3
                set name "Access to Web blocked by FCT Web Filter"
                set devtype FortiClient
                set severity medium
                set logtype "fct-traffic"
                set extrainfo "Process: ${srcname} initiated traffic to domain: ${remotename} with URL: ${url}, FortiGuard Category: ${threat}"
                set extrainfo-type custom
                set subject "Access to Web blocked by FCT Web Filter"
                set groupby1 "endpoint"
                set groupby2 "remotename"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,URL,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "utmevent=\"webfilter\" and utmaction=\"blocked\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fct"
    next
    edit 60002
        set name "Default-FCT-Threat-Detection-By-Threat"
        set description "Default event handler for FortiClient threat detection by threat"
        config rule
            edit 1
                set name "Malware found by FCT AV scan on File System"
                set devtype FortiClient
                set severity high
                set logtype "fct-event"
                set extrainfo "Malware: ${virus} detected in File: ${file} with Size: ${filesize} "
                set extrainfo-type custom
                set subject "Malware found by FCT AV scan on File System"
                set groupby1 "virus"
                set groupby2 "endpoint"
                set eventstatus "contained"
                set tags "Default,By_Threat,Malware"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype=\"av\" and msg~\"Found virus\""
            next
            edit 2
                set name "Access to Web blocked by FCT Web Filter"
                set devtype FortiClient
                set severity medium
                set logtype "fct-traffic"
                set extrainfo "Process: ${srcname} initiated traffic to domain: ${remotename} with URL: ${url}, FortiGuard Category: ${threat}"
                set extrainfo-type custom
                set subject "Access to Web blocked by FCT Web Filter"
                set groupby1 "remotename"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,URL,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "utmevent=\"webfilter\" and utmaction=\"blocked\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fct"
    next
end
config fazcfg-template correlation-handler faz
    edit ab3_4d1_75a_b78
        set handler-id "ab3_4d1_75a_b78"
        set name "Default-Brute-Force-Account-Login-Attack-FAZ"
        set uuid ""
        set content-pack-uuid ""
        set content-pack-id ""
        set version 2
        set creation-time 0
        set enable-time 0
        set update-time 0
        set description "This handler is to detect if an account login failed many times not followed by a login success for FortiAnalyzer."
        set automation-stitch disable
        set thres-duration 30
        set rule-relation "c3a_f11_453_7cd NOT_FOLLOWED_BY[5m] 5b7_902_4ce_c21"
        set rule-relation-constraint "c3a_f11_453_7cd.devid=5b7_902_4ce_c21.devid"
        set eventstatus "auto"
        set extrainfo-type default
        set severity medium
        set tags "login,attack"
        set notification ""
        set data-selector ""
        config rule
            edit c3a_f11_453_7cd
                set rule-id "c3a_f11_453_7cd"
                set name "Login Failed 5 Times"
                set devtype FortiAnalyzer
                set logtype "event"
                set utmevent ""
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*) >= 5"
                config filter
                    edit 1
                        set id 1
                        set key "operation"
                        set value "login failed"
                        set oper equal
                    next
                end
            next
            edit 5b7_902_4ce_c21
                set rule-id "5b7_902_4ce_c21"
                set name "Login Success"
                set devtype FortiAnalyzer
                set logtype "event"
                set utmevent ""
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*)>=1"
                config filter
                    edit 1
                        set id 1
                        set key "operation"
                        set value "login"
                        set oper equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/correlation-handler/faz"
    next
end
config fazcfg-template basic-handler fsa
    edit 50003
        set name "Default-FSA-System-Handler"
        set description "Default handler to track critical system event of Sandbox"
        config rule
            edit 1
                set name "Critical events"
                set devtype FortiSandbox
                set severity critical
                set logtype "event"
                set extrainfo "Action: ${action}, Status: ${status}"
                set extrainfo-type custom
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,FortiSandbox,System"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "2"
                        set oper great-or-equal
                    next
                end
            next
            edit 2
                set name "Malicious file detected"
                set devtype FortiSandbox
                set severity high
                set logtype "event"
                set extrainfo "File Name: ${fname}.${ftype}, Level: ${level}, Action: ${action}, Status: ${status}"
                set extrainfo-type custom
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,FortiSandbox,System,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "malicious"
                        set oper equal
                    next
                end
            next
            edit 3
                set name "Error event detected"
                set devtype FortiSandbox
                set severity high
                set logtype "event"
                set extrainfo "Action: ${action}, Status: ${status}"
                set extrainfo-type custom
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,FortiSandbox,System"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "3"
                        set oper equal
                    next
                    edit 2
                        set key "msg"
                        set value "malware package"
                        set oper not-contain
                    next
                    edit 3
                        set key "msg"
                        set value "file upload error"
                        set oper not-contain
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fsa"
    next
    edit 50004
        set name "Default-FSA-Malware-Handler-By-Endpoint"
        set description "Default handler to track the malware detection by Sandbox per endpoint"
        config rule
            edit 1
                set name "FortiSandbox Malware Detected group by endpoint"
                set devtype FortiSandbox
                set severity high
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from ${srcip}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Malware $groupby2 from $groupby1"
                set groupby1 "endpoint"
                set groupby2 "mname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "Malicious"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 2
                set name "FortiSandbox Malware Detected group by dstendpoint"
                set devtype FortiSandbox
                set severity high
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} to ${dstip}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Malware $groupby2 to $groupby1"
                set groupby1 "dstendpoint"
                set groupby2 "mname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "Malicious"
                        set oper equal
                    next
                    edit 2
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 3
                set name "FortiSandbox Detected Risky File group by endpoint"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from ${srcip}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Risky File $groupby2 from $groupby1"
                set groupby1 "endpoint"
                set groupby2 "fname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "high risk"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 4
                set name "FortiSandbox Detected Risky File group by dstendpoint"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} to ${dstip}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Risky File $groupby2 to $groupby1"
                set groupby1 "dstendpoint"
                set groupby2 "fname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "high risk"
                        set oper equal
                    next
                    edit 2
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fsa"
    next
    edit 50005
        set name "Default-FSA-Malware-Handler-By-Threat"
        set description "Default handler to track the malware detection by Sandbox per threat"
        config rule
            edit 1
                set name "FortiSandbox Malware Detected group by endpoint"
                set devtype FortiSandbox
                set severity high
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from ${groupby2}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Malware from $groupby2"
                set groupby1 "mname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "Malicious"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 2
                set name "FortiSandbox Malware Detected group by dstendpoint"
                set devtype FortiSandbox
                set severity high
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} to ${groupby2}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Malware to $groupby2"
                set groupby1 "mname"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "Malicious"
                        set oper equal
                    next
                    edit 2
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 3
                set name "FortiSandbox Detected Malware from JSON API request"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from JSON API request"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Malware from JSON API request"
                set groupby1 "mname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "Malicious"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper equal
                    next
                    edit 3
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper equal
                    next
                end
            next
            edit 4
                set name "FortiSandbox Detected Risky File group by endpoint"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from ${groupby2}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Risky File from $groupby2"
                set groupby1 "fname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "high risk"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 5
                set name "FortiSandbox Detected Risky File group by dstendpoint"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} to ${groupby2}"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Risky File to $groupby2"
                set groupby1 "fname"
                set groupby2 "dstendpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "high risk"
                        set oper equal
                    next
                    edit 2
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper not-equal
                    next
                end
            next
            edit 6
                set name "FortiSandbox Detected Risky File from JSON API request"
                set devtype FortiSandbox
                set severity medium
                set logtype "malware"
                set extrainfo "Malware: ${mname} with severity: ${risk} found in file: ${fname}, Checksum: ${md5} from JSON API request"
                set extrainfo-type custom
                set subject "FortiSandbox Detected Risky File from JSON API request"
                set groupby1 "fname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Sandbox,Malware,Risky"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "risk"
                        set value "high risk"
                        set oper equal
                    next
                    edit 2
                        set key "srcip"
                        set value "0.0.0.0"
                        set oper equal
                    next
                    edit 3
                        set key "dstip"
                        set value "0.0.0.0"
                        set oper equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fsa"
    next
end
config fazcfg-template basic-handler fmg
    edit 28000
        set name "Default-NOC-Docker-Events"
        set description "Default handler for NoC docker events"
        config rule
            edit 1
                set name "Memory report detected"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with message ${msg}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=='0042010266' and msg~\"MEM\""
            next
            edit 2
                set name "CPU report detected"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with message ${msg}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=='0042010266' and msg~\"CPU\""
            next
            edit 3
                set name "Status changed to disable 1"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with changes ${changes}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0001010026 and changes~\"status=disable\" "
            next
            edit 4
                set name "Status changed to disable 2"
                set devtype FortiManager
                set severity medium
                set logtype "event"
                set extrainfo "Device ${devname} with changes ${changes}."
                set extrainfo-type custom
                set subject "$groupby1 $groupby2"
                set groupby1 "type"
                set groupby2 "subtype"
                set eventstatus "auto"
                set tags "Default,NOC,Docker"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "log_id=0001010026 and changes~\"status=disable\" "
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fmg"
    next
end
config fazcfg-template basic-handler ffw
    edit 327680001
        set name "Default-FFW-Botnet-Communication-Detection-By-Endpoint"
        set description "Default FortiFirewall event handler to detect botnet communication in network grouped by endpoint"
        config rule
            edit 1
                set name "DNS traffic to Botnet CnC blocked"
                set devtype FortiFirewall
                set severity high
                set logtype "dns"
                set extrainfo "Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "qname"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Botnet,Domain,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054601 OR logid==1501054600"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680002
        set name "Default-FFW-Compromised Host-Detection-IOC-By-Endpoint"
        set description "Default FortiFirewall event handler to detect compromised hosts by FortiAnalyzer IOC feature grouped by endpoint"
        config rule
            edit 1
                set name "Traffic to CnC detected"
                set devtype FortiFirewall
                set severity critical
                set logtype "traffic"
                set extrainfo "${tdtype}: ${dstip} :${dstport}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "Compromised host detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,C&C,IP,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 2
                set name "DNS traffic to CnC detected"
                set devtype FortiFirewall
                set severity critical
                set logtype "dns"
                set extrainfo "${tdtype}: ${qname}, Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "Compromised host detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,C&C,Domain,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680003
        set name "Default-FFW-Risky-Destination-Detection-By-Endpoint"
        set description "Default FortiFirewall event handler to detect network traffic to malicious or suspicious destinations grouped by endpoint"
        config rule
            edit 1
                set name "DNS request to malicious destination detected"
                set devtype FortiFirewall
                set severity high
                set logtype "dns"
                set extrainfo "Domain:${hostname}, Referrer:${referralurl}, ${devname} (Policy ID:${policyid})\\${dstintf}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 2
                set name "DNS request to suspicious destination detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname}, Resolved IP: ${ipaddr}, ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 detected"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 3
                set name "DNS request to malicious or suspicious destination detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname}, Resolved IP: ${ipaddr}, ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS request to $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "catdesc"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs' or catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 4
                set name "Insecure SSL connection detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL connection detected"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomalies"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 5
                set name "Insecure SSL connection blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL connection blocked"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomalies"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 6
                set name "SSL connection exempted"
                set devtype FortiFirewall
                set severity low
                set logtype "ssl"
                set extrainfo "SSL connection from ${srcip} to ${dstip}:${dstport} exempt with reason: ${reason}"
                set extrainfo-type custom
                set subject "$groupby2"
                set groupby1 "endpoint"
                set groupby2 "msg"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-exempt"
                        set oper equal
                    next
                end
            next
            edit 7
                set name "SSH channel detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel detected"
                set groupby1 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 8
                set name "SSH channel blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 9
                set name "SSH command detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH Command: ${command} by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command detected"
                set groupby1 "endpoint"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 10
                set name "SSH command blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssh"
                set extrainfo "SSH Command: ${command} by user: ${login} from ${srcip} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command blocked"
                set groupby1 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Endpoint,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680004
        set name "Default-FFW-Risky-Destination-Detection-By-Threat"
        set description "Default FortiFirewall event handler to detect network traffic to malicious or suspicious destinations grouped by threat"
        config rule
            edit 1
                set name "DNS request to malicious destination detected"
                set devtype FortiFirewall
                set severity high
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to malicious destination from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 2
                set name "DNS request to malicious destination blocked"
                set devtype FortiFirewall
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to malicious destination from $groupby2 blocked"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Malicious Websites' or catdesc=='Phishing' or catdesc=='Spam URLs')"
            next
            edit 3
                set name "DNS request to suspicious destination detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to suspicious destination from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054802 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 4
                set name "DNS request to suspicious destination from blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "dns"
                set extrainfo "Domain:${qname} from category: ${catdesc}, Traffic path: PolicyID ${policyid}(Profile ${profile})\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS request to suspicious destination from $groupby2 blocked"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,Domain"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054803 and (catdesc=='Newly Observed Domain' or catdesc=='Newly Registered Domain' or catdesc~'Dynamic DNS' or catdesc=='Proxy Avoidance' or catdesc=='Unrated')"
            next
            edit 5
                set name "Insecure SSL Connection detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL Connection detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomalies"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 6
                set name "Insecure SSL Connection blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssl"
                set extrainfo "${msg} with reason: ${reason} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Insecure SSL Connection blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSL"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssl-anomalies"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 7
                set name "SSH channel detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 8
                set name "SSH channel blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssh"
                set extrainfo "SSH channel by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH channel blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-channel"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
            edit 9
                set name "SSH command detected"
                set devtype FortiFirewall
                set severity medium
                set logtype "ssh"
                set extrainfo "SSH command: ${command} by user: ${login}  to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command detected from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper equal
                    next
                end
            next
            edit 10
                set name "SSH command blocked"
                set devtype FortiFirewall
                set severity low
                set logtype "ssh"
                set extrainfo "SSH command: ${command} by user: ${login} to ${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "SSH command blocked from $groupby2"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "mitigated"
                set tags "Default,By_Threat,Risky,SSH"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "eventtype"
                        set value "ssh-command"
                        set oper equal
                    next
                    edit 2
                        set key "action"
                        set value "passthrough"
                        set oper not-equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680005
        set name "Default-FFW-Compromised Host-Detection-IOC-By-Threat"
        set description "Default FortiFirewall event handler to detect compromised hosts by FortiAnalyzer IOC feature grouped by threat"
        config rule
            edit 1
                set name "Traffic to CnC detected"
                set devtype FortiFirewall
                set severity critical
                set logtype "traffic"
                set extrainfo "Traffic to C&C:${dstip}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Traffic to C&C from $groupby2 detected"
                set groupby1 "dstip"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,IP,C&C,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 2
                set name "Web traffic to CnC detected"
                set devtype FortiFirewall
                set severity critical
                set logtype "webfilter"
                set extrainfo "Traffic to C&C:${hostname}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "Web traffic to C&C from $groupby2 detected"
                set groupby1 "hostname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C,URL,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
            edit 3
                set name "DNS traffic to CnC detected"
                set devtype FortiFirewall
                set severity critical
                set logtype "dns"
                set extrainfo "Traffic to C&C:${qname}, Traffic path: PolicyID ${policyid}\\${dstintf}\\${dstip}:${dstport}"
                set extrainfo-type custom
                set subject "DNS traffic to C&C from $groupby2 detected"
                set groupby1 "qname"
                set groupby2 "endpoint"
                set eventstatus "open"
                set tags "Default,By_Threat,C&C,Domain,Ioc_Rescan"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "tdtype~infected"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680006
        set name "Default FFW System Events"
        set description "Default FortiFirewall event handler for selected FortiOS system event logs grouped by device"
        config rule
            edit 1
                set name "Important events"
                set devtype FortiFirewall
                set severity high
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "4"
                        set oper equal
                    next
                    edit 2
                        set key "pri"
                        set value "3"
                        set oper equal
                    next
                end
            next
            edit 2
                set name "Critical events"
                set devtype FortiFirewall
                set severity critical
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                config filter
                    edit 1
                        set key "pri"
                        set value "2"
                        set oper great-or-equal
                    next
                end
            next
            edit 3
                set name "Wireless event log id matched"
                set devtype FortiFirewall
                set severity low
                set logtype "event"
                set utmevent "wireless"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0104043521 or logid==0104043530 or logid==0104043531 or logid==0104043532 or logid==0104043533 or logid==0104043534 or logid==0104043535 or logid==0104043542 or logid==0104043544 or logid==0104043546 or logid==0104043548 or logid==0104043552 or logid==0104043553 or logid==0104043555 or logid==0104043557 or logid==0104043558 or logid==0104043560 or logid==0104043563 or logid==0104043564 or logid==0104043565 or logid==0104043566 or logid==0104043571 or logid==0104043573 or logid==0104043575 or logid==0104043577 or logid==0104043613 or logid==0104043614 or logid==0104043615"
            next
            edit 4
                set name "Event log id matched 1"
                set devtype FortiFirewall
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0109045152 or logid==0107045082 or logid==0107045110 or logid==0110052000 or logid==0100032044"
            next
            edit 5
                set name "Event log id matched 2"
                set devtype FortiFirewall
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0108037892 or logid==0100020117 or logid==0100020220 or logid==0100020221 or logid==0100022017 or logid==0100022018 or logid==0100022917 or logid==0100032023 or logid==0100032103 or logid==0100032140 or logid==0100032141 or logid==0100032142 or logid==0100032146 or logid==0100032149 or logid==0100032158 or logid==0100032159 or logid==0100032231 or logid==0100032232 or logid==0100032233 or logid==0100032238 or logid==0100032241 or logid==0100032564 or logid==0100032602 or logid==0100032603 or logid==0100032605 or logid==0101041989 or logid==0101041990 or logid==0105040960"
            next
            edit 6
                set name "Event log id matched 3"
                set devtype FortiFirewall
                set severity medium
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0100020005 or logid==0100020006 or logid==0100020090 or logid==0100022901 or logid==0100022902 or logid==0100022912 or logid==0100022913 or logid==0100022915 or logid==0101023101 or logid==0101023102 or logid==0101039424 or logid==0101039425 or logid==0101039940 or logid==0101039943 or logid==0101039947 or logid==0101039948 or logid==0101039952 or logid==0101039953 or logid==0101040001 or logid==0101040002 or logid==0101040019 or logid==0101040038 or logid==0101040039 or logid==0101040101 or logid==0101040102 or logid==0101040118 or logid==0101037139"
            next
            edit 7
                set name "Event log id matched 4"
                set devtype FortiFirewall
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0100022950 or logid==0100022951 or logid==0100029002 or logid==0100029003 or logid==0100032001 or logid==0100032003 or logid==0102038031 or logid==0102038032 or logid==0102043008 or logid==0102043009 or logid==0102043014 or logid==0102043015 or logid==0102043016 or logid==0102043017 or logid==0102043025 or logid==0102043026 or logid==0102043039 or logid==0102043040 or logid==0102043045 or logid==0102043046"
            next
            edit 8
                set name "Event log id matched 5"
                set devtype FortiFirewall
                set severity low
                set logtype "event"
                set utmevent "_any_"
                set subject "$groupby2"
                set groupby1 "devname"
                set groupby2 "logdesc"
                set eventstatus "auto"
                set tags "Default,System"
                set filter-relation 1
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==0107045114 or logid==0107045115 or logid==0107045116 or logid==0100022850 or logid==0100022851 or logid==0100043776 or logid==0100043777 or logid==0100046600"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
    edit 327680007
        set name "Default-FFW-Botnet-Communication-Detection"
        set description "Default FortiFirewall event handler to detect botnet communication and report to FortiFirewall"
        set automation-stitch enable
        config rule
            edit 1
                set name "DNS traffic to Botnet CnC blocked"
                set devtype FortiFirewall
                set severity high
                set logtype "dns"
                set extrainfo "Traffic path: ${devname} (Policy ID:${policyid})\\${dstintf}\\${dstip}"
                set extrainfo-type custom
                set subject "DNS traffic to Botnet C&C $groupby2 blocked"
                set groupby1 "endpoint"
                set groupby2 "qname"
                set eventstatus "open"
                set tags "Default,Botnet,Domain,C&C"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "logid==1501054601 OR logid==1501054600"
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/ffw"
    next
end
config fazcfg-template basic-handler fdc
    edit 70000
        set name "Default-FDC-Honey-Pot-Detection"
        set description "Default event handler for FortiDeceptor Honey Pot event detection"
        config rule
            edit 1
                set name "Attack detected by FDC"
                set devtype FortiDeceptor
                set severity medium
                set logtype "event"
                set extrainfo "IP ${attackerip} connected to deceptive IP ${victimip}, Service: ${service}, Message: ${msg}"
                set extrainfo-type custom
                set subject "Attack: $groupby1 detected by FDC"
                set groupby1 "attackerip"
                set groupby2 "operation"
                set eventstatus "open"
                set tags "Default,FortiDeceptor"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr "subtype=\"attack\""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fdc"
    next
end
config fazcfg-template basic-handler fai
    edit 90001
        set name "Default-FAI-Malware-Detection-By-FAI"
        set description "Default FortiNDR event handler to detect malware"
        config rule
            edit 1
                set name "Malware deteted"
                set devtype FortiAI
                set severity high
                set logtype "attack"
                set utmevent "Malware"
                set extrainfo ""
                set extrainfo-type default
                set subject "Malware: $groupby2 detected"
                set groupby1 "victimip"
                set groupby2 "detype"
                set eventstatus "open"
                set tags "Default,Malware,Detection"
                set filter-relation 0
                set aggregate-expr "COUNT(*) >= 1"
                set thres-duration 1440
                set filter-expr ""
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/basic-handler/fai"
    next
end
config fazcfg-template fortiview-chart fgt
    edit "app_view"
        set disp-name "Fortiview Export Application View"
        set category "Traffic"
        set description "Fortiview Export Application View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set column-attr app-id
                set column-span 2
                set data-top 25
            next
            edit 2
                set data-binding "app_group"
            next
            edit 3
                set header "Application Category"
                set data-binding "appcat"
                set column-attr appcat
            next
            edit 4
                set header "Risk"
                set data-binding "risk"
            next
            edit 5
                set header "# of Clients"
                set data-binding "num_users"
                set column-attr count
            next
            edit 6
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 9
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 11
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "app_drilldown_view"
        set disp-name "Fortiview Export Application Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Application Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set data-top 25
            next
            edit 2
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 3
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 4
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 5
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "source_view"
        set disp-name "Fortiview Export Source View"
        set category "Traffic"
        set description "Fortiview Export Source View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 25
            next
            edit 2
                set header "Source Interface"
                set data-binding "srcintf"
            next
            edit 3
                set header "Device"
                set data-binding "dev_src_agg"
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-span 3
                set column-attr count
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 10
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 11
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 12
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "source_uuid_view"
        set disp-name "Fortiview Export Source uuid View"
        set category "Traffic"
        set description "Fortiview Export Source uuid View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source Object"
                set data-binding "srcuuid_name"
                set data-top 25
            next
            edit 2
                set header "Source Interface"
                set data-binding "srcintf"
            next
            edit 3
                set header "Device"
                set data-binding "dev_src_agg"
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-span 3
                set column-attr count
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 10
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 11
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 12
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "source_threat_view"
        set disp-name "Fortiview Export Source Threat View"
        set category "Traffic"
        set description "Fortiview Export Source Threat View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 25
            next
            edit 2
                set header "Source Interface"
                set data-binding "srcintf"
            next
            edit 3
                set header "Device"
                set data-binding "dev_src"
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 10
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 11
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 12
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "source_website_view"
        set disp-name "Fortiview Export Source Website View"
        set category "Traffic"
        set description "Fortiview Export Source Website View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 25
            next
            edit 2
                set header "Source Interface"
                set data-binding "srcintf"
            next
            edit 3
                set header "Device"
                set data-binding "dev_src_agg"
            next
            edit 4
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 5
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 6
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 9
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 10
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 11
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 12
                set header "Sessoins"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 13
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 14
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "destination_view"
        set disp-name "Fortiview Export Destination View"
        set category "Traffic"
        set description "Fortiview Export Destination View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Applications"
                set data-binding "agg_app"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "destination_uuid_view"
        set disp-name "Fortiview Export Destination uuid View"
        set category "Traffic"
        set description "Fortiview Export Destination uuid View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination Object"
                set data-binding "dstuuid_name"
                set data-top 25
            next
            edit 2
                set header "Applications"
                set data-binding "agg_app"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "country_drilldown_view"
        set disp-name "Fortiview Export Country Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Country Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination Country"
                set data-binding "dstcountry"
                set column-attr dst-country
                set data-top 25
            next
            edit 2
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 8
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 10
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "threat_country_drilldown_view"
        set disp-name "Fortiview Export Threat Country Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Threat Country Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination Country"
                set data-binding "dstcountry"
                set column-attr dst-country
                set data-top 25
            next
            edit 2
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 3
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 4
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 5
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "destination_drilldown_view"
        set disp-name "Fortiview Export Destination Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Destination Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 8
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 10
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "destination_threat_view"
        set disp-name "Fortiview Export Destination Threat View"
        set category "Traffic"
        set description "Fortiview Export Destination Threat View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 8
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 10
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "threat_src_dst_view"
        set disp-name "Fortiview Export Source Destination Threat View"
        set category "Traffic"
        set description "Fortiview Export Source Destination Threat View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "destination_website_view"
        set disp-name "Fortiview Export Destination Website View"
        set category "Traffic"
        set description "Fortiview Export Destination Website View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
            next
            edit 3
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 9
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 11
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "website_view.domain"
        set disp-name "Fortiview Export Website View(Domain)"
        set category "Traffic"
        set description "Fortiview Export Website View(Domain)"
        set chart-type table
        config table-columns
            edit 1
                set header "Domain"
                set data-binding "domain"
                set data-top 25
            next
            edit 2
                set header "Web Category"
                set data-binding "agg_webcat"
            next
            edit 3
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 4
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 5
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 8
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 9
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 10
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 11
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 12
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 13
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "website_view.category"
        set disp-name "Fortiview Export Website View(Category)"
        set category "Traffic"
        set description "Fortiview Export Website View(Category)"
        set chart-type table
        config table-columns
            edit 1
                set header "Web Category"
                set data-binding "catdesc"
                set column-attr web-cat
            next
            edit 2
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 3
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 10
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 11
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 12
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "threat_view"
        set disp-name "Fortiview Export Threat View"
        set category "Traffic"
        set description "Fortiview Export Threat View"
        set chart-type table
        config table-columns
            edit 1
                set header "Threat"
                set data-binding "threat"
                set data-top 25
                set column-attr obf-url
            next
            edit 2
                set header "Category"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Level"
                set data-binding "level_s"
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 9
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "threat_website_view"
        set disp-name "Fortiview Export Threat Website View"
        set category "Traffic"
        set description "Fortiview Export Threat Website View"
        set chart-type table
        config table-columns
            edit 1
                set header "Threat"
                set data-binding "threat"
                set data-top 25
            next
            edit 2
                set header "Category"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Level"
                set data-binding "level_s"
            next
            edit 4
                set header "Threat Score"
                set data-binding "threatweight"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 9
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "cloud_app_view.app"
        set disp-name "Fortiview Export Cloud Applications View(App)"
        set category "Traffic"
        set description "Fortiview Export Cloud Applications View(App)"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set column-width 25
                set data-top 25
                set column-attr app-id
                set column-span 2
            next
            edit 2
                set data-binding "app_group"
            next
            edit 3
                set header "Category"
                set data-binding "appcat"
                set column-attr appcat
                set column-width 15
            next
            edit 4
                set header "Risk"
                set data-binding "risk"
                set column-width 7
            next
            edit 5
                set header "LoginIDs"
                set data-binding "num_loginids"
                set column-attr count
            next
            edit 6
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 9
                set header "File (Up/Down)"
                set data-binding "num_files"
                set column-attr count
                set column-span 2
                set column-width 8
            next
            edit 10
                set data-binding "num_files"
                set column-graph-type bar
            next
            edit 11
                set header "Videos Played"
                set data-binding "num_videos"
                set column-attr count
                set column-span 2
                set column-width 8
            next
            edit 12
                set data-binding "num_videos"
                set column-graph-type bar
            next
            edit 13
                set header "Bytes"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 14
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 15
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "cloud_app_view.user"
        set disp-name "Fortiview Export Cloud Applications View(User)"
        set category "Traffic"
        set description "Fortiview Export Cloud Applications View(user)"
        set chart-type table
        config table-columns
            edit 1
                set header "Cloud User"
                set data-binding "clouduser"
                set data-top 25
            next
            edit 2
                set header "Application"
                set data-binding "app_group"
                set column-attr app-id
                set column-span 2
            next
            edit 3
                set data-binding "app_group"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "File Size"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 9
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "cloud_app_application_view"
        set disp-name "Fortiview Export Cloud Applications View"
        set category "Traffic"
        set description "Fortiview Export Cloud Applications View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set data-top 25
            next
            edit 2
                set header "Category"
                set data-binding "appcat"
                set column-attr appcat
            next
            edit 3
                set header "Risk"
                set data-binding "risk"
            next
            edit 4
                set header "LoginIDs"
                set data-binding "num_loginids"
                set column-attr count
            next
            edit 5
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 8
                set header "File Size"
                set data-binding "total_size"
                set column-span 3
                set column-attr bandwidth
            next
            edit 9
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 10
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "cloud_app_user_view"
        set disp-name "Fortiview Export Cloud User View"
        set category "Traffic"
        set description "Fortiview Export Cloud User View"
        set chart-type table
        config table-columns
            edit 1
                set header "Cloud User"
                set data-binding "clouduser"
                set data-top 25
            next
            edit 2
                set header "Source"
                set data-binding "srcip"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "File Size"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 8
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "sidb_cloud_app_view.app"
        set disp-name "Fortiview Export ShadowIT Cloud Applications View(App)"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Cloud Applications View(App)"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set column-width 25
                set data-top 25
                set column-attr app-id
                set column-span 2
            next
            edit 2
                set data-binding "app_group"
            next
            edit 3
                set header "Category"
                set data-binding "appcat"
                set column-attr appcat
                set column-width 15
            next
            edit 4
                set header "Risk"
                set data-binding "d_risk"
                set column-width 7
            next
            edit 5
                set header "LoginIDs"
                set data-binding "num_loginids"
                set column-attr count
            next
            edit 6
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 9
                set header "File (Up/Down)"
                set data-binding "num_files"
                set column-attr count
                set column-span 2
                set column-width 8
            next
            edit 10
                set data-binding "num_files"
                set column-graph-type bar
            next
            edit 11
                set header "Videos Played"
                set data-binding "num_videos"
                set column-attr count
                set column-span 2
                set column-width 8
            next
            edit 12
                set data-binding "num_videos"
                set column-graph-type bar
            next
            edit 13
                set header "Bytes"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 14
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 15
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "sidb_cloud_app_view.user"
        set disp-name "Fortiview Export ShadowIT Cloud Applications View(User)"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Cloud Applications View(user)"
        set chart-type table
        config table-columns
            edit 1
                set header "Cloud User"
                set data-binding "clouduser"
                set data-top 25
            next
            edit 2
                set header "Application"
                set data-binding "agg_app"
                set column-attr app-id
                set column-span 2
            next
            edit 3
                set data-binding "agg_app"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "File Size"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 9
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "sidb_cloud_app_application_view"
        set disp-name "Fortiview Export ShadowIT Cloud Applications View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Cloud Applications View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set data-top 25
            next
            edit 2
                set header "Category"
                set data-binding "appcat"
                set column-attr appcat
            next
            edit 3
                set header "Risk"
                set data-binding "d_risk"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "File Size"
                set data-binding "total_size"
                set column-span 3
                set column-attr bandwidth
            next
            edit 8
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 9
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "sidb_cloud_app_user_view"
        set disp-name "Fortiview Export ShadowIT Cloud User View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Cloud User View"
        set chart-type table
        config table-columns
            edit 1
                set header "Cloud User"
                set data-binding "clouduser"
                set data-top 25
            next
            edit 2
                set header "Source"
                set data-binding "srcip"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "File Size"
                set data-binding "total_size"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "upload_size"
                set column-graph-type bar
                set legend "Up"
            next
            edit 8
                set data-binding "download_size"
                set column-graph-type bar
                set legend "Down"
            next
        end
        set protected enable
    next
    edit "cloud_app_file_view"
        set disp-name "Fortiview Export Cloud Application File View"
        set category "Traffic"
        set description "Fortiview Export Cloud Application File View"
        set chart-type table
        config table-columns
            edit 1
                set header "Time"
                set data-binding "timestamp"
                set data-top 25
            next
            edit 2
                set header "Cloud User"
                set data-binding "clouduser"
            next
            edit 3
                set header "Source"
                set data-binding "srcip"
            next
            edit 4
                set header "File Name"
                set data-binding "filename"
            next
            edit 5
                set header "File Size"
                set data-binding "filesize"
                set column-attr bandwidth
            next
        end
        set protected enable
    next
    edit "cloud_app_video_view"
        set disp-name "Fortiview Export Cloud Application Video View"
        set category "Traffic"
        set description "Fortiview Export Cloud Application Video View"
        set chart-type table
        config table-columns
            edit 1
                set header "Time"
                set data-binding "timestamp"
                set data-top 25
            next
            edit 2
                set header "Cloud User"
                set data-binding "clouduser"
            next
            edit 3
                set header "Source"
                set data-binding "srcip"
            next
            edit 4
                set header "File Name"
                set data-binding "filename"
            next
            edit 5
                set header "File Size"
                set data-binding "filesize"
                set column-attr bandwidth
            next
        end
        set protected enable
    next
    edit "system_and_event"
        set disp-name "Fortiview Export System and Event View"
        set category "Traffic"
        set description "Fortiview Export System and Event View"
        set chart-type table
        config table-columns
            edit 1
                set header "Event Name(Description)"
                set data-binding "event_name"
                set data-top 25
            next
            edit 2
                set header "Severity"
                set data-binding "severity_s"
            next
            edit 3
                set header "Counts"
                set data-binding "counts"
                set column-attr count
                set column-span 2
            next
            edit 4
                set data-binding "counts"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "admin_logins"
        set disp-name "Fortiview Export Admin Login View"
        set category "Traffic"
        set description "Fortiview Export Admin Login View"
        set chart-type table
        config table-columns
            edit 1
                set header "User"
                set data-binding "f_user"
                set data-top 25
            next
            edit 2
                set header "Duration(seconds)"
                set data-binding "duration"
                set column-span 2
            next
            edit 3
                set data-binding "duration"
                set column-graph-type bar
            next
            edit 4
                set header "Logins"
                set data-binding "login_num"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "login_num"
                set column-graph-type bar
            next
            edit 6
                set header "Failed Logins"
                set data-binding "login_fail_num"
                set column-attr count
                set column-span 2
            next
            edit 7
                set data-binding "login_fail_num"
                set column-graph-type bar
            next
            edit 8
                set header "Configuration Changes"
                set data-binding "total_change"
                set column-attr count
                set column-span 2
            next
            edit 9
                set data-binding "total_change"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "unauthorized_connections"
        set disp-name "Fortiview Export Unauthorized Connection View"
        set category "Traffic"
        set description "Fortiview Export Unauthorized Connection View"
        set chart-type table
        config table-columns
            edit 1
                set header "User(Source IP)"
                set data-binding "user_src"
                set data-top 25
            next
            edit 2
                set header "Login Type"
                set data-binding "login_type"
            next
            edit 3
                set header "Interface/Tunnel Name"
                set data-binding "int_tunnelname"
            next
            edit 4
                set header "# of Failed Attempts"
                set data-binding "total_num"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "total_num"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "ssl_dialup_ipsec"
        set disp-name "Fortiview Export SSL and Dialup IPsec View"
        set category "Traffic"
        set description "Fortiview Export SSL and Dialup IPsec View"
        set chart-type table
        config table-columns
            edit 1
                set header "User"
                set data-binding "f_user"
                set data-top 25
            next
            edit 2
                set header "VPN Type"
                set data-binding "vpn_type_group"
            next
            edit 3
                set header "Devices"
                set data-binding "devname"
            next
            edit 4
                set header "Last Connected"
                set data-binding "end_time"
            next
            edit 5
                set header "Connected From"
                set data-binding "remip"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 9
                set header "# of Connections"
                set data-binding "connections"
                set column-attr count
            next
            edit 10
                set header "Duration"
                set data-binding "duration"
                set column-attr timespan
                set column-span 2
            next
            edit 11
                set data-binding "duration"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "ssl_dialup_ipsec_session_view"
        set disp-name "Fortiview Export SSL and Dialup IPsec Session View"
        set category "Traffic"
        set description "Fortiview Export SSL and Dialup IPsec Session View"
        set chart-type table
        config table-columns
            edit 1
                set header "Connection Time"
                set data-binding "start_time"
                set column-span 2
                set data-top 30
            next
            edit 2
                set data-binding "end_time"
            next
            edit 3
                set header "Group"
                set data-binding "vpnusergroup"
            next
            edit 4
                set header "VPN Type"
                set data-binding "tunneltype"
            next
            edit 5
                set header "Tunnel ID"
                set data-binding "tunnelid"
            next
            edit 6
                set header "Destination"
                set data-binding "remip"
            next
            edit 7
                set header "Device"
                set data-binding "devid"
            next
            edit 8
                set header "Duration"
                set data-binding "duration"
                set column-attr timespan
                set column-span 2
            next
            edit 9
                set data-binding "duration"
                set column-graph-type bar
            next
            edit 10
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 11
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 12
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "site_to_site_ipsec"
        set disp-name "Fortiview Export Site to Site View"
        set category "Traffic"
        set description "Fortiview Export Site to Site View"
        set chart-type table
        config table-columns
            edit 1
                set header "Site-to-Site IPsec Tunnel"
                set data-binding "vpnname"
                set data-top 25
            next
            edit 2
                set header "Initiating FortiGate"
                set data-binding "locip"
            next
            edit 3
                set header "Terminating FortiGate"
                set data-binding "remip"
            next
            edit 4
                set header "Duration"
                set data-binding "duration"
                set column-attr timespan
                set column-span 2
            next
            edit 5
                set data-binding "duration"
                set column-graph-type bar
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "rogue_aps"
        set disp-name "Fortiview Export Rogue AP View"
        set category "Traffic"
        set description "Fortiview Export Rogue AP View"
        set chart-type table
        config table-columns
            edit 1
                set header "SSID"
                set data-binding "ssid"
                set data-top 25
            next
            edit 2
                set header "Security Type"
                set data-binding "securitymode"
            next
            edit 3
                set header "Channel"
                set data-binding "channel"
            next
            edit 4
                set header "Radio Band"
                set data-binding "radioband"
            next
            edit 5
                set header "Vender Info"
                set data-binding "manuf"
            next
            edit 6
                set header "Total Live Time"
                set data-binding "total_live_time"
                set column-attr timespan
            next
            edit 7
                set header "On-wire"
                set data-binding "on_wire"
            next
        end
        set protected enable
    next
    edit "resource_usage_avg"
        set disp-name "Fortiview Export Resource Usage Average View"
        set category "Traffic"
        set description "Fortiview Export Resource Usage Average View"
        set chart-type table
        config table-columns
            edit 1
                set header "Device Name"
                set data-binding "devid"
                set column-width 17
                set data-top 30
            next
            edit 2
                set header "Role"
                set data-binding "role"
            next
            edit 3
                set header "CPU Usage"
                set data-binding "cpu_ave"
                set column-attr percent
                set column-span 2
            next
            edit 4
                set data-binding "cpu_ave"
                set column-graph-type bar
            next
            edit 5
                set header "Memory Usage"
                set data-binding "mem_ave"
                set column-attr percent
                set column-span 2
            next
            edit 6
                set data-binding "mem_ave"
                set column-graph-type bar
            next
            edit 7
                set header "Disk Usage"
                set data-binding "disk_ave"
                set column-attr percent
                set column-span 2
            next
            edit 8
                set data-binding "disk_ave"
                set column-graph-type bar
            next
            edit 9
                set header "Logs Per Second"
                set data-binding "log_rate"
                set column-span 4
            next
            edit 10
                set data-binding "other_rate"
                set column-graph-type bar
                set legend "Security"
            next
            edit 11
                set data-binding "traffic_rate"
                set column-graph-type bar
                set legend "Traffic"
            next
            edit 12
                set data-binding "event_rate"
                set column-graph-type bar
                set legend "Event"
            next
            edit 13
                set header "Concurrent Sessions"
                set data-binding "session_ave"
                set column-attr count
            next
            edit 14
                set header "Bandwidth"
                set data-binding "transmit_kbps"
                set column-attr kbps
                set column-span 3
            next
            edit 15
                set data-binding "recv_kbps"
                set column-graph-type bar
                set legend "Received"
            next
            edit 16
                set data-binding "sent_kbps"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 17
                set header "New Sessions/Sec"
                set data-binding "new_sessions_rate"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "resource_usage_peak"
        set disp-name "Fortiview Export Resource Usage Peak View"
        set category "Traffic"
        set description "Fortiview Export Resource Usage Peak View"
        set chart-type table
        config table-columns
            edit 1
                set header "Device Name"
                set data-binding "devid"
                set column-width 17
                set data-top 30
            next
            edit 2
                set header "Role"
                set data-binding "role"
            next
            edit 3
                set header "CPU Usage"
                set data-binding "cpu_peak"
                set column-attr percent
                set column-span 2
            next
            edit 4
                set data-binding "cpu_peak"
                set column-graph-type bar
            next
            edit 5
                set header "Memory Usage"
                set data-binding "mem_peak"
                set column-attr percent
                set column-span 2
            next
            edit 6
                set data-binding "mem_peak"
                set column-graph-type bar
            next
            edit 7
                set header "Disk Usage"
                set data-binding "disk_peak"
                set column-attr percent
                set column-span 2
            next
            edit 8
                set data-binding "disk_peak"
                set column-graph-type bar
            next
            edit 9
                set header "Logs Per Second"
                set data-binding "lograte_peak"
                set column-span 4
            next
            edit 10
                set data-binding "other_rate"
                set column-graph-type bar
                set legend "Security"
            next
            edit 11
                set data-binding "traffic_rate"
                set column-graph-type bar
                set legend "Traffic"
            next
            edit 12
                set data-binding "event_rate"
                set column-graph-type bar
                set legend "Event"
            next
            edit 13
                set header "Concurrent Sessions"
                set data-binding "session_peak"
                set column-attr count
            next
            edit 14
                set header "Bandwidth"
                set data-binding "transmit_kbps_peak"
                set column-attr kbps
                set column-span 3
            next
            edit 15
                set data-binding "recv_kbps"
                set column-graph-type bar
                set legend "Received"
            next
            edit 16
                set data-binding "sent_kbps"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 17
                set header "New Sessions/Sec"
                set data-binding "new_sessions_peak"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "resource_usage_drilldown_view"
        set disp-name "Fortiview Export Resource Usage Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Resource Usage Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Time"
                set data-binding "hodex"
                set column-width 15
            next
            edit 2
                set header "CPU Average Usage"
                set data-binding "cpu_ave"
                set column-attr percent
            next
            edit 3
                set header "CPU Peak Usage"
                set data-binding "cpu_peak"
                set column-attr percent
            next
            edit 4
                set header "Memory Average Usage"
                set data-binding "mem_ave"
                set column-attr percent
            next
            edit 5
                set header "Memory Peak Usage"
                set data-binding "mem_peak"
                set column-attr percent
            next
            edit 6
                set header "Disk Average Usage"
                set data-binding "disk_ave"
                set column-attr percent
            next
            edit 7
                set header "Disk Peak Usage"
                set data-binding "disk_peak"
                set column-attr percent
            next
            edit 8
                set header "Logs Per Second (Average)"
                set data-binding "log_rate"
            next
            edit 9
                set header "Logs Per Second (Peak)"
                set data-binding "lograte_peak"
            next
            edit 10
                set header "Sessions (Average)"
                set data-binding "sessions"
                set column-attr count
            next
            edit 11
                set header "Sessions (Peak)"
                set data-binding "session_peak"
                set column-attr count
            next
            edit 12
                set header "Bandwidth (Average)"
                set data-binding "transmit_kbps"
                set column-attr kbps
                set column-span 3
            next
            edit 13
                set data-binding "recv_kbps"
                set column-graph-type bar
                set legend "Received"
            next
            edit 14
                set data-binding "sent_kbps"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 15
                set header "Bandwidth (Peak)"
                set data-binding "transmit_kbps_peak"
                set column-attr kbps
            next
        end
        set protected enable
    next
    edit "authorized_ssids"
        set disp-name "Fortiview Export Authorized SSIDs View"
        set category "Traffic"
        set description "Fortiview Export Authorized SSIDs View"
        set chart-type table
        config table-columns
            edit 1
                set header "SSID"
                set data-binding "srcssid"
                set data-top 25
            next
            edit 2
                set header "Device Name"
                set data-binding "devid"
            next
            edit 3
                set header "# of Clients"
                set data-binding "num_users"
                set column-attr count
            next
            edit 4
                set header "AP Name"
                set data-binding "ap_name"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "authorized_ssids_drilldown"
        set disp-name "Fortiview Export Authorized SSIDs Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Authorized SSIDs Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Hostname"
                set data-binding "hostname_mac"
                set data-top 25
            next
            edit 2
                set header "User"
                set data-binding "user_src"
            next
            edit 3
                set header "Source IP"
                set data-binding "srcip"
            next
            edit 4
                set header "AP Name"
                set data-binding "ap"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "authorized_aps"
        set disp-name "Fortiview Export Authorized APs View"
        set category "Traffic"
        set description "Fortiview Export Authorized APs View"
        set chart-type table
        config table-columns
            edit 1
                set header "AP Name"
                set data-binding "ap"
                set data-top 25
            next
            edit 2
                set header "Device Name"
                set data-binding "devid"
            next
            edit 3
                set header "# of Clients"
                set data-binding "num_users"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "authorized_aps_drilldown"
        set disp-name "Fortiview Export Authorized SSID Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Authorized SSID Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "SSID"
                set data-binding "ssid"
                set data-top 25
            next
            edit 2
                set header "User"
                set data-binding "user_src"
            next
            edit 3
                set header "Hostname(or MAC)"
                set data-binding "hostname_mac"
            next
            edit 4
                set header "Channel"
                set data-binding "channel"
            next
        end
        set protected enable
    next
    edit "wifi_clients"
        set disp-name "Fortiview Export WiFi Clients View"
        set category "Traffic"
        set description "Fortiview Export WiFi Clients View"
        set chart-type table
        config table-columns
            edit 1
                set header "WiFi Client"
                set data-binding "hostname_mac"
                set data-top 25
            next
            edit 2
                set header "User"
                set data-binding "user_src"
            next
            edit 3
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 5
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "wifi_clients_drilldown"
        set disp-name "Fortiview Export WiFi Clients Drilldown View"
        set category "Traffic"
        set description "Fortiview Export WiFi CLients Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app_group"
                set data-top 25
            next
            edit 2
                set header "Category"
                set data-binding "appcat"
                set column-attr appcat
            next
            edit 3
                set header "Risk"
                set data-binding "risk"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "fct_threat_view"
        set disp-name "Fortiview Export Endpoint Threat View"
        set category "Traffic"
        set description "Fortiview Export Endpoint Threat View"
        set chart-type table
        config table-columns
            edit 1
                set header "Threat"
                set data-binding "threat"
                set data-top 25
            next
            edit 2
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "fct_app_view"
        set disp-name "Fortiview Export Endpoint Application View"
        set category "Traffic"
        set description "Fortiview Export Endpoint Application View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app"
                set data-top 25
            next
            edit 2
                set header "Risk"
                set data-binding "risk"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "fct_website_view"
        set disp-name "Fortiview Export Endpoint Website View"
        set category "Traffic"
        set description "Fortiview Export Endpoint Website View"
        set chart-type table
        config table-columns
            edit 1
                set header "Domain"
                set data-binding "domain"
                set data-top 25
            next
            edit 2
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "endpoints"
        set disp-name "Fortiview Export Endpoints View"
        set category "Traffic"
        set description "Fortiview Export Endpoints View"
        set chart-type table
        config table-columns
            edit 1
                set header "Host Name"
                set data-binding "hostname"
                set data-top 25
            next
            edit 2
                set header "Malware Events"
                set data-binding "malware_events"
            next
            edit 3
                set header "Security Features"
                set data-binding "securityfeature"
            next
            edit 4
                set header "OS"
                set data-binding "os"
            next
            edit 5
                set header "FCT Version"
                set data-binding "fctver"
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_app"
        set disp-name "Fortiview Export Endpoints Drilldown(APP) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(APP) View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcname"
                set data-top 25
            next
            edit 2
                set header "Products"
                set data-binding "srcproduct"
            next
            edit 3
                set header "Destination"
                set data-binding "destination"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_web"
        set disp-name "Fortiview Export Endpoints Drilldown(Web) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(Web) View"
        set chart-type table
        config table-columns
            edit 1
                set header "Remote Host"
                set data-binding "remotename"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "threat"
            next
            edit 3
                set header "Blocked Times"
                set data-binding "times_blocked"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_malware"
        set disp-name "Fortiview Export Endpoints Drilldown(Malware) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(Malware) View"
        set chart-type table
        config table-columns
            edit 1
                set header "Virus"
                set data-binding "virus"
                set data-top 25
            next
            edit 2
                set header "File"
                set data-binding "file"
            next
            edit 3
                set header "Action"
                set data-binding "action"
            next
        end
        set protected enable
    next
    edit "endpoints_vulnerability"
        set disp-name "Fortiview Export Endpoints Vulnerability View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Vulnerability View"
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devid"
                set data-top 25
            next
            edit 2
                set header "Host Name"
                set data-binding "hostname"
            next
            edit 3
                set header "OS"
                set data-binding "os"
            next
            edit 4
                set header "Vulnerabilities"
                set data-binding "vulnerabilities"
            next
            edit 5
                set header "Highest Risk Level"
                set data-binding "highest_risk"
            next
            edit 6
                set header "Category"
                set data-binding "vulncat"
            next
            edit 7
                set header "Applications"
                set data-binding "applications"
            next
            edit 8
                set header "CVE# Count"
                set data-binding "cve_count"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "endpoints_vulnerability_drilldown"
        set disp-name "Fortiview Export Endpoints Vulnerability Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Vulnerability Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability"
                set data-binding "vulnname"
                set data-top 25
            next
            edit 2
                set header "Risk"
                set data-binding "risk"
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
            next
            edit 4
                set header "Application"
                set data-binding "application"
            next
            edit 5
                set header "CVE List"
                set data-binding "cve_list"
            next
            edit 6
                set header "Vendor Link"
                set data-binding "vendor_link"
                set column-attr html
                set column-span 2
            next
            edit 7
                set data-binding "vendor_link"
                set column-attr url
            next
        end
        set protected enable
    next
    edit "policy_hits"
        set disp-name "Fortiview Export Policy Hits View"
        set category "Traffic"
        set description "Fortiview Export Policy Hits View"
        set chart-type table
        config table-columns
            edit 1
                set header "Policy"
                set data-binding "policy"
                set data-top 25
            next
            edit 2
                set header "Device"
                set data-binding "devid"
            next
            edit 3
                set header "VDOM"
                set data-binding "vd"
            next
            edit 4
                set header "Hit Count"
                set data-binding "counts"
                set column-span 2
                set column-attr count
            next
            edit 5
                set data-binding "counts"
                set column-graph-type bar
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "web_user_view"
        set disp-name "Fortiview Export Website User View"
        set category "Traffic"
        set description "Fortiview Export Website User View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 25
            next
            edit 2
                set header "Group"
                set data-binding "group_info"
            next
            edit 3
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 4
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 5
                set header "# Sites Visited"
                set data-binding "sum_sites"
                set column-span 2
                set column-attr count
            next
            edit 6
                set data-binding "sum_sites"
                set column-graph-type bar
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 10
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 11
                set column-graph-type bar
                set data-binding "session_block"
                set legend "Blocked"
            next
            edit 12
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "web_user_view_category"
        set disp-name "Fortiview Export Website User View(Category)"
        set category "Traffic"
        set description "Fortiview Export Website User View(Category)"
        set chart-type table
        config table-columns
            edit 1
                set header "Category"
                set data-binding "catdesc"
                set data-top 25
            next
            edit 2
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 3
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 4 
                set header "Threat Score"
                set data-binding "threatweight"
                set column-span 3
                set column-attr count
            next
            edit 5
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 9
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 10
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 11
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 12
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "web_user_view_domain"
        set disp-name "Fortiview Export Website User View(Domain)"
        set category "Traffic"
        set description "Fortiview Export Website User View(Domain)"
        set chart-type table
        config table-columns
            edit 1
                set header "Domain"
                set data-binding "domain"
                set data-top 25
            next
            edit 2
                set header "Web Category"
                set data-binding "agg_webcat"
            next
            edit 3
                set header "Browsing Time"
                set data-binding "browsetime"
                set column-attr timespan
                set column-span 2
            next
            edit 4
                set data-binding "browsetime"
                set column-graph-type bar
            next
            edit 5 
                set header "Threat Score"
                set data-binding "threatweight"
                set column-span 3
                set column-attr count
            next
            edit 6
                set data-binding "threat_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 7
                set data-binding "threat_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 8
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 10
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 11
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 12
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 13
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "vulnscan_dev"
        set disp-name "Fortiview Export Vulnerability Device View"
        set category "Traffic"
        set description"Fortiview Export Vulnerability Device View"
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devtype"
                set column-attr dev-type
                set column-span 2
                set data-top 25
                set column-width 17
            next
            edit 2
                set data-binding "srcname"
            next
            edit 3
                set header "User"
                set data-binding "f_user"
                set column-attr user
                set column-width 15
            next
            edit 4
                set header "Source IP"
                set data-binding "srcip"
                set column-width 13
            next
            edit 5
                set header "Vulnerabilities"
                set data-binding "vuln_count"
                set column-attr count
                set column-span 5
                set column-width 30
            next
            edit 6
                set data-binding "vuln_count_critical"
                set column-graph-type bar
                set legend "Critical"
            next
            edit 7
                set data-binding "vuln_count_high"
                set column-graph-type bar
                set legend "High"
            next
            edit 8
                set data-binding "vuln_count_medium"
                set column-graph-type bar
                set legend "Medium"
            next
            edit 9
                set data-binding "vuln_count_low"
                set column-graph-type bar
                set legend "Low"
            next
            edit 10
                set header "Category"
                set data-binding "vuln_category"
                set column-width 25
            next
        end
        set protected enable
    next
    edit "vulnscan_dev_drilldown"
        set disp-name "Fortiview Export Vulnerability Device Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Vulnerability Device Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devtype"
                set column-attr dev-type
                set column-span 2
                set data-top 25
            next
            edit 2
                set data-binding "srcname"
            next
            edit 3
                set header "User"
                set data-binding "f_user"
                set column-attr user
            next
            edit 4
                set header "Source IP"
                set data-binding "srcip"
            next
            edit 5
                set header "Last Scan Time"
                set data-binding "scantime_s"
            next
        end
        set protected enable
    next
    edit "vulnscan_vuln"
        set disp-name "Fortiview Export Vulnerability View"
        set category "Traffic"
        set description "Fortiview Export Vulnerability View"
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability Name"
                set data-binding "vulnname"
                set data-top 25
            next
            edit 2
                set header "Severity"
                set data-binding "severity"
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
            next
            edit 4
                set header "CVE ID"
                set data-binding "cveid"
            next
            edit 5
                set header "Host Count"
                set data-binding "host_count"
            next
        end
        set protected enable
    next
    edit "vulnscan_vuln_drilldown"
        set disp-name "Fortiview Export Vulnerability Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Vulnerability Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability Name"
                set data-binding "vulnname"
                set data-top 25
                set column-width 22
            next
            edit 2
                set header "Severity"
                set data-binding "severity"
                set column-width 12
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
                set column-width 12
            next
            edit 4
                set header "Vulnerability ID"
                set data-binding "vulnid"
                set column-width 12
            next
            edit 5
                set header "CVE ID"
                set data-binding "cveid"
                set column-width 20
            next
            edit 6
                set header "Remediation Action"
                set data-binding "vendorurl"
                set column-width 22
            next
        end
        set protected enable
    next
    edit "fsa_verdict_user_view"
        set disp-name "Fortiview Export FortiSandbox Verdict by User View"
        set category "Traffic"
        set description "Fortiview Export FortiSandbox Verdict by User View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "user_src"
                set data-top 25
            next
            edit 2
                set header "Malicious_Cnt"
                set data-binding "verdict_malicious_cnt"
            next
            edit 3
                set header "Suspicious_Cnt"
                set data-binding "verdict_suspicious_cnt"
            next
            edit 4
                set header "Clean_Cnt"
                set data-binding "verdict_clean_cnt"
            next
            edit 5
                set header "Others"
                set data-binding "verdict_other_cnt"
            next
        end
        set protected enable
    next
    edit "threat_detect_summary"
        set disp-name "Fortiview Export Threat Detect Summary View"
        set category "Threat"
        set description "Fortiview Export Threat Detect Summary View"
        set chart-type table
        config table-columns
            edit 1
                set header "End User"
                set data-binding "srcip"
                set data-top 25
                set column-span 2
            next
            edit 2
                set data-binding "f_user"
            next
            edit 3
                set header "Last Detected"
                set data-binding "last_detected_time_s"
            next
            edit 4
                set header "Host Name"
                set data-binding "epname"
            next
            edit 5
                set header "OS"
                set data-binding "osname"
            next
            edit 6
                set header "Verdict"
                set data-binding "verdict_s"
            next
            edit 7
                set header "# of Threats"
                set data-binding "threat_num"
                set column-attr count
                set column-span 2
            next
            edit 8
                set data-binding "threat_num"
                set column-graph-type bar
            next
            edit 9
                set header "Acknowledge"
                set data-binding "ack_time"
                set column-span 2
            next
            edit 10
                set data-binding "ack_note"
            next
        end
        set protected enable
    next
    edit "threat_detect_drilldown_blacklist"
        set disp-name "Fortiview Export Threat Detect Blacklist Drilldown View"
        set category "Threat"
        set description "Fortiview Export Threat Detect Blacklist Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Detect Pattern"
                set data-binding "tdpattern"
                set data-top 25
            next
            edit 2
                set header "Threat Type"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Name"
                set data-binding "threatname"
            next
            edit 4
                set header "Category"
                set data-binding "webcat"
            next
            edit 5
                set header "Detect Method"
                set data-binding "tdtype"
            next
            edit 6
                set header "# of Events"
                set data-binding "event_num"
                set column-attr count
                set column-span 2
            next
            edit 7
                set data-binding "event_num"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "threat_detect_drilldown_crowdsrcing"
        set disp-name "Fortiview Export Threat Detect Suspicious Drilldown View"
        set category "Threat"
        set description "Fortiview Export Threat Detect Suspicious Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Detect Pattern"
                set data-binding "tdpattern"
                set data-top 25
            next
            edit 2
                set header "Threat Type"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Name"
                set data-binding "threatname"
            next
            edit 4
                set header "Category"
                set data-binding "webcat"
            next
            edit 5
                set header "Detect Method"
                set data-binding "tdtype"
            next
            edit 6
                set header "# of Events"
                set data-binding "event_num"
                set column-attr count
                set column-span 2
            next
            edit 7
                set data-binding "event_num"
                set column-graph-type bar
            next
            edit 8
                set header "Security Action"
                set data-binding "action"
            next
        end
        set protected enable
    next
    edit "threat_rescan_drilldown_blacklist"
        set disp-name "Fortiview Export Threat Rescan Blacklist Drilldown View"
        set category "Threat"
        set description "Fortiview Export Threat Rescan Blacklist Drilldown View"
        set chart-type table
        config table-columns
            edit 1
                set header "Detect Pattern"
                set data-binding "tdpattern"
                set data-top 25
            next
            edit 2
                set header "Threat Type"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Name"
                set data-binding "threatname"
            next
            edit 4
                set header "# of Events"
                set data-binding "event_num"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "event_num"
                set column-graph-type bar
            next
            edit 6
                set header "Endpoint"
                set data-binding "endpoint"
            next
        end
        set protected enable
    next
    edit "source_dns_view"
        set disp-name "Fortiview Export DNS Source View"
        set category "Domain Name System"
        set description "Fortiview Export DNS Source View"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 100
                set column-width 22
            next
            edit 2
                set header "User"
                set data-binding "f_user"
            next
            edit 3
                set header "Hostname"
                set data-binding "srcip_hostname"
            next
            edit 4
                set header "Device Type"
                set data-binding "devtype"
            next
            edit 5
                set header "Device"
                set data-binding "srcmac"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 9
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 11
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "destination_dns_view"
        set disp-name "Fortiview Export DNS Destination View"
        set category "Domain Name System"
        set description "Fortiview Export DNS Destination View"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 100
                set column-width 22
            next
            edit 2
                set header "Hostname"
                set data-binding "dstip_hostname"
            next
            edit 3
                set header "Device Type"
                set data-binding "devtype"
            next
            edit 4
                set header "Device"
                set data-binding "srcmac"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 8
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 10
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "country_dns_view"
        set disp-name "Fortiview Export DNS Country View"
        set category "Domain Name System"
        set description "Fortiview Export DNS Country View"
        set chart-type table
        config table-columns
            edit 1
                set header "Country"
                set data-binding "dstcountry"
                set data-top 100
                set column-width 22
            next
            edit 2
                set header "Device Type"
                set data-binding "devtype"
            next
            edit 3
                set header "Device"
                set data-binding "srcmac"
            next
            edit 4
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 5
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 6
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 7
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 9
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "dns_log_view"
        set disp-name "Fortiview Export DNS Logs"
        set category "Domain Name System"
        set description "Fortiview Export DNS Logs"
        set chart-type table
        config table-columns
            edit 1
                set header "Domain Name"
                set data-binding "qname"
                set data-top 100
                set column-width 22
            next
            edit 2
                set header "Category"
                set data-binding "catdesc"
            next
            edit 3
                set header "# of Clients"
                set data-binding "num_users"
                set column-width 12
                set column-attr count
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 7
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 8
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 9
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "fsa_detection"
        set disp-name "Fortiview Export FortiSandbox Detection View"
        set category "Threat"
        set description "Fortiview Export FortiSandbox Detection View"
        set chart-type table
        config table-columns
            edit 1
                set header "Date/Time"
                set data-binding "itime_str"
                set column-width 18
            next
            edit 2
                set header "File Name"
                set data-binding "doc_name"
                set column-width 24
            next
            edit 3
                set header "End User"
                set data-binding "user_src"
                set column-width 15
            next
            edit 4
                set header "Destination"
                set data-binding "dstip"
                set column-width 15
            next
            edit 5
                set header "Analysis"
                set data-binding "fsaverdict"
                set column-width 10
            next
            edit 6
                set header "Action"
                set data-binding "action"
                set column-width 12
            next
            edit 7
                set header "Service"
                set data-binding "service"
                set column-width 20
            next
        end
        set protected enable
    next
    edit "software_inventory_top_installed_apps"
        set disp-name "Fortiview Export Software Inventory Top Installed Apps"
        set category "Traffic"
        set description "Fortiview Export Software Inventory Top Installed Apps"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "productname"
                set data-top 25
            next
            edit 2
                set header "Host Count"
                set data-binding "host_count"
            next
        end
        set protected enable
    next
    edit "software_inventory_top_host_by_apps"
        set disp-name "Fortiview Export Software Inventory Top Host by Apps"
        set category "Traffic"
        set description "Fortiview Export Software Inventory Top Host by Apps"
        set chart-type table
        config table-columns
            edit 1
                set header "Host Name"
                set data-binding "hostname"
                set data-top 25
            next
            edit 2
                set header "User"
                set data-binding "f_user"
            next
            edit 3
                set header "OS"
                set data-binding "hostos"
            next
            edit 4
                set header "Number of Apps"
                set data-binding "app_count"
            next
        end
        set protected enable
    next
    edit "ztna_servers"
        set disp-name "Fortiview Export ZTNA Servers"
        set category "Traffic"
        set description "Fortiview Export ZTNA Servers"
        set chart-type table
        config table-columns
            edit 1
                set header "Server"
                set data-binding "accessproxy"
                set data-top 25
            next
            edit 2
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "ztna_sources"
        set disp-name "Fortiview Export ZTNA Sources"
        set category "Traffic"
        set description "Fortiview Export ZTNA Sources"
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcip"
                set data-top 25
            next
            edit 2
                set header "Device"
                set data-binding "dev_src_agg"
            next
            edit 3
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 5
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 6
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 9
                set header "Source Interface"
                set data-binding "srcintf_agg"
            next
            edit 10
                set header "FortiClient ID"
                set data-binding "fctuid"
            next
        end
        set protected enable
    next
    edit "ztna_rules"
        set disp-name "Fortiview Export ZTNA Rules"
        set category "Traffic"
        set description "Fortiview Export ZTNA Rules"
        set chart-type table
        config table-columns
            edit 1
                set header "ZTNA Rule"
                set data-binding "policyname"
                set data-top 25
            next
            edit 2
                set header "Source Interface"
                set data-binding "srcintf_agg"
            next
            edit 3
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 5
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 6
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "ztna_real_servers"
        set disp-name "Fortiview Export ZTNA Real Servers"
        set category "Traffic"
        set description "Fortiview Export ZTNA Real Servers"
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dstip"
                set data-top 25
            next
            edit 2
                set header "Application"
                set data-binding "agg_app"
            next
            edit 3
                set header "Bandwidth"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 5
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
            edit 6
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 8
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 9
                set header "Destination Interface"
                set data-binding "dstintf_agg"
            next
            edit 10
                set header "Device"
                set data-binding "dev_src_agg"
            next
        end
        set protected enable
    next
    edit "shadowit-non-federated-users-cloud-permission"
        set disp-name "Fortiview Export ShadowIT Non-federated Users Cloud Permission View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Non-federated Users Cloud Permission View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "application"
                set data-top 30
            next
            edit 2
                set header "User"
                set data-binding "user"
            next
            edit 3
                set header "Permissions"
                set data-binding "permissions"
            next
        end
        set protected enable
    next
    edit "shadowit-non-federated-users-file-access"
        set disp-name "Fortiview Export ShadowIT Non-federated Users File Access View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Non-federated Users File Access View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "application"
                set data-top 30
            next
            edit 2
                set header "User"
                set data-binding "user"
            next
            edit 3
                set header "File Count"
                set data-binding "file_count"
                set column-attr count
                set column-span 2
            next
            edit 4
                set data-binding "file_count"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "shadowit-unsanctioned-app-usage"
        set disp-name "Fortiview Export ShadowIT Unsanctioned Cloud Service View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT Unsanctioned Cloud Service View"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "application"
                set data-top 30
            next
            edit 2
                set header "Category"
                set data-binding "category"
            next
            edit 3
                set header "Risk"
                set data-binding "risk"
            next
            edit 4
                set header "Sessions"
                set data-binding "session_count"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "session_count"
                set column-graph-type bar
            next
            edit 6
                set header "File"
                set data-binding "file_count"
                set column-attr count
                set column-span 2
            next
            edit 7
                set data-binding "file_count"
                set column-graph-type bar
            next
            edit 8
                set header "Videos Played"
                set data-binding "video_count"
                set column-attr count
                set column-span 2
            next
            edit 9
                set data-binding "video_count"
                set column-graph-type bar
            next
            edit 10
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr count
                set column-span 3
            next
            edit 11
                set data-binding "sent_bytes"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 12
                set data-binding "recv_bytes"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "shadowit-file-exfiltration-detection"
        set disp-name "Fortiview Export ShadowIT File Exfiltration Detection View"
        set category "Traffic"
        set description "Fortiview Export ShadowIT File Exfiltration Detection View"
        set chart-type table
        config table-columns
            edit 1
                set header "From Application"
                set data-binding "from_application"
                set data-top 30
            next
            edit 2
                set header "To Application"
                set data-binding "to_application"
            next
            edit 3
                set header "User"
                set data-binding "clouduser"
            next
            edit 4
                set header "IP"
                set data-binding "ip"
            next
            edit 5
                set header "File Name"
                set data-binding "file_name"
            next
            edit 6
                set header "Data Pattern"
                set data-binding "data_pattern"
            next
        end
        set protected enable
    next
    edit "iot_hosts"
        set disp-name "Fortiview Export Top IoT by # Hosts"
        set category "Traffic"
        set description "Fortiview Export Top IoT by # Hosts"
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "iot_app"
                set data-top 30
            next
            edit 2
                set header "Host Count"
                set data-binding "host_count"
                set column-attr count
                set column-span 2
            next
            edit 3
                set data-binding "host_count"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "sdwan_interface_view"
        set disp-name "Fortiview Export SD-WAN Interfaces View"
        set category "SD-WAN"
        set description "Fortiview Export SD-WAN Interfaces View"
        set chart-type table
        config table-columns
            edit 1
                set header "Interface"
                set data-binding "interface"
                set data-top 30
            next
            edit 2
                set header "IP"
                set data-binding "locip"
            next
            edit 3
                set header "Remote Gateway"
                set data-binding "remip"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
            next
            edit 5
                set header "Upload"
                set data-binding "outbandwidth"
                set column-attr kbps
            next
            edit 6
                set header "Download"
                set data-binding "inbandwidth"
                set column-attr kbps
            next
            edit 7
                set header "Latency (ms)"
                set data-binding "latency"
            next
            edit 8
                set header "Jitter (ms)"
                set data-binding "jitter"
            next
            edit 9
                set header "Packetloss (%)"
                set data-binding "packetloss"
            next
        end
        set protected enable
    next
    edit "shaper_user_view"
        set disp-name "Fortiview Export Shaping User View"
        set category "Traffic Shaping"
        set description "Fortiview Export Shaping User View"
        set chart-type table
        config table-columns
            edit 1
                set header "User Name"
                set data-binding "f_user"
                set data-top 30
            next
            edit 2
                set header "IP"
                set data-binding "srcip"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 2
            next
            edit 4
                set data-binding "sessions"
                set column-graph-type bar
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "shaper_policy_view"
        set disp-name "Fortiview Export Shaping Policy View"
        set category "Traffic Shaping"
        set description "Fortiview Export Shaping Policy View"
        set chart-type table
        config table-columns
            edit 1
                set header "Shaping Policy"
                set data-binding "shapersentname"
                set data-top 30
            next
            edit 2
                set header "Source Interfaces"
                set data-binding "srcintf_agg"
            next
            edit 3
                set header "Shared Shaper"
                set data-binding "shapersentname"
            next
            edit 4
                set header "Reverse Shaper"
                set data-binding "shaperrcvdname"
            next
            edit 5
                set header "Per IP Shaper"
                set data-binding "shaperperipname"
            next
            edit 6
                set header "Service"
                set data-binding "service_agg"
            next
            edit 7
                set header "Applications"
                set data-binding "app_group_agg"
            next
            edit 8
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 2
            next
            edit 9
                set data-binding "sessions"
                set column-graph-type bar
            next
            edit 10
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 11
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 12
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "storage_stats_summary"
        set disp-name "Fortiview Export Storage Stats Summary"
        set category "Traffic"
        set description "Fortiview Export Storage Stats Summary"
        set chart-type line
        config table-columns
            edit 1
                set header "Date"
                set data-binding "tmdate"
            next
            edit 2
                set data-binding "dbsize"
                set column-graph-type line-up
                set column-attr count
                set legend "DB"
            next
            edit 3
                set data-binding "logsize"
                set column-graph-type line-up
                set column-attr count
                set legend "LOG"
            next
        end
        config variable-template
            edit "user_src"
                set var "user"
                set var-value "peter"
            next
        end
        set protected enable
    next
end
config fazcfg-template fortiview-chart fdd
    edit "fddos_source_view"
        set disp-name "Fortiview Export Source View"
        set category "Traffic"
        set description "Fortiview Export Source View"
        set dev-type FortiDDoS
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "sip"
                set data-top 25
            next
            edit 2
                set header "Device"
                set data-binding "devid"
            next
            edit 3
                set header "Description"
                set data-binding "description"
            next
            edit 4
                set header "Drop Count"
                set data-binding "dropcount"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "dropcount"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "fddos_destination_view"
        set disp-name "Fortiview Export Destination View"
        set category "Traffic"
        set description "Fortiview Export Destination View"
        set dev-type FortiDDoS
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dip"
                set data-top 25
            next
            edit 2
                set header "Device"
                set data-binding "devid"
            next
            edit 3
                set header "Description"
                set data-binding "description"
            next
            edit 4
                set header "Drop Count"
                set data-binding "dropcount"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "dropcount"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "fddos_type_view"
        set disp-name "Fortiview Export Type View"
        set category "Traffic"
        set description "Fortiview Export Type View"
        set dev-type FortiDDoS
        set chart-type table
        config table-columns
            edit 1
                set header "Type"
                set data-binding "type"
                set data-top 25
            next
            edit 2
                set header "Device"
                set data-binding "devid"
            next
            edit 3
                set header "Description"
                set data-binding "description"
            next
            edit 4
                set header "Drop Count"
                set data-binding "dropcount"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "dropcount"
                set column-graph-type bar
            next
        end
        set protected enable
    next
    edit "storage_stats_summary"
        set disp-name "Fortiview Export Storage Stats Summary"
        set category "Traffic"
        set description "Fortiview Export Storage Stats Summary"
        set chart-type line
        config table-columns
            edit 1
                set header "Date"
                set data-binding "tmdate"
            next
            edit 2
                set data-binding "dbsize"
                set column-graph-type line-up
                set column-attr count
                set legend "DB"
            next
            edit 3
                set data-binding "logsize"
                set column-graph-type line-up
                set column-attr count
                set legend "LOG"
            next
        end
        config variable-template
            edit "user_src"
                set var "user"
                set var-value "peter"
            next
        end
        set protected enable
    next
end
config fazcfg-template fortiview-chart fct
    edit "fct_threat_view"
        set disp-name "Fortiview Export Threat View"
        set category "Traffic"
        set description "Fortiview Export Threat View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Threat"
                set data-binding "threat"
                set data-top 25
            next
            edit 2
                set header "Incidents"
                set data-binding "incidents"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "incident_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "incident_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "fct_app_view"
        set disp-name "Fortiview Export Application View"
        set category "Traffic"
        set description "Fortiview Export Application View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "app"
                set data-top 25
            next
            edit 2
                set header "Risk"
                set data-binding "risk"
            next
            edit 3
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 4
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 5
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 6
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 7
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 8
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "fct_website_view"
        set disp-name "Fortiview Export Website View"
        set category "Traffic"
        set description "Fortiview Export Website View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Domain"
                set data-binding "domain"
                set data-top 25
            next
            edit 2
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 3
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 4
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
            edit 5
                set header "Bytes"
                set data-binding "bandwidth"
                set column-attr bandwidth
                set column-span 3
            next
            edit 6
                set data-binding "traffic_out"
                set column-graph-type bar
                set legend "Sent"
            next
            edit 7
                set data-binding "traffic_in"
                set column-graph-type bar
                set legend "Received"
            next
        end
        set protected enable
    next
    edit "endpoints"
        set disp-name "Fortiview Export Endpoints View"
        set category "Traffic"
        set description "Fortiview Export Endpoints View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Host Name"
                set data-binding "hostname"
                set data-top 25
            next
            edit 2
                set header "Malware Events"
                set data-binding "malware_events"
            next
            edit 3
                set header "Security Features"
                set data-binding "securityfeature"
            next
            edit 4
                set header "OS"
                set data-binding "os"
            next
            edit 5
                set header "FCT Version"
                set data-binding "fctver"
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_app"
        set disp-name "Fortiview Export Endpoints Drilldown(APP) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(APP) View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "srcname"
                set data-top 25
            next
            edit 2
                set header "Products"
                set data-binding "srcproduct"
            next
            edit 3
                set header "Destination"
                set data-binding "destination"
            next
            edit 4
                set header "Sessions"
                set data-binding "sessions"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "session_block"
                set column-graph-type bar
                set legend "Blocked"
            next
            edit 6
                set data-binding "session_pass"
                set column-graph-type bar
                set legend "Allowed"
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_web"
        set disp-name "Fortiview Export Endpoints Drilldown(Web) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(Web) View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Remote Host"
                set data-binding "remotename"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "threat"
            next
            edit 3
                set header "Blocked Times"
                set data-binding "times_blocked"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "endpoints_drilldown_malware"
        set disp-name "Fortiview Export Endpoints Drilldown(Malware) View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Drilldown(Malware) View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Virus"
                set data-binding "virus"
                set data-top 25
            next
            edit 2
                set header "File"
                set data-binding "file"
            next
            edit 3
                set header "Action"
                set data-binding "action"
            next
        end
        set protected enable
    next
    edit "endpoints_vulnerability"
        set disp-name "Fortiview Export Endpoints Vulnerability View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Vulnerability View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devid"
                set data-top 25
            next
            edit 2
                set header "Host Name"
                set data-binding "hostname"
            next
            edit 3
                set header "OS"
                set data-binding "os"
            next
            edit 4
                set header "Vulnerabilities"
                set data-binding "vulnerabilities"
            next
            edit 5
                set header "Highest Risk Level"
                set data-binding "highest_risk"
            next
            edit 6
                set header "Category"
                set data-binding "vulncat"
            next
            edit 7
                set header "Applications"
                set data-binding "applications"
            next
            edit 8
                set header "CVE# Count"
                set data-binding "cve_count"
                set column-attr count
            next
        end
        set protected enable
    next
    edit "endpoints_vulnerability_drilldown"
        set disp-name "Fortiview Export Endpoints Vulnerability Drilldown View"
        set category "Traffic"
        set description "Fortiview Export Endpoints Vulnerability Drilldown View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability"
                set data-binding "vulnname"
                set data-top 25
            next
            edit 2
                set header "Risk"
                set data-binding "risk"
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
            next
            edit 4
                set header "Application"
                set data-binding "application"
            next
            edit 5
                set header "CVE List"
                set data-binding "cve_list"
            next
            edit 6
                set header "Vendor Link"
                set data-binding "vendor_link"
                set column-attr html
                set column-span 2
            next
            edit 7
                set data-binding "vendor_link"
                set column-attr url
            next
        end
        set protected enable
    next
    edit "vulnscan_dev"
        set disp-name "Fortiview Export EMS Vulnerability Device View"
        set category "Traffic"
        set description"Fortiview Export EMS Vulnerability Device View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devtype"
                set column-attr dev-type
                set column-span 2
                set data-top 25
                set column-width 17
            next
            edit 2
                set data-binding "srcname"
            next
            edit 3
                set header "User"
                set data-binding "f_user"
                set column-attr user
                set column-width 15
            next
            edit 4
                set header "Source IP"
                set data-binding "srcip"
                set column-width 13
            next
            edit 5
                set header "Vulnerabilities"
                set data-binding "vuln_count"
                set column-attr count
                set column-span 5
                set column-width 30
            next
            edit 6
                set data-binding "vuln_count_critical"
                set column-graph-type bar
                set legend "Critical"
            next
            edit 7
                set data-binding "vuln_count_high"
                set column-graph-type bar
                set legend "High"
            next
            edit 8
                set data-binding "vuln_count_medium"
                set column-graph-type bar
                set legend "Medium"
            next
            edit 9
                set data-binding "vuln_count_low"
                set column-graph-type bar
                set legend "Low"
            next
            edit 10
                set header "Category"
                set data-binding "vuln_category"
                set column-width 25
            next
        end
        set protected enable
    next
    edit "vulnscan_dev_drilldown"
        set disp-name "Fortiview Export EMS Vulnerability Device Drilldown View"
        set category "Traffic"
        set description "Fortiview Export EMS Vulnerability Device Drilldown View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Device"
                set data-binding "devtype"
                set column-attr dev-type
                set column-span 2
                set data-top 25
            next
            edit 2
                set data-binding "srcname"
            next
            edit 3
                set header "User"
                set data-binding "f_user"
                set column-attr user
            next
            edit 4
                set header "Source IP"
                set data-binding "srcip"
            next
            edit 5
                set header "Last Scan Time"
                set data-binding "scantime_s"
            next
        end
        set protected enable
    next
    edit "vulnscan_vuln"
        set disp-name "Fortiview Export EMS Vulnerability View"
        set category "Traffic"
        set description "Fortiview Export EMS Vulnerability View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability Name"
                set data-binding "vulnname"
                set data-top 25
            next
            edit 2
                set header "Severity"
                set data-binding "severity"
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
            next
            edit 4
                set header "CVE ID"
                set data-binding "cveid"
            next
            edit 5
                set header "Host Count"
                set data-binding "host_count"
            next
        end
        set protected enable
    next
    edit "vulnscan_vuln_drilldown"
        set disp-name "Fortiview Export EMS Vulnerability Drilldown View"
        set category "Traffic"
        set description "Fortiview Export EMS Vulnerability Drilldown View"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Vulnerability Name"
                set data-binding "vulnname"
                set data-top 25
                set column-width 22
            next
            edit 2
                set header "Severity"
                set data-binding "severity"
                set column-width 12
            next
            edit 3
                set header "Category"
                set data-binding "vulncat"
                set column-width 12
            next
            edit 4
                set header "Vulnerability ID"
                set data-binding "vulnid"
                set column-width 12
            next
            edit 5
                set header "CVE ID"
                set data-binding "cveid"
                set column-width 20
            next
            edit 6
                set header "Remediation Action"
                set data-binding "vendorurl"
                set column-width 22
            next
        end
        set protected enable
    next
    edit "software_inventory_top_installed_apps"
        set disp-name "Fortiview Export Software Inventory Top Installed Apps"
        set category "Traffic"
        set description "Fortiview Export Software Inventory Top Installed Apps"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Application"
                set data-binding "productname"
                set data-top 25
            next
            edit 2
                set header "Host Count"
                set data-binding "host_count"
            next
        end
        set protected enable
    next
    edit "software_inventory_top_host_by_apps"
        set disp-name "Fortiview Export Software Inventory Top Host by Apps"
        set category "Traffic"
        set description "Fortiview Export Software Inventory Top Host by Apps"
        set dev-type FortiClient
        set chart-type table
        config table-columns
            edit 1
                set header "Host Name"
                set data-binding "hostname"
                set data-top 25
            next
            edit 2
                set header "User"
                set data-binding "f_user"
            next
            edit 3
                set header "OS"
                set data-binding "hostos"
            next
            edit 4
                set header "Number of Apps"
                set data-binding "app_count"
            next
        end
        set protected enable
    next
    edit "storage_stats_summary"
        set disp-name "Fortiview Export Storage Stats Summary"
        set category "Traffic"
        set description "Fortiview Export Storage Stats Summary"
        set chart-type line
        config table-columns
            edit 1
                set header "Date"
                set data-binding "tmdate"
            next
            edit 2
                set data-binding "dbsize"
                set column-graph-type line-up
                set column-attr count
                set legend "DB"
            next
            edit 3
                set data-binding "logsize"
                set column-graph-type line-up
                set column-attr count
                set legend "LOG"
            next
        end
        config variable-template
            edit "user_src"
                set var "user"
                set var-value "peter"
            next
        end
        set protected enable
    next
end
config fazcfg-template fortiview-chart fml
    edit "fml_threat_rescan_drilldown_blacklist"
        set disp-name "Fortiview Export Threat Rescan Blacklist Drilldown View(FML)"
        set category "Threat"
        set description "Fortiview Export Threat Rescan Blacklist Drilldown View(FML)"
        set chart-type table
        config table-columns
            edit 1
                set header "Detect Pattern"
                set data-binding "tdpattern"
                set data-top 25
            next
            edit 2
                set header "Threat Type"
                set data-binding "threattype"
            next
            edit 3
                set header "Threat Name"
                set data-binding "threatname"
            next
            edit 4
                set header "# of Events"
                set data-binding "event_num"
                set column-attr count
                set column-span 2
            next
            edit 5
                set data-binding "event_num"
                set column-graph-type bar
            next
            edit 6
                set header "Endpoint"
                set data-binding "endpoint"
            next
        end
        set protected enable
    next
    edit "storage_stats_summary"
        set disp-name "Fortiview Export Storage Stats Summary"
        set category "Traffic"
        set description "Fortiview Export Storage Stats Summary"
        set chart-type line
        config table-columns
            edit 1
                set header "Date"
                set data-binding "tmdate"
            next
            edit 2
                set data-binding "dbsize"
                set column-graph-type line-up
                set column-attr count
                set legend "DB"
            next
            edit 3
                set data-binding "logsize"
                set column-graph-type line-up
                set column-attr count
                set legend "LOG"
            next
        end
        config variable-template
            edit "user_src"
                set var "user"
                set var-value "peter"
            next
        end
        set protected enable
    next
end
config fazcfg-template fortiview-chart fwb
    edit "fwb_security_country"
        set disp-name "Fortiview Export Security Country"
        set category "Attack"
        set description "Fortiview Export Security Country"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Country/Region"
                set data-binding "srccountry"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_threat"
        set disp-name "Fortiview Export Security Threat"
        set category "Attack"
        set description "Fortiview Export Security Threat"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Threat"
                set data-binding "main_type"
                set data-top 25
            next
            edit 2
                set header "Threat Level"
                set data-binding "threat_level"
            next
            edit 3
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 4
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 5
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 7
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 8
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 10
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_policy"
        set disp-name "Fortiview Export Security Policy"
        set category "Attack"
        set description "Fortiview Export Security Policy"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Policy"
                set data-binding "policy"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_source"
        set disp-name "Fortiview Export Security Source"
        set category "Attack"
        set description "Fortiview Export Security Source"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "src"
                set data-top 25
            next
            edit 2
                set header "Country/Region"
                set data-binding "srccountry"
            next
            edit 3
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 4
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 5
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 6
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 7
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 8
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 9
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 10
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_dev"
        set disp-name "Fortiview Export Security Client Devices"
        set category "Attack"
        set description "Fortiview Export Security Client Devices"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Client Device"
                set data-binding "dev_id"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_method"
        set disp-name "Fortiview Export Security HTTP Method"
        set category "Attack"
        set description "Fortiview Export Security HTTP Method"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "HTTP Method"
                set data-binding "http_method"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_url"
        set disp-name "Fortiview Export Security URL"
        set category "Attack"
        set description "Fortiview Export Security URL"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "URL"
                set data-binding "http_url"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_cve"
        set disp-name "Fortiview Export Security CVE ID"
        set category "Attack"
        set description "Fortiview Export Security CVE ID"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "CVE ID"
                set data-binding "signature_cve_id"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_security_owasp"
        set disp-name "Fortiview Export Security OWASP TOP 10"
        set category "Attack"
        set description "Fortiview Export Security OWASP TOP 10"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "OWASP TOP 10"
                set data-binding "owasp_top10"
                set data-top 25
            next
            edit 2
                set header "Threats"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Threats Score"
                set data-binding "total_score"
                set column-attr count
            next
            edit 4
                set header "Action"
                set data-binding "total_action"
                set column-attr count
                set column-span 3
            next
            edit 5
                set data-binding "num_block"
                set column-graph-type bar
                set legend "Block"
            next
            edit 6
                set data-binding "num_alert"
                set column-graph-type bar
                set legend "Alert"
            next
            edit 7
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 8
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 9
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_source"
        set disp-name "Fortiview Export Traffic Source"
        set category "Traffic"
        set description "Fortiview Export Traffic Source"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Source"
                set data-binding "src"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_country"
        set disp-name "Fortiview Export Traffic Country"
        set category "Traffic"
        set description "Fortiview Export Traffic Country"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Country/Region"
                set data-binding "srccountry"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_destination"
        set disp-name "Fortiview Export Traffic Destination"
        set category "Traffic"
        set description "Fortiview Export Traffic Destination"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Destination"
                set data-binding "dst"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_policy"
        set disp-name "Fortiview Export Traffic Policy"
        set category "Traffic"
        set description "Fortiview Export Traffic Policy"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Policy"
                set data-binding "policy"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_domain"
        set disp-name "Fortiview Export Traffic Domain"
        set category "Traffic"
        set description "Fortiview Export Traffic Domain"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Domain"
                set data-binding "http_host"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_method"
        set disp-name "Fortiview Export Traffic HTTP Method"
        set category "Traffic"
        set description "Fortiview Export Traffic HTTP Method"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "HTTP Method"
                set data-binding "http_method"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_retcode"
        set disp-name "Fortiview Export Traffic Status Code"
        set category "Traffic"
        set description "Fortiview Export Traffic Status Code"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "Status Code"
                set data-binding "http_retcode"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "fwb_traffic_url"
        set disp-name "Fortiview Export Traffic HTTP URL"
        set category "Traffic"
        set description "Fortiview Export Traffic HTTP URL"
        set dev-type FortiWeb
        set chart-type table
        config table-columns
            edit 1
                set header "HTTP URL"
                set data-binding "http_url"
                set data-top 25
            next
            edit 2
                set header "HTTP Transactions"
                set data-binding "total_num"
                set column-attr count
            next
            edit 3
                set header "Bytes"
                set data-binding "total_bytes"
                set column-attr bandwidth
                set column-span 3
            next
            edit 4
                set data-binding "req_bytes"
                set column-graph-type bar
                set legend "Request"
            next
            edit 5
                set data-binding "resp_bytes"
                set column-graph-type bar
                set legend "Response"
            next
            edit 6
                set header "Service"
                set data-binding "total_service"
                set column-attr count
                set column-span 3
            next
            edit 7
                set data-binding "num_http"
                set column-graph-type bar
                set legend "HTTP"
            next
            edit 8
                set data-binding "num_https"
                set column-graph-type bar
                set legend "HTTPS"
            next
            edit 9
                set header "HTTP Version"
                set data-binding "total_version"
                set column-attr count
                set column-span 3
            next
            edit 10
                set data-binding "total_v1"
                set column-graph-type bar
                set legend "HTTP 1.x"
            next
            edit 11
                set data-binding "total_v2"
                set column-graph-type bar
                set legend "HTTP 2.0"
            next
        end
        set protected enable
    next
    edit "storage_stats_summary"
        set disp-name "Fortiview Export Storage Stats Summary"
        set category "Traffic"
        set description "Fortiview Export Storage Stats Summary"
        set chart-type line
        config table-columns
            edit 1
                set header "Date"
                set data-binding "tmdate"
            next
            edit 2
                set data-binding "dbsize"
                set column-graph-type line-up
                set column-attr count
                set legend "DB"
            next
            edit 3
                set data-binding "logsize"
                set column-graph-type line-up
                set column-attr count
                set legend "LOG"
            next
        end
        config variable-template
            edit "user_src"
                set var "user"
                set var-value "peter"
            next
        end
        set protected enable
    next
end
