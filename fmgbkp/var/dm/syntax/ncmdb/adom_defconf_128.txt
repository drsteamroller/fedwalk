
config sql-report dataset
end



config sql-report chart
end


config sql-report layout
end


config sql-report layout-folder
	edit 99999
		set folder-name "Default Templates"
		set protected enable
	next
end
config alert correlation-handler
    edit ab3_4d1_75a_b78
        set handler-id "ab3_4d1_75a_b78"
        set name "Default-Brute-Force-Account-Login-Attack-FAZ"
        set uuid ""
        set content-pack-uuid ""
        set content-pack-id ""
        set version 2
        set creation-time 0
        set enable-time 0
        set update-time 0
        set description "This handler is to detect if an account login failed many times not followed by a login success for FortiAnalyzer."
        set automation-stitch disable
        set thres-duration 30
        set rule-relation "c3a_f11_453_7cd NOT_FOLLOWED_BY[5m] 5b7_902_4ce_c21"
        set rule-relation-constraint "c3a_f11_453_7cd.devid=5b7_902_4ce_c21.devid"
        set eventstatus "auto"
        set extrainfo-type default
        set severity medium
        set tags "login,attack"
        set notification ""
        set data-selector ""
        config rule
            edit c3a_f11_453_7cd
                set rule-id "c3a_f11_453_7cd"
                set name "Login Failed 5 Times"
                set devtype FortiAnalyzer
                set logtype "event"
                set utmevent ""
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*) >= 5"
                config filter
                    edit 1
                        set id 1
                        set key "operation"
                        set value "login failed"
                        set oper equal
                    next
                end
            next
            edit 5b7_902_4ce_c21
                set rule-id "5b7_902_4ce_c21"
                set name "Login Success"
                set devtype FortiAnalyzer
                set logtype "event"
                set utmevent ""
                set groupby1 "devid"
                set groupby2 ""
                set groupby3 ""
                set filter-relation 1
                set filter-expr ""
                set aggregate-expr "COUNT(*)>=1"
                config filter
                    edit 1
                        set id 1
                        set key "operation"
                        set value "login"
                        set oper equal
                    next
                end
            next
        end
        set enable disable
        set protected enable
        set template-url "/fazcfg-template/correlation-handler/faz"
    next
end

config system connectors
    edit 1
        set uuid "5979abf1-a807-47fd-8aca-c03d3b27c124"
        set name "Local Connector"
        set description "Local Connector"
        set status enable
        set type LOCALHOST 
        set auth-type none
        config action
            edit 1
                set name "UPDATE_ASSET_AND_IDENTITY"
                set description "update asset and identity"
                set parameters "{}"
                set status enable
            next
            edit 2
                set name "GET_EVENTS"
                set description "get events"
                set parameters "{}"
                set status enable
            next
            edit 3
                set name "ATTACH_DATA_TO_INCIDENT"
                set description "attach data to incident"
                set parameters "{}"
                set status enable
            next
            edit 4
                set name "RUN_REPORT"
                set description "run report"
                set parameters "{}"
                set status enable
            next
            edit 5
                set name "GET_ENDPOINT_VULNERABILITIES"
                set description "get endpoint vulnerabilities"
                set parameters "{}"
                set status enable
            next
            edit 6
                set name "CREATE_INCIDENT"
                set description "create incident"
                set parameters "{}"
                set status enable
            next
            edit 7
                set name "UPDATE_INCIDENT"
                set description "update incident"
                set parameters "{}"
                set status enable
            next
        end
    next
    edit 2
        set uuid "d0f89488-b270-11ea-b3de-0242ac130004"
        set name "FortiGuard Connector"
        set description "FortiGuard Connector"
        set status enable
        set type FGD
        set auth-type none
        config action
            edit 1
                set name "GET_IOC_INFO"
                set description "get FortiGuard data for associated IOC"
                set parameters "{\"addr\":null}"
                set status enable
            next
            edit 2
                set name "GET_THREAT_INFO"
                set description "Lookup Fortiguard encyclopedia entry"
                set parameters "{\"threat-type\":null,\"threatID\":null}"
                set status enable
            next
            edit 3
                set name "INDICATOR_LOOKUP"
                set description "Indicator Lookup"
                set parameters "{\"indicator_type\":null,\"indicator_value\":null}"
                set status enable
            next
        end
    next
end

config sql-report layout
end


config sql-report layout-folder
	edit 99999
        set folder-name "Default"
        set protected disable
	next
end
